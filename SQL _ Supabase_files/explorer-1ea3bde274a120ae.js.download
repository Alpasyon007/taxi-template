(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6526],{64175:function(e,t,r){"use strict";var n=r(36849),s=r(8647),i=r(39097),a=r.n(i),o=r(73437),c=r(70203),l=r(52322);t.Z=function(e){var t=e.show,r=e.setShowUpgradePrompt,i=(0,c.lL)();return(0,l.jsx)(n.C,{hideFooter:!0,visible:t,closable:!0,size:"medium",header:"Log retention",onCancel:function(){return r(!1)},children:(0,l.jsxs)("div",{className:"space-y-4 py-4",children:[(0,l.jsx)(n.C.Content,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-sm",children:"Logs can be retained up to a duration of 3 months depending on the plan that your project is on."}),(0,l.jsxs)("div",{className:"border-control bg-surface-300 rounded border",children:[(0,l.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,l.jsx)("p",{className:"text-foreground-light w-[40%] text-sm",children:"Plan"}),(0,l.jsx)("p",{className:"text-foreground-light w-[60%] text-sm",children:"Retention duration"})]}),(0,l.jsxs)("div",{className:"py-1",children:[(0,l.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,l.jsx)("p",{className:"w-[40%] text-sm",children:"Free"}),(0,l.jsx)("p",{className:"w-[60%] text-sm",children:o.fg.FREE.text})]}),(0,l.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,l.jsx)("p",{className:"w-[40%] text-sm",children:"Pro"}),(0,l.jsx)("p",{className:"w-[60%] text-sm",children:o.fg.PRO.text})]}),(0,l.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,l.jsx)("p",{className:"w-[40%] text-sm",children:"Team"}),(0,l.jsx)("p",{className:"w-[60%] text-sm",children:o.fg.TEAM.text})]}),(0,l.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,l.jsx)("p",{className:"w-[40%] text-sm",children:"Enterprise"}),(0,l.jsx)("p",{className:"w-[60%] text-sm",children:o.fg.ENTERPRISE.text})]})]})]})]})}),(0,l.jsx)(n.C.Separator,{}),(0,l.jsx)(n.C.Content,{children:(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)(s.z,{type:"default",onClick:function(){return r(!1)},children:"Close"}),(0,l.jsx)(s.z,{asChild:!0,size:"tiny",children:(0,l.jsx)(a(),{href:"/org/".concat(null==i?void 0:i.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade"})})]})})]})})}},68335:function(e,t,r){"use strict";var n=r(52322);t.Z=function(e){var t=e.children,r=e.active,s=e.className;return(0,n.jsx)("div",{className:[s,"flex h-full flex-grow transition-opacity ",r?"opacity-30":"opacity-100"].join(" "),children:t})}},92587:function(e,t,r){"use strict";var n=r(24990),s=r(73437),i=r(55268),a=r(210),o=r(39097),c=r.n(o),l=r(2784),d=r(90394),u=r(37690),p=r(8647),f=r(95223),m=r(24888),h=r(59227),x=r(71813),j=r(21014),g=r(97346),v=r(51459),y=r(52322);t.Z=function(e){var t=e.subtitle,r=(0,l.useState)(!1),n=r[0],a=r[1];return(0,y.jsxs)("div",{className:"flex items-center gap-8 transition-all pb-6 justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded border border-brand-600 bg-brand-300 text-brand ",children:(0,y.jsx)(u.Z,{size:14,strokeWidth:3})}),(0,y.jsx)("h1",{className:"text-2xl text-foreground",children:"Logs Explorer"}),t&&(0,y.jsx)("span",{className:"text-2xl text-foreground-light",children:t})]}),(0,y.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,y.jsx)(p.z,{asChild:!0,type:"default",icon:(0,y.jsx)(f.Z,{strokeWidth:1.5}),children:(0,y.jsx)(c(),{href:s.n7,children:"Documentation"})}),(0,y.jsxs)(m.ZP,{size:"large",header:(0,y.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,y.jsx)("h3",{children:"Field Reference"}),(0,y.jsx)(p.z,{type:"text",className:"px-1",onClick:function(){return a(!1)},icon:(0,y.jsx)(h.Z,{size:18,strokeWidth:1.5})})]}),visible:n,cancelText:"Close",onCancel:function(){return a(!1)},hideFooter:!0,triggerElement:(0,y.jsx)(p.z,{type:"default",onClick:function(){return a(!0)},icon:(0,y.jsx)(x.Z,{strokeWidth:1.5}),children:"Field Reference"}),children:[(0,y.jsx)(m.ZP.Content,{children:(0,y.jsx)("div",{className:"pt-4 pb-2 space-y-1",children:(0,y.jsxs)("p",{className:"text-sm",children:["The following table shows all the available paths that can be queried from each respective source. Do note that to access nested keys, you would need to perform the necessary"," ",(0,y.jsxs)(c(),{href:"https://supabase.com/docs/guides/platform/logs#unnesting-arrays",target:"_blank",rel:"noreferrer",className:"text-brand",children:["unnesting joins",(0,y.jsx)(f.Z,{size:"tiny",className:"ml-1 inline -translate-y-[2px]",strokeWidth:1.5})]})]})})}),(0,y.jsx)(m.ZP.Separator,{}),(0,y.jsx)(j.Z,{scrollable:!0,size:"small",type:"underlined",defaultActiveId:"edge_logs",listClassNames:"px-2",children:d.vc.schemas.map(function(e){return(0,y.jsx)(j.Z.Panel,{id:e.reference,label:e.name,className:"px-4 pb-4",children:(0,y.jsx)(i.Z,{head:[(0,y.jsx)(i.Z.th,{className:"text-xs !p-2",children:"Path"},"path"),(0,y.jsx)(i.Z.th,{className:"text-xs !p-2",children:"Type"},"type")],body:e.fields.sort(function(e,t){return e.path-t.path}).map(function(e){return(0,y.jsx)(b,{field:e},e.path)})})},e.reference)})})]})]})]})};var b=function(e){var t=e.field,r=(0,l.useState)(!1),s=r[0],o=r[1];return(0,y.jsxs)(i.Z.tr,{children:[(0,y.jsxs)(i.Z.td,{className:"font-mono text-xs !p-2 cursor-pointer hover:text-foreground transition flex items-center space-x-2",onClick:function(){return(0,a.vQ)(t.path,function(){o(!0),setTimeout(function(){return o(!1)},3e3)})},children:[(0,y.jsx)("span",{children:t.path}),s?(0,y.jsxs)(n.fC,{delayDuration:0,children:[(0,y.jsx)(n.xz,{children:(0,y.jsx)(g.Z,{size:14,strokeWidth:3,className:"text-brand"})}),(0,y.jsx)(n.h_,{children:(0,y.jsxs)(n.VY,{side:"bottom",children:[(0,y.jsx)(n.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,y.jsx)("span",{className:"text-xs text-foreground",children:"Copied"})})]})})]}):(0,y.jsxs)(n.fC,{delayDuration:0,children:[(0,y.jsx)(n.xz,{children:(0,y.jsx)(v.Z,{size:"tiny",strokeWidth:1.5})}),(0,y.jsx)(n.h_,{children:(0,y.jsxs)(n.VY,{side:"bottom",children:[(0,y.jsx)(n.Eh,{className:"radix-tooltip-arrow"}),(0,y.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,y.jsx)("span",{className:"text-xs text-foreground",children:"Copy value"})})]})})]})]}),(0,y.jsx)(i.Z.td,{className:"font-mono text-xs !p-2",children:t.type})]})}},34671:function(e,t,r){"use strict";var n=r(95235),s=r(58943),i=r(73437),a=r(2784),o=r(9747),c=r(37552);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.PJ)(i.up),n=(0,a.useState)({sql:(null==t?void 0:t.sql)||"",project:e,iso_timestamp_start:t.iso_timestamp_start?t.iso_timestamp_start:r.calcFrom(),iso_timestamp_end:t.iso_timestamp_end?t.iso_timestamp_end:r.calcTo()}),l=n[0],u=n[1],p=void 0!==e&&!!l.sql,f=(0,i.GT)(l),m=(0,s.a)(["projects",e,"logs",f],function(t){var r=t.signal;return(0,c.U2)("".concat(o.T5,"/projects/").concat(e,"/analytics/endpoints/logs.all?").concat(f),{signal:r})},{enabled:p,refetchOnWindowFocus:!1}),h=m.data,x=m.error,j=m.isLoading,g=m.isRefetching,v=m.refetch,y=x?x.message:null;return!y&&null!=h&&h.error&&(y=null==h?void 0:h.error),{params:l,isLoading:p&&j||g,logData:(0,c.d8)(h)&&h.result?h.result:[],error:y,changeQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";u(function(t){return d(d({},t),{},{sql:e})})},runQuery:function(){return v()},setParams:u}}},60305:function(e,t,r){"use strict";r.d(t,{_:function(){return o}});var n=r(2784),s=r(73437),i=r(97415),a=r(65308),o=function(e){var t,r=(0,a.l)(),o=(0,i.G)({orgSlug:null==r?void 0:r.slug}).data,c=(0,n.useState)(!1),l=c[0],d=c[1],u=(0,s.dP)(e,null==o?void 0:null===(t=o.plan)||void 0===t?void 0:t.id);return(0,n.useEffect)(function(){u&&d(!0)},[e]),{showUpgradePrompt:l,setShowUpgradePrompt:d,shouldShowUpgradePrompt:u}}},42102:function(e,t,r){"use strict";r.r(t),r.d(t,{LogsExplorerPage:function(){return I},default:function(){return V}});var n=r(20406),s=r(95235),i=r(12741),a=r(81333),o=r(28526),c=r.n(o),l=r(28879),d=r.n(l),u=r(46776),p=r(5632),f=r(2784),m=r(36849),h=r(43635),x=r(14665),j=r(8647),g=r(4300),v=r(73437),y=r(64175),b=r(11425),w=r(80188),N=r(68335),_=r(92587),O=r(87183),P=r(82269),S=r(55830),Z=r(62350),C=r(81229),k=r(40780),E=["onSuccess"];function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function z(){return(z=(0,n.Z)(c().mark(function e(t,r){var n,s,i,a,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectRef,s=t.payload,e.next=3,(0,C.v_)("/platform/projects/{ref}/content",{params:{path:{ref:n}},body:{id:s.id,name:s.name,description:s.description,owner_id:s.owner_id,type:s.type,visibility:s.visibility,content:s.content},signal:r});case 3:if(a=(i=e.sent).data,!(o=i.error)){e.next=8;break}throw o;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSuccess,r=(0,P.Z)(e,E),i=(0,S.NL)();return(0,Z.D)(function(e){return function(e,t){return z.apply(this,arguments)}(e)},function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({onSuccess:function(e,r,s){return(0,n.Z)(c().mark(function n(){var a;return c().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.projectRef,n.next=3,Promise.all([i.invalidateQueries(k.$.list(a))]);case 3:return n.next=5,null==t?void 0:t(e,r,s);case 5:case"end":return n.stop()}},n)}))()}},r))},T=r(70203),R=r(34671),L=r(60305),F=r(210),U=r(97415),W=r(52322);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var I=function(){(0,v.Q9)();var e,t=(0,T.oR)().ui,r=(0,p.useRouter)(),s=(0,g.UO)(),o=s.ref,l=s.q,u=s.ite,b=s.its,P=(0,T.lL)(),S=(0,f.useState)((0,F.k$)()),Z=S[0],C=S[1],k=(0,f.useState)("select\n  cast(timestamp as datetime) as timestamp,\n  event_message, metadata \nfrom edge_logs \nlimit 5"),E=k[0],q=k[1],z=(0,f.useState)(!1),Q=z[0],I=z[1],V=(0,f.useState)([]),A=V[0],G=V[1],M=(0,U.G)({orgSlug:null==P?void 0:P.slug}).data,X=(0,R.Z)(o,{iso_timestamp_start:b||void 0,iso_timestamp_end:u||void 0}),Y=X.params,J=X.logData,K=X.error,B=X.isLoading,H=X.changeQuery,ee=X.runQuery,et=X.setParams,er=(0,T._)("project-content-".concat(o,"-recent-log-sql"),[]),en=(0,a.Z)(er,2),es=en[0],ei=en[1],ea=function(e){ei([].concat((0,i.Z)(es),[$($({},{schema_version:"1",favorite:!1,sql:"",content_id:""}),e)]))},eo=(0,L._)(Y.iso_timestamp_start),ec=eo.showUpgradePrompt,el=eo.setShowUpgradePrompt;(0,f.useEffect)(function(){l&&ed({mode:"custom",searchString:l})},[]),(0,f.useEffect)(function(){var e=[],t=Y.iso_timestamp_start?d()(Y.iso_timestamp_start):d()(),r=Y.iso_timestamp_end?d()(Y.iso_timestamp_end):d()(),n=Math.abs(t.diff(r,"days"));E&&!E.includes("limit")&&n>v.$K&&e.push({text:"When querying large date ranges, include a LIMIT clause."}),G(e)},[E,Y.iso_timestamp_start,Y.iso_timestamp_end]),(0,f.useEffect)(function(){if(b){var e;(0,v.dP)(b,null==M?void 0:null===(e=M.plan)||void 0===e?void 0:e.id)&&el(!ec)}},[b,M]);var ed=function(e){q(e.searchString),H(e.searchString),C((0,F.k$)()),r.push({pathname:r.pathname,query:$($({},r.query),{},{q:e.searchString})}),ea({sql:e.searchString})},eu=function(e){var t="string"==typeof e&&e||E;e&&"string"==typeof e&&q(e),H(t),ee(),r.push({pathname:r.pathname,query:$($({},r.query),{},{q:t})}),ea({sql:t})},ep=D({onError:function(e){console.error(e),I(!1),t.setNotification({error:e,category:"error",message:"Failed to save query: ".concat(e.message)})},onSuccess:function(e){I(!1),t.setNotification({category:"success",message:'Saved "'.concat(e[0].name,'" log query')})}}),ef=ep.isLoading,em=ep.mutate;return(0,W.jsxs)("div",{className:"w-full h-full px-5 py-6 mx-auto",children:[(0,W.jsx)(_.Z,{}),(0,W.jsxs)("div",{className:"flex flex-col flex-grow h-full gap-4",children:[(0,W.jsxs)("div",{className:"border rounded",children:[(0,W.jsx)(v.dL,{defaultFrom:Y.iso_timestamp_start||"",defaultTo:Y.iso_timestamp_end||"",onDateChange:function(e){var t,n=e.to,s=e.from;(0,v.dP)(s,null==M?void 0:null===(t=M.plan)||void 0===t?void 0:t.id)?el(!ec):(et(function(e){return $($({},e),{},{iso_timestamp_start:s||"",iso_timestamp_end:n||""})}),r.push({pathname:r.pathname,query:$($({},r.query),{},{its:s||"",ite:n||""})}))},onSelectSource:function(e){q(function(t){return t+e}),C((0,F.k$)())},onClear:function(){q(""),C((0,F.k$)()),H("")},onRun:eu,hasEditorValue:!!E,templates:v.xN.filter(function(e){return"custom"===e.mode}),onSelectTemplate:ed,onSave:function(){I(!Q)},isLoading:B,warnings:A}),(0,W.jsxs)("div",{className:"h-48 min-h-[7rem]",children:[(0,W.jsx)(O.Z,{active:B}),(0,W.jsx)(w.ZP,{id:Z,language:"pgsql",defaultValue:E,onInputChange:function(e){return q(e||"")},onInputRun:eu})]})]}),(0,W.jsxs)("div",{className:"relative flex flex-col flex-grow",children:[(0,W.jsx)(N.Z,{active:B,children:(0,W.jsx)("div",{className:"flex flex-grow h-full",children:(0,W.jsx)(v.ol,{params:Y,data:J,error:K,projectRef:o})})}),(0,W.jsx)("div",{className:"flex flex-row justify-end mt-2",children:(0,W.jsx)(y.Z,{show:ec,setShowUpgradePrompt:el})})]})]}),(0,W.jsx)(m.C,{size:"medium",onCancel:function(){return I(!Q)},header:"Save log query",visible:Q,hideFooter:!0,children:(0,W.jsx)(h.Z,{initialValues:{name:"",desdcription:""},onSubmit:(e=(0,n.Z)(c().mark(function e(t,r){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(0,r.setSubmitting)(!0),em({projectRef:o,payload:{id:(0,F.k$)(),name:t.name,description:t.description||"",type:"log_sql",content:{content_id:Z,sql:E,schema_version:"1",favorite:!1},visibility:"user"}});case 4:case"end":return e.stop()}},e)})),function(t,r){return e.apply(this,arguments)}),children:function(){return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{className:"py-4",children:(0,W.jsx)(m.C.Content,{children:(0,W.jsxs)("div",{className:"space-y-6",children:[(0,W.jsx)(x.Z,{layout:"horizontal",label:"Name",id:"name"}),(0,W.jsx)("div",{className:"text-area-text-sm",children:(0,W.jsx)(x.Z.TextArea,{layout:"horizontal",labelOptional:"Optional",label:"Description",id:"description",rows:2})})]})})}),(0,W.jsx)("div",{className:"py-3 border-t bg-surface-100",children:(0,W.jsx)(m.C.Content,{children:(0,W.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,W.jsx)(j.z,{size:"tiny",type:"default",onClick:function(){return I(!Q)},children:"Cancel"}),(0,W.jsx)(j.z,{size:"tiny",loading:ef,htmlType:"submit",children:"Save"})]})})})]})}})})]})};I.getLayout=function(e){return(0,W.jsx)(b.Uj,{children:e})};var V=(0,u.Pi)(I)},50893:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/logs/explorer",function(){return r(42102)}])}},function(e){e.O(0,[1187,8421,4747,7287,7898,6218,9001,3958,8119,9574,2514,2187,2645,6823,7725,3437,9774,2888,179],function(){return e(e.s=50893)}),_N_E=e.O()}]);