(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5589],{50838:function(e,r,n){"use strict";n.d(r,{F:function(){return i},n:function(){return t}});var t=function(e){var r;return!!(null!=e&&e.SMTP_ADMIN_EMAIL&&null!=e&&e.SMTP_SENDER_NAME&&null!=e&&e.SMTP_USER&&null!=e&&e.SMTP_HOST&&null!=e&&e.SMTP_PASS&&null!=e&&e.SMTP_PORT&&(null!==(r=null==e?void 0:e.SMTP_MAX_FREQUENCY)&&void 0!==r?r:0)>=0)},i=function(e){var r,n,i,s,o,a,l,c;return{ENABLE_SMTP:t(e),SMTP_ADMIN_EMAIL:null!==(r=null==e?void 0:e.SMTP_ADMIN_EMAIL)&&void 0!==r?r:"",SMTP_SENDER_NAME:null!==(n=null==e?void 0:e.SMTP_SENDER_NAME)&&void 0!==n?n:"",SMTP_USER:null!==(i=null==e?void 0:e.SMTP_USER)&&void 0!==i?i:"",SMTP_HOST:null!==(s=null==e?void 0:e.SMTP_HOST)&&void 0!==s?s:"",SMTP_PASS:null!==(o=null==e?void 0:e.SMTP_PASS)&&void 0!==o?o:"",SMTP_PORT:null!==(a=null==e?void 0:e.SMTP_PORT)&&void 0!==a?a:"465",SMTP_MAX_FREQUENCY:null!==(l=null==e?void 0:e.SMTP_MAX_FREQUENCY)&&void 0!==l?l:60,RATE_LIMIT_EMAIL_SENT:null!==(c=null==e?void 0:e.RATE_LIMIT_EMAIL_SENT)&&void 0!==c?c:30}}},57626:function(e,r,n){"use strict";n.d(r,{iN:function(){return E},ph:function(){return u},by:function(){return p},hj:function(){return f},B4:function(){return x},S0:function(){return h},ld:function(){return i}});var t=n(52322);function i(e){return(0,t.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,t.jsx)("h1",{className:"text-foreground mb-8 text-3xl",children:e.header}),(0,t.jsx)("div",{className:"space-y-20",children:e.children})]})}var s=n(39097),o=n.n(s),a=n(29071),l=n(8647),c=n(95223),u=function(e){var r=e.title,n=e.description,i=e.docsUrl;return(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"text-foreground text-xl",children:(0,t.jsx)(a.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:r})}),n&&(0,t.jsx)("div",{className:"text-foreground-lighter text-sm",children:(0,t.jsx)(a.D,{children:n})})]}),void 0!==i&&(0,t.jsx)(l.z,{asChild:!0,type:"default",icon:(0,t.jsx)(c.Z,{}),children:(0,t.jsx)(o(),{href:i,target:"_blank",rel:"noreferrer",children:"Documentation"})})]})},d=n(2784),f=function(e){var r=e.children,n=e.id,i=e.header,s=e.disabled,o=e.visible,a=e.className;return(0,t.jsxs)("div",{id:n,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(s?" opacity-30":" opacity-100"),"".concat(void 0===o||o?" block":" hidden"),"".concat(a)].join(" "),children:[i,r]})},h=function(e){var r=e.children,n=e.className,i=void 0===n?"":n,s=e.description;return void 0!==s?(0,t.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(i),children:[(0,t.jsx)("label",{className:"text-foreground text-sm",children:r}),s]}):(0,t.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(i),children:r})},m=function(){return(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,t.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,t.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,t.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]})},x=function(e){var r=e.children,n=e.loading,i=e.fullWidth,s=e.className;return(0,t.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(i&&"!col-span-12","\n        ").concat(s,"\n      "),children:void 0===n||n?d.Children.map(r,function(e){return(0,t.jsx)(m,{})}):r})},p=function(e){var r=e.children,n=e.header,i=e.footer;return(0,t.jsxs)("div",{className:" bg-surface-100 border-default overflow-hidden  rounded-md border shadow",children:[n&&(0,t.jsx)("div",{className:"border-default border-b px-8 py-4",children:n}),(0,t.jsx)("div",{className:"divide-border flex flex-col gap-0 divide-y",children:r}),i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"border-default border-t"}),i]})]})},E=function(e){var r=e.form,n=e.hasChanges,i=void 0===n?void 0:n,s=e.handleReset,o=e.helper,a=e.disabled,c=e.isSubmitting,u=e.submitText,d=c||void 0!==a&&a||!i&&void 0!==i;return(0,t.jsxs)("div",{className:["flex w-full items-center gap-2",o?"justify-between":"justify-end"].join(" "),children:[o&&(0,t.jsx)("span",{className:"text-sm text-foreground-lighter",children:o}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.z,{disabled:d,type:"default",htmlType:"reset",onClick:function(){return s()},children:"Cancel"}),(0,t.jsx)(l.z,{form:r,type:"primary",htmlType:"submit",disabled:d,loading:c,children:void 0===u?"Save":u})]})]})}},57324:function(e,r,n){"use strict";n.d(r,{_:function(){return E}});var t=n(95235),i=n(82269),s=n(20406),o=n(28526),a=n.n(o),l=n(55830),c=n(62350),u=n(62202),d=n(81229),f=n(24770),h=["onSuccess","onError"];function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)}return n}function x(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach(function(r){(0,t.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function p(){return(p=(0,s.Z)(a().mark(function e(r){var n,t,i,s,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.projectRef,t=r.config,e.next=3,(0,d.r$)("/platform/auth/{ref}/config",{params:{path:{ref:n}},body:x({},t)});case 3:if(s=(i=e.sent).data,!(o=i.error)){e.next=8;break}throw o;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.onSuccess,n=e.onError,t=(0,i.Z)(e,h),o=(0,l.NL)();return(0,c.D)(function(e){return function(e){return p.apply(this,arguments)}(e)},x({onSuccess:function(e,n,t){return(0,s.Z)(a().mark(function i(){var s;return a().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return s=n.projectRef,i.next=3,Promise.all([o.invalidateQueries(f.o.authConfig(s))]);case 3:return i.next=5,null==r?void 0:r(e,n,t);case 5:case"end":return i.stop()}},i)}))()},onError:function(e,r,t){return(0,s.Z)(a().mark(function i(){return a().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:void 0===n?u.ZP.error("Failed to update auth configuration: ".concat(e.message)):n(e,r,t);case 1:case"end":return i.stop()}},i)}))()}},t))}},52311:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return P}});var t=n(59491),i=n(95235),s=n(88883),o=n(43991),a=n(39097),l=n.n(a),c=n(2784),u=n(63955),d=n(16473),f=n(50077),h=n(25208),m=n(23733),x=n(8647),p=n(30195),E=n(45812),j=n(57626),_=n(22812),v=n(35933),T=n(57324),b=n(70203),g=n(50838),N=n(62202),S=n(52322);function M(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)}return n}function I(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?M(Object(n),!0).forEach(function(r){(0,i.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var R=function(){var e="auth-rate-limits-form",r=(0,o.UO)().ref,n=(0,b.Xo)(t.KA.UPDATE,"custom_config_gotrue"),i=(0,v.$E)({projectRef:r}),a=i.data,M=i.error,R=i.isLoading,A=i.isError,y=i.isSuccess,L=(0,T._)({onSuccess:function(){N.ZP.success("Rate limits successfully updated")},onError:function(e){N.ZP.error("Failed to update rate limits: ".concat(e.message))}}),P=L.mutate,O=L.isLoading,w=(null==a?void 0:a.EXTERNAL_EMAIL_ENABLED)&&(0,g.n)(a),D=(null==a?void 0:a.EXTERNAL_PHONE_ENABLED)&&!(null!=a&&a.SMS_AUTOCONFIRM),F=p.Ry({RATE_LIMIT_TOKEN_REFRESH:p.oQ.number().min(0,"Must be not be lower than 0").max(32767,"Must not be more than 32,767 an 5 minutes"),RATE_LIMIT_VERIFY:p.oQ.number().min(0,"Must be not be lower than 0").max(32767,"Must not be more than 32,767 an 5 minutes"),RATE_LIMIT_EMAIL_SENT:p.oQ.number().min(0,"Must be not be lower than 0").max(32767,"Must not be more than 32,767 an hour"),RATE_LIMIT_SMS_SENT:p.oQ.number().min(0,"Must be not be lower than 0").max(32767,"Must not be more than 32,767 an hour")}),k=(0,u.cI)({resolver:(0,s.F)(F),defaultValues:{RATE_LIMIT_TOKEN_REFRESH:0,RATE_LIMIT_VERIFY:0,RATE_LIMIT_EMAIL_SENT:0,RATE_LIMIT_SMS_SENT:0}});return(0,c.useEffect)(function(){y&&k.reset({RATE_LIMIT_TOKEN_REFRESH:a.RATE_LIMIT_TOKEN_REFRESH,RATE_LIMIT_VERIFY:a.RATE_LIMIT_VERIFY,RATE_LIMIT_EMAIL_SENT:a.RATE_LIMIT_EMAIL_SENT,RATE_LIMIT_SMS_SENT:a.RATE_LIMIT_SMS_SENT})},[y]),(0,S.jsxs)("div",{children:[(0,S.jsx)(j.ph,{title:"Rate Limits",description:"Safeguard against bursts of incoming traffic to prevent abuse and maximize stability",docsUrl:"https://supabase.com/docs/guides/platform/going-into-prod#rate-limiting-resource-allocation--abuse-prevention"}),A&&(0,S.jsx)(E.Z,{subject:"Failed to retrieve auth config rate limits",error:M}),R&&(0,S.jsx)(_.A,{}),y&&(0,S.jsx)(d.l0,I(I({},k),{},{children:(0,S.jsx)("form",{id:e,className:"space-y-4",onSubmit:k.handleSubmit(function(e){if(!r)return console.error("Project ref is required");var n={};["RATE_LIMIT_TOKEN_REFRESH","RATE_LIMIT_VERIFY","RATE_LIMIT_EMAIL_SENT","RATE_LIMIT_SMS_SENT"].forEach(function(r){e[r]!==(null==a?void 0:a[r])&&(n[r]=e[r])}),P({projectRef:r,config:n},{onSuccess:function(){return k.reset(e)}})}),children:(0,S.jsxs)(j.by,{footer:(0,S.jsx)("div",{className:"flex py-4 px-8",children:(0,S.jsx)(j.iN,{form:e,isSubmitting:O,hasChanges:k.formState.isDirty,handleReset:function(){return k.reset()},disabled:!n,helper:n?void 0:"You need additional permissions to update authentication settings"})}),children:[(0,S.jsx)(j.hj,{id:"email-sent",header:(0,S.jsx)(j.S0,{description:(0,S.jsx)("p",{className:"text-foreground-light text-sm",children:"Number of emails that can be sent per hour from your project"}),children:"Rate limit for sending emails"}),children:(0,S.jsx)(j.B4,{loading:!1,children:(0,S.jsx)(d.Wi,{control:k.control,name:"RATE_LIMIT_EMAIL_SENT",render:function(e){var n=e.field;return(0,S.jsxs)(d.xJ,{children:[(0,S.jsx)(d.NI,{children:(0,S.jsx)(f.I,I({disabled:!w,type:"number"},n))}),(0,S.jsx)(d.zG,{}),!w&&(0,S.jsxs)(h.bZ,{children:[(0,S.jsx)(m.Z,{strokeWidth:1.5}),(0,S.jsxs)(h.Cd,{children:[!a.EXTERNAL_EMAIL_ENABLED&&"Enable email-based logins to update this configuration",!(0,g.n)(a)&&"Custom SMTP provider is required to update this configuration"]}),(0,S.jsxs)(h.X,{children:[(0,S.jsxs)("p",{className:"!leading-tight",children:[!a.EXTERNAL_EMAIL_ENABLED&&"Head over to the providers page to enable email provider before updating your rate limit",!(0,g.n)(a)&&"The built-in email service has a fixed rate limit. You will need to set up your own custom SMTP provider to update your email rate limit"]}),(0,S.jsx)(x.z,{asChild:!0,type:"default",className:"mt-2",children:(0,S.jsx)(l(),{href:a.EXTERNAL_EMAIL_ENABLED?"/project/".concat(r,"/settings/auth"):"/project/".concat(r,"/auth/providers"),children:a.EXTERNAL_EMAIL_ENABLED?"View SMTP settings":"View providers configuration"})})]})]})]})}})})}),(0,S.jsx)(j.hj,{id:"sms-sent",header:(0,S.jsx)(j.S0,{description:(0,S.jsx)("p",{className:"text-foreground-light text-sm",children:"Number of SMS messages that can be sent per hour from your project"}),children:"Rate limit for sending SMS messages"}),children:(0,S.jsx)(j.B4,{loading:!1,children:(0,S.jsx)(d.Wi,{control:k.control,name:"RATE_LIMIT_SMS_SENT",render:function(e){var n=e.field;return(0,S.jsxs)(d.xJ,{children:[(0,S.jsx)(d.NI,{children:(0,S.jsx)(f.I,I({disabled:!D,type:"number"},n))}),(0,S.jsx)(d.zG,{}),!D&&(0,S.jsxs)(h.bZ,{children:[(0,S.jsx)(m.Z,{strokeWidth:1.5}),(0,S.jsx)(h.Cd,{children:"Enable phone-based logins to update this configuration"}),(0,S.jsxs)(h.X,{children:[(0,S.jsx)("p",{className:"!leading-tight",children:"Head over to the providers page to enable phone provider and phone confirmations before updating your rate limit"}),(0,S.jsx)(x.z,{asChild:!0,type:"default",className:"mt-2",children:(0,S.jsx)(l(),{href:"/project/".concat(r,"/auth/providers"),children:"View providers configuration"})})]})]})]})}})})}),(0,S.jsx)(j.hj,{id:"token-refresh",header:(0,S.jsx)(j.S0,{description:(0,S.jsx)("p",{className:"text-foreground-light text-sm",children:"Number of sessions that can be refreshed in a 5 minute interval"}),children:"Rate limit for token refreshes"}),children:(0,S.jsx)(j.B4,{loading:!1,children:(0,S.jsx)(d.Wi,{control:k.control,name:"RATE_LIMIT_TOKEN_REFRESH",render:function(e){var r=e.field;return(0,S.jsxs)(d.xJ,{children:[(0,S.jsx)(d.NI,{children:(0,S.jsx)(f.I,I({type:"number"},r))}),r.value>0&&(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("p",{className:"text-foreground-lighter text-sm",children:["This is equivalent to ",12*r.value," requests per hour"]})}),(0,S.jsx)(d.zG,{})]})}})})}),(0,S.jsx)(j.hj,{id:"verify",header:(0,S.jsx)(j.S0,{description:(0,S.jsx)("p",{className:"text-foreground-light text-sm",children:"Number of OTP/Magic link verifications that can be made in a 5 minute interval"}),children:"Rate limit for token verifications"}),children:(0,S.jsx)(j.B4,{loading:!1,children:(0,S.jsx)(d.Wi,{control:k.control,name:"RATE_LIMIT_VERIFY",render:function(e){var r=e.field;return(0,S.jsxs)(d.xJ,{children:[(0,S.jsx)(d.NI,{children:(0,S.jsx)(f.I,I({type:"number"},r))}),r.value>0&&(0,S.jsxs)("p",{className:"text-foreground-lighter text-sm",children:["This is equivalent to ",12*r.value," requests per hour"]}),(0,S.jsx)(d.zG,{})]})}})})})]})})}))]})},A=n(11425),y=n(48125),L=function(){return(0,b.Xo)(t.KA.READ,"custom_config_gotrue")?(0,S.jsx)(j.ld,{children:(0,S.jsx)(R,{})}):(0,S.jsx)(y.Z,{isFullPage:!0,resourceText:"access your project's auth rate limit settings"})};L.getLayout=function(e){return(0,S.jsx)(A.g1,{children:e})};var P=L},29345:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/rate-limits",function(){return n(52311)}])}},function(e){e.O(0,[1187,8421,4747,7287,7898,6218,2514,2187,2645,6823,7725,9774,2888,179],function(){return e(e.s=29345)}),_N_E=e.O()}]);