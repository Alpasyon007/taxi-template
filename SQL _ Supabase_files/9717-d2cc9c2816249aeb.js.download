"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9717],{62644:function(e,n,r){r.d(n,{E:function(){return c},h:function(){return f}});var t=r(2784),s=r(16587),a=r(41503),i=r(8647),o=r(52322),c=function(e){var n=e.options,r=void 0===n?[]:n,c=e.activeOptions,l=void 0===c?[]:c,d=e.valueKey,u=e.labelKey,p=e.name,m=e.onSaveFilters,h=(0,t.useState)(!1),x=h[0],f=h[1],g=(0,t.useState)([]),v=g[0],j=g[1],b=l.map(function(e){return r.find(function(n){return n[d]===e})[u]});return(0,o.jsx)(s.Z,{side:"bottom",align:"start",open:x,onOpenChange:function(){return f(!x)},header:(0,o.jsxs)("div",{className:"prose text-xs",children:["Select ",p.toLowerCase()]}),overlay:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"space-y-4 px-3 py-3 min-w-[170px]",children:(0,o.jsx)(a.Z.Group,{id:"projects",onChange:function(e){var n=e.target.value;v.includes(n)?j(v.filter(function(e){return e!==n})):j(v.concat(n))},options:r.map(function(e){return{value:e[d],label:e[u],defaultChecked:l.includes(e[d])}})})}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,o.jsx)(i.z,{size:"tiny",type:"default",onClick:function(){m([]),f(!1)},children:"Clear"}),(0,o.jsx)(i.z,{type:"primary",onClick:function(){m(v),f(!1)},children:"Save"})]})]}),children:(0,o.jsx)(i.z,{asChild:!0,type:l.length>0?"default":"dashed",onClick:function(){return f(!1)},children:(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{children:p}),l.length>0&&(0,o.jsx)("span",{className:"mr-1",children:":"}),l.length>=3?(0,o.jsxs)("span",{children:[b[0]," and ",l.length-1," others"]}):l.length>0?(0,o.jsx)("span",{children:b.join(", ")}):null]})})})},l=r(57626),d=r(54947),u=r(29298),p=r(28879),m=r.n(p),h=r(24888),x=r(14665),f=function(e){var n=e.selectedLog,r=e.onClose,t=(0,u.Sy)().data,s=(0,d.tl)().data;return null==t||t.find(function(e){return e.ref===(null==n?void 0:n.target.metadata.project_ref)}),null==s||s.find(function(e){return e.slug===(null==n?void 0:n.target.metadata.org_slug)}),(0,o.jsxs)(h.ZP,{size:"large",header:'"'.concat(null==n?void 0:n.action.name,'" on ').concat(m()(null==n?void 0:n.occurred_at).format("DD MMM YYYY, HH:mm:ss")),visible:void 0!==n,onCancel:r,cancelText:"Close",children:[(0,o.jsx)(l.hj,{header:(0,o.jsx)(l.S0,{children:"General"}),children:(0,o.jsx)(l.B4,{loading:!1,children:(0,o.jsx)(x.Z,{readOnly:!0,size:"small",label:"Occurred at",value:null==n?void 0:n.occurred_at,descriptionText:m()(null==n?void 0:n.occurred_at).format("DD MMM YYYY, HH:mm:ss (ZZ)")})})}),(0,o.jsx)(h.ZP.Separator,{}),(0,o.jsx)(l.hj,{header:(0,o.jsx)(l.S0,{children:"Actor"}),children:(0,o.jsxs)(l.B4,{loading:!1,children:[(0,o.jsx)(x.Z,{readOnly:!0,size:"small",label:"Actor ID",value:null==n?void 0:n.actor.id}),(0,o.jsx)(x.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==n?void 0:n.actor.metadata,null,2)})]})}),(0,o.jsx)(h.ZP.Separator,{}),(0,o.jsx)(l.hj,{header:(0,o.jsx)(l.S0,{children:"Action"}),children:(0,o.jsxs)(l.B4,{loading:!1,children:[(0,o.jsx)(x.Z,{readOnly:!0,size:"small",label:"Name",value:null==n?void 0:n.action.name}),(0,o.jsx)(x.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==n?void 0:n.action.metadata,null,2)})]})}),(0,o.jsx)(h.ZP.Separator,{}),(0,o.jsx)(l.hj,{header:(0,o.jsx)(l.S0,{children:"Target"}),children:(0,o.jsxs)(l.B4,{loading:!1,children:[(0,o.jsx)(x.Z,{readOnly:!0,size:"small",label:"Name",value:null==n?void 0:n.target.description}),(0,o.jsx)(x.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==n?void 0:n.target.metadata,null,2)})]})})]})}},59021:function(e,n,r){var t=r(39097),s=r.n(t),a=r(49631),i=r(88281),o=r(29298),c=r(97415),l=r(52322);n.Z=function(e){var n,r=e.organization,t=(0,o.Sy)({}).data,d=null!==(n=null==t?void 0:t.filter(function(e){return e.organization_id===(null==r?void 0:r.id)}).length)&&void 0!==n?n:0,u=(0,c.G)({orgSlug:null==r?void 0:r.slug}).data;return d>0||(null==u?void 0:u.plan)===void 0||"free"===u.plan.id?null:(0,l.jsx)(i.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Your organization is on the ".concat(u.plan.name," plan with no projects running"),icon:(0,l.jsx)(a.Z,{strokeWidth:2}),description:(0,l.jsxs)("div",{children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,l.jsx)(s(),{href:"/org/".concat(null==r?void 0:r.slug,"/billing"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"organization billing settings ."})]})})}},96514:function(e,n,r){r.d(n,{Z:function(){return k}});var t=r(20406),s=r(28526),a=r.n(s),i=r(77087),o=r(66432),c=r(8121),l=r(38617),d=r(2784),u=r(36849),p=r(95235),m=r(82269),h=r(62350),x=r(62202),f=r(81229),g=["onSuccess","onError"];function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function j(){return(j=(0,t.Z)(a().mark(function e(n){var r,t,s,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.hcaptchaToken,e.next=3,(0,f.v_)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:r}},body:{hcaptchaToken:t}});case 3:if(i=(s=e.sent).data,!(o=s.error)){e.next=8;break}throw o;case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,s=(0,m.Z)(e,g);return(0,h.D)(function(e){return function(e){return j.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach(function(n){(0,p.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,s){return(0,t.Z)(a().mark(function t(){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==n?void 0:n(e,r,s);case 2:case"end":return t.stop()}},t)}))()},onError:function(e,n,s){return(0,t.Z)(a().mark(function t(){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:void 0===r?x.Am.error("Failed to setup intent: ".concat(e.message)):r(e,n,s);case 1:case"end":return t.stop()}},t)}))()}},s))},y=r(70203),w=r(9747),N=r(62941),O=r(8647),S=r(52322),_=function(e){var n,r=e.returnUrl,s=e.onCancel,i=e.onConfirm,c=(0,y.oR)().ui,l=(0,o.useStripe)(),p=(0,o.useElements)(),m=(0,d.useState)(!1),h=m[0],x=m[1],f=(n=(0,t.Z)(a().mark(function e(n){var t,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!(!l||!p)){e.next=4;break}return console.error("Stripe.js has not loaded"),e.abrupt("return");case 4:return x(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto"),e.next=8,l.confirmSetup({elements:p,redirect:"if_required",confirmParams:{return_url:r}});case 8:(t=e.sent.error)?(x(!1),c.setNotification({category:"error",message:null!==(s=null==t?void 0:t.message)&&void 0!==s?s:" Failed to save card details"})):(x(!1),i()),void 0!==document&&document.body.classList.remove("!pointer-events-auto");case 12:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)});return(0,S.jsxs)("form",{onSubmit:f,children:[(0,S.jsx)(u.C.Content,{children:(0,S.jsx)("div",{className:"transition ".concat(h?"pointer-events-none opacity-75":"opacity-100"),children:(0,S.jsx)(o.PaymentElement,{})})}),(0,S.jsx)(u.C.Separator,{}),(0,S.jsx)(u.C.Content,{children:(0,S.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,S.jsx)(O.z,{block:!0,htmlType:"submit",type:"primary",loading:h,disabled:h,children:"Save"}),(0,S.jsx)(O.z,{htmlType:"button",type:"default",onClick:s,block:!0,disabled:h,children:"Cancel"})]})})]})},C=(0,c.J)(w.Yw),k=function(e){var n=e.visible,r=e.returnUrl,s=e.onCancel,c=e.onConfirm,p=(0,y.oR)().ui,m=(0,l.F)().resolvedTheme,h=(0,d.useState)(),x=h[0],f=h[1],g=(0,y.lL)(),v=(0,N.Y)(),j=(0,d.useState)(null),w=j[0],O=j[1],k=(0,d.useState)(null),P=k[0],Z=k[1],E=b({onSuccess:function(e){f(e)},onError:function(e){p.setNotification({category:"error",error:x.error,message:"Failed to setup intent: ".concat(e.message)})}}).mutate,A=(0,d.useCallback)(function(e){Z(e)},[]);(0,d.useEffect)(function(){var e,r,s=(e=(0,t.Z)(a().mark(function e(n){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==g?void 0:g.slug){e.next=3;break}return e.abrupt("return",console.error("Slug is required"));case 3:if(n){e.next=5;break}return e.abrupt("return",console.error("HCaptcha token required"));case 5:f(void 0),E({slug:r,hcaptchaToken:n});case 7:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)});(r=(0,t.Z)(a().mark(function e(){var r,t,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&P&&v)){e.next=16;break}if(t=w,e.prev=2,t){e.next=8;break}return e.next=6,P.execute({async:!0});case 6:t=null!==(i=null==(o=e.sent)?void 0:o.response)&&void 0!==i?i:null;case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return");case 13:return e.next=15,s(null!==(r=t)&&void 0!==r?r:void 0);case 15:D();case 16:case"end":return e.stop()}},e,null,[[2,10]])})),function(){return r.apply(this,arguments)})()},[n,P,v]);var D=function(){O(null),null==P||P.resetCaptcha()},I={clientSecret:x?x.client_secret:"",appearance:{theme:null!=m&&m.includes("dark")?"night":"flat",labels:"floating"}},z=function(){return f(void 0),s()};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(i.Z,{ref:A,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:function(){void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:function(){z(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:function(e){O(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:function(){O(null)}}),(0,S.jsx)(u.C,{hideFooter:!0,size:"medium",visible:n&&void 0!==x,header:"Add new payment method",onCancel:z,className:"PAYMENT",children:(0,S.jsx)("div",{className:"py-4 space-y-4",children:(0,S.jsx)(o.Elements,{stripe:C,options:I,children:(0,S.jsx)(_,{returnUrl:r,onCancel:z,onConfirm:function(){return f(void 0),c()}})})})})]})}},32471:function(e,n,r){var t=r(24990),s=r(52322);n.Z=function(e){var n=e.projectUpdateDisabled,r=e.projectNotActive,a=void 0!==r&&r,i=e.children;return(0,s.jsxs)(t.fC,{delayDuration:0,children:[(0,s.jsx)(t.xz,{asChild:!0,children:i}),n||a?(0,s.jsx)(t.h_,{children:(0,s.jsxs)(t.VY,{side:"bottom",children:[(0,s.jsx)(t.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:n?"Subscription changes are currently disabled. Our engineers are working on a fix.":a?"Unable to update subscription as project is currently not active":""})})]})}):null]})}},54859:function(e,n,r){var t=r(59491),s=r(97346),a=r(52322),i=function(e){var n=e.description,r=e.hasReadScope,t=e.hasWriteScope;if(r||t){var i=[r?"Read":null,t?"Write":null].filter(Boolean).map(function(e){return(0,a.jsx)("span",{className:"font-semibold text-foreground",children:e},e)}).reduce(function(e,n){return(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsx)("span",{children:" and "}),n]})});return(0,a.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,a.jsx)("div",{className:"pt-0.5",children:(0,a.jsx)(s.Z,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,a.jsxs)("div",{children:[i," ",n]})]})}return null};n.Z=function(e){var n=e.icon,r=e.name,s=e.domain,o=e.scopes;return(0,a.jsxs)("div",{className:"flex space-y-4 flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-row space-x-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:null!==n?"url('".concat(n,"')"):"none"},children:null===n&&(0,a.jsx)("p",{className:"text-foreground-light text-lg",children:r[0]})})}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:[r," (",s,") is requesting API access to an organization."]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Permissions"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,a.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,a.jsxs)("div",{className:"pt-2",children:[(0,a.jsx)(i,{description:"access to auth configurations and SSO providers.",hasReadScope:o.includes(t.YX.AUTH_READ),hasWriteScope:o.includes(t.YX.AUTH_WRITE)}),(0,a.jsx)(i,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:o.includes(t.YX.DATABASE_READ),hasWriteScope:o.includes(t.YX.DATABASE_WRITE)}),(0,a.jsx)(i,{description:"access to custom domains and vanity subdomains.",hasReadScope:o.includes(t.YX.DOMAINS_READ),hasWriteScope:o.includes(t.YX.DOMAINS_WRITE)}),(0,a.jsx)(i,{description:"access to edge functions.",hasReadScope:o.includes(t.YX.EDGE_FUNCTIONS_READ),hasWriteScope:o.includes(t.YX.EDGE_FUNCTIONS_WRITE)}),(0,a.jsx)(i,{description:"access to environments/branches.",hasReadScope:o.includes(t.YX.ENVIRONMENT_READ),hasWriteScope:o.includes(t.YX.ENVIRONMENT_WRITE)}),(0,a.jsx)(i,{description:"access to the organization and all its members.",hasReadScope:o.includes(t.YX.ORGANIZATIONS_READ),hasWriteScope:o.includes(t.YX.ORGANIZATIONS_WRITE)}),(0,a.jsx)(i,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:o.includes(t.YX.PROJECTS_READ),hasWriteScope:o.includes(t.YX.PROJECTS_WRITE)}),(0,a.jsx)(i,{description:"access to PostgREST configurations.",hasReadScope:o.includes(t.YX.REST_READ),hasWriteScope:o.includes(t.YX.REST_WRITE)}),(0,a.jsx)(i,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:o.includes(t.YX.SECRETS_READ),hasWriteScope:o.includes(t.YX.SECRETS_WRITE)})]})]})]})}},19717:function(e,n,r){r.d(n,{yV:function(){return tk},IV:function(){return re},d2:function(){return sQ},q$:function(){return rp},iB:function(){return rN},ny:function(){return rL},G3:function(){return rK},ZI:function(){return sc},cN:function(){return sW},l1:function(){return ts}});var t,s,a,i,o=r(86866),c=r(20406),l=r(28526),d=r.n(l),u=r(59491),p=r(2784),m=r(43991),h=r(45812),x=r(57626),f=r(48125),g=r(22812),v=r(95235),j=r(82269),b=r(58943),y=r(37552),w=r(9747),N=r(6815),O=["enabled"];function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function _(){return(_=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/customer"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,O);return(0,b.a)(N.O.customerProfile(n),function(e){return function(e,n){return _.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},k=r(55830),P=r(62350),Z=r(62202),E=["onSuccess","onError"];function A(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function D(){return(D=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.slug,t=n.address,s=n.invoice_settings,r){e.next=3;break}return e.abrupt("return",console.error("Slug is required"));case 3:return a={},t&&(a.address=t),s&&(a.invoice_settings=s),e.next=8,(0,y.r$)("".concat(w.T5,"/organizations/").concat(r,"/customer"),a);case 8:if(!(i=e.sent).error){e.next=11;break}throw i.error;case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,E),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return D.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(N.O.customerProfile(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update customer profile: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},z=r(70203),T=r(43635),R=r(14665),L=r(31786),F=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}],M=r(52322),U=function(){var e,n,r=(0,z.oR)().ui,t=(0,m.UO)().slug,s=C({slug:t}),a=s.data,i=s.error,l=s.isLoading,v=s.isSuccess,j=s.isError,b=I(),y=b.mutateAsync,w=b.isLoading,N="billing-address-form",O=null!==(n=null==a?void 0:a.address)&&void 0!==n?n:{},S=O.city,_=O.country,k=O.line1,P=O.line2,Z=O.postal_code,E=O.state,A=(0,z.Xo)(u.KA.BILLING_READ,"stripe.customer"),D=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.customer"),U=(e=(0,c.Z)(d().mark(function e(n,s){var a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.resetForm,t){e.next=3;break}return e.abrupt("return",console.error("Slug is required"));case 3:return e.prev=3,e.next=6,y({slug:t,address:n});case 6:r.setNotification({category:"success",message:"Successfully updated billing address"}),a({values:n,initialValues:n}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:case"end":return e.stop()}},e,null,[[3,10]])})),function(n,r){return e.apply(this,arguments)});return(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Billing Address"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,M.jsx)(o.Lc,{children:A?(0,M.jsxs)(M.Fragment,{children:[l&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),j&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve organization customer profile",error:i}),v&&(0,M.jsx)(T.Z,{validateOnBlur:!0,id:N,initialValues:{city:S,country:_,line1:k,line2:P,postal_code:Z,state:E},validate:function(e){var n={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(n.country="Please select a country"),n},onSubmit:U,children:function(e){var n=e.values,r=e.initialValues,t=e.handleReset,s=e.resetForm,i=JSON.stringify(n)!==JSON.stringify(r);return(0,p.useEffect)(function(){if(v&&void 0!==a){var e,n=null!==(e=null==a?void 0:a.address)&&void 0!==e?e:{},r={city:n.city,country:n.country,line1:n.line1,line2:n.line2,postal_code:n.postal_code,state:n.state};s({values:r,initialValues:r})}},[v]),(0,M.jsx)(x.by,{footer:(0,M.jsx)("div",{className:"flex py-4 px-8",children:(0,M.jsx)(x.iN,{form:N,isSubmitting:w,hasChanges:i,handleReset:t,helper:D?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,M.jsx)(x.hj,{children:(0,M.jsxs)(x.B4,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,M.jsx)(R.Z,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!D}),(0,M.jsx)(R.Z,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!D}),(0,M.jsxs)("div",{className:"flex space-x-2",children:[(0,M.jsxs)(L.Z,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!D,children:[(0,M.jsx)(L.Z.Option,{label:"---",value:"",children:"---"},"empty"),F.map(function(e){return(0,M.jsx)(L.Z.Option,{label:e.name,value:e.code,children:e.name},e.code)})]}),(0,M.jsx)(R.Z,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!D})]}),(0,M.jsxs)("div",{className:"flex space-x-2",children:[(0,M.jsx)(R.Z,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!D}),(0,M.jsx)(R.Z,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!D})]})]})})})}})]}):(0,M.jsx)(f.Z,{resourceText:"view this organization's billing address"})})]})},Y=r(81229),B=["onSuccess","onError"];function G(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function W(){return(W=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i,o,c,l;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.name,s=n.billing_email,a=n.opt_in_tags,i={},t&&(i.name=t),s&&(i.billing_email=s),a&&(i.opt_in_tags=a),e.next=7,(0,Y.r$)("/platform/organizations/{slug}",{params:{path:{slug:r}},body:i});case 7:if(c=(o=e.sent).data,!(l=o.error)){e.next=12;break}throw l;case 12:return e.abrupt("return",c);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,B),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return W.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?G(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.invalidateQueries(N.O.list());case 2:return a.next=4,null==n?void 0:n(e,r,t);case 4:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update organization: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},q=r(54947),K=function(){var e,n=(0,z.oR)().ui,r=(0,m.UO)().slug,t=(0,k.NL)(),s=(0,z.lL)(),a=null!=s?s:{},i=a.name,l=a.billing_email,h="org-billing-email",f=(0,z.Xo)(u.KA.UPDATE,"organizations"),g=(0,z.Xo)(u.KA.READ,"organizations"),v=V(),j=v.mutateAsync,b=v.isLoading,y=(e=(0,c.Z)(d().mark(function e(s,a){var o,c;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.resetForm,f){e.next=3;break}return e.abrupt("return",n.setNotification({category:"error",message:"You do not have the required permissions to update this organization"}));case 3:if(r){e.next=5;break}return e.abrupt("return",console.error("Slug is required"));case 5:if(i){e.next=7;break}return e.abrupt("return",console.error("Organization name is required"));case 7:return e.prev=7,e.next=10,j({slug:r,name:i,billing_email:s.billing_email});case 10:c=e.sent.billing_email,o({values:{billing_email:c},initialValues:{billing_email:c}}),(0,q.aL)(t),n.setNotification({category:"success",message:"Successfully saved settings"});case 15:return e.prev=15,e.finish(15);case 17:case"end":return e.stop()}},e,null,[[7,,15,17]])})),function(n,r){return e.apply(this,arguments)});return(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Email Recipient"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,M.jsx)(o.Lc,{children:(0,M.jsx)(T.Z,{id:h,initialValues:{billing_email:null!=l?l:""},onSubmit:y,children:function(e){var n=e.handleReset,t=e.values,s=e.initialValues,a=e.resetForm,i=JSON.stringify(t)!==JSON.stringify(s);return(0,p.useEffect)(function(){var e={billing_email:null!=l?l:""};a({values:e,initialValues:e})},[r]),(0,M.jsx)(x.by,{footer:(0,M.jsx)("div",{className:"flex py-4 px-8",children:(0,M.jsx)(x.iN,{form:h,isSubmitting:b,hasChanges:i,handleReset:n,helper:f?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,M.jsx)(x.hj,{children:(0,M.jsx)(x.B4,{fullWidth:!0,loading:!1,children:(0,M.jsx)(R.Z,{id:"billing_email",size:"small",label:"Email address",type:g?"text":"password",disabled:!f})})})})}})})]})},X=r(19011),H=r(39097),$=r.n(H),Q=r(38617),J=r(97415),ee=r(22790),en=r(95223),er=r(67270),et=r(25208),es=r(79382),ea=r(8647),ei=r(32471),eo=r(6277),ec=r(55268),el=r(68821),ed=r(28018),eu=["onSuccess","onError"];function ep(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function em(){return(em=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.slug,t=n.tier,s=n.paymentMethod,r){e.next=3;break}throw Error("slug is required");case 3:if(t){e.next=5;break}throw Error("tier is required");case 5:return a={tier:t},void 0!==s&&(a.payment_method=s),e.next=9,(0,y.gz)("".concat(w.T5,"/organizations/").concat(r,"/billing/subscription"),a);case 9:if(i=e.sent,(0,y.d8)(i)){e.next=12;break}throw i.error;case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var eh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,eu),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return em.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ep(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ep(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,new Promise(function(e){return setTimeout(e,2e3)});case 3:return a.next=5,Promise.all([s.invalidateQueries(el.U.orgSubscription(i)),s.invalidateQueries(el.U.orgPlans(i)),s.invalidateQueries(ed.Z.orgUsage(i))]);case 5:return a.next=7,null==n?void 0:n(e,r,t);case 7:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update subscription: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},ex=r(32670),ef=r(5632),eg=r(5434),ev=r(24888),ej=r(30265),eb=r(88688),ey=r(96577),ew=r.n(ey);function eN(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function eO(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?eN(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var eS=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(w.GW,"/img/spend-cap-on.png"),imageUrlLight:"".concat(w.GW,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(w.GW,"/img/spend-cap-off.png"),imageUrlLight:"".concat(w.GW,"/img/spend-cap-off--light.png")}],e_=function(){var e,n,r=(0,z.oR)().ui,t=(0,ef.useRouter)(),s=(0,m.UO)().slug,a=(0,Q.F)().resolvedTheme,i=(0,p.useState)(!1),o=i[0],l=i[1],h=(0,p.useState)(),x=h[0],f=h[1],g=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.subscriptions"),v=(0,ee.Wu)(),j="costControl"===v.panelKey,b=function(){return v.setPanelKey(void 0)},y=(0,J.G)({orgSlug:s}),N=y.data,O=y.isLoading,S=eh({onSuccess:function(){r.setNotification({category:"success",message:"Successfully ".concat(Z?"enabled":"disabled"," spend cap")}),b()},onError:function(e){r.setNotification({error:e,category:"error",message:"Failed to toggle spend cap: ".concat(e.message)})}}),_=S.mutate,C=S.isLoading,k=(null==N?void 0:null===(n=N.plan)||void 0===n?void 0:n.id)==="free",P=!(null!=N&&N.usage_billing_enabled),Z=!P&&"on"===x,E=x!==(P?"on":"off");(0,p.useEffect)(function(){j&&void 0!==N&&(f(P?"on":"off"),ex.Z.sendActivity(eO({activity:"Side Panel Viewed",source:"Dashboard",data:{title:"Spend cap",section:"Cost Control"}},s&&{orgSlug:s}),t))},[j,O,N,P]);var A=(e=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return",console.error("Org slug is required"));case 2:_({slug:s,tier:"on"===x?w.ev.PRO:w.ev.PAYG});case 4:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)});return(0,M.jsx)(ev.ZP,{size:"large",loading:O||C,disabled:k||O||!E||C||!g,visible:j,onCancel:b,onConfirm:A,header:(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsx)("h4",{children:"Spend cap"}),(0,M.jsx)(ea.z,{asChild:!0,type:"default",icon:(0,M.jsx)(en.Z,{strokeWidth:1.5}),children:(0,M.jsx)($(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:g?void 0:"You do not have permission to update spend cap",children:(0,M.jsx)(ev.ZP.Content,{children:(0,M.jsxs)("div",{className:"py-6 space-y-4",children:[(0,M.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,M.jsxs)(ej.ZP,{open:o,onOpenChange:l,children:[(0,M.jsx)(ej.ZP.Trigger,{asChild:!0,children:(0,M.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,M.jsx)(eb.Z,{strokeWidth:1.5,size:16,className:o?"rotate-90":""}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,M.jsx)(ej.ZP.Content,{asChild:!0,children:(0,M.jsx)(ec.Z,{className:"mt-4",head:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ec.Z.th,{children:(0,M.jsx)("p",{className:"text-xs",children:"Item"})}),(0,M.jsx)(ec.Z.th,{children:(0,M.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(function(e){var n=eg.D[e],r=n.features.filter(function(e){return e.usage_based});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{className:"text-xs text-foreground",children:n.title})}),(0,M.jsx)(ec.Z.td,{children:null})]},e),r.map(function(e){return(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title)})]})})})})]}),k&&(0,M.jsx)(er.b,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro plan",actions:(0,M.jsx)(ea.z,{type:"default",onClick:function(){return v.setPanelKey("subscriptionPlan")},children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,M.jsx)("div",{className:"!mt-8 pb-4",children:(0,M.jsx)("div",{className:"flex gap-3",children:eS.map(function(e){var n=x===e.value;return(0,M.jsxs)("div",{className:(0,eo.default)("col-span-4 group space-y-1",k&&"opacity-75"),onClick:function(){k||f(e.value),ex.Z.sendActivity(eO({activity:"Option Selected",source:"Dashboard",data:{title:"Spend cap",section:"Cost Control",option:e.name}},s&&{orgSlug:s}),t)},children:[(0,M.jsx)(ew(),{alt:"Spend Cap",className:(0,eo.default)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",n?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!k&&"cursor-pointer",!k&&!n&&"group-hover:border-foreground-light"),width:160,height:96,src:null!=a&&a.includes("dark")?e.imageUrl:e.imageUrlLight}),(0,M.jsx)("p",{className:(0,eo.default)("text-sm transition",!k&&"group-hover:text-foreground",n?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===x?(0,M.jsx)(er.b,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,M.jsx)(er.b,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),E&&(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("p",{className:"text-sm",children:"on"===x?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyong the included quota."})})]})})})},eC=r(28879),ek=r.n(eC),eP=["onSuccess","onError"];function eZ(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function eE(){return(eE=(0,c.Z)(d().mark(function e(n){var r,t,s,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,e.next=3,(0,Y.IV)("/platform/organizations/{slug}/billing/subscription/schedule",{params:{path:{slug:r}}});case 3:if(s=(t=e.sent).data,!(a=t.error)){e.next=8;break}throw a;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var eA=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,eP),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return eE.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?eZ(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([s.invalidateQueries(el.U.orgSubscription(r.slug))]);case 2:return a.next=4,null==n?void 0:n(e,r,t);case 4:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to setup intent: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},eD=function(e){(0,X.Z)(e);var n,r,t,s,a=(0,m.UO)().slug,i=(0,Q.F)().resolvedTheme,c=(0,ee.Wu)(),l=(0,z.P5)("disableProjectCreationAndUpdate"),d=(0,J.G)({orgSlug:a}),u=d.data,p=d.error,x=d.isLoading,f=d.isSuccess,v=d.isError,j=null==u?void 0:u.plan,b=null!==(n=null==u?void 0:u.usage_billing_enabled)&&void 0!==n&&n,y=!l&&!["team","enterprise"].includes((null==j?void 0:j.id)||""),N=eA(),O=N.mutate,S=N.isLoading;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Cost Control"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Control whether to use beyond your plans included quota"})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,M.jsx)("div",{children:(0,M.jsx)($(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:(0,M.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,M.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,M.jsx)(en.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,M.jsxs)(o.Lc,{children:[x&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),v&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:p}),f&&(0,M.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==j?void 0:j.id)||"")?(0,M.jsxs)(er.b,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==j?void 0:j.name)||""," plan"),children:[(null==j?void 0:j.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,M.jsx)($(),{href:"#breakdown",className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,M.jsxs)("p",{className:"text-sm text-foreground-light",children:["You can control whether your organization is charged for additional usage beyond the"," ",(0,M.jsx)($(),{href:"#breakdown",className:"text-green-900 transition hover:text-green-1000",children:"included quota"})," ","of your subscription plan. If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."]}),(null==u?void 0:null===(r=u.scheduled_plan_change)||void 0===r?void 0:r.target_plan)==="pro"&&(null==u?void 0:null===(t=u.scheduled_plan_change)||void 0===t?void 0:t.usage_billing_enabled)===!1&&(null==u?void 0:u.plan.id)==="pro"&&(0,M.jsxs)(et.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,M.jsx)(es.Z,{className:"h-4 w-4"}),(0,M.jsx)(et.Cd,{children:"Scheduled change"}),(0,M.jsxs)(et.X,{className:"flex flex-col gap-3",children:[(0,M.jsxs)("div",{children:["Your spend cap will be enabled on"," ",ek()(null==u?void 0:null===(s=u.scheduled_plan_change)||void 0===s?void 0:s.at).format("MMMM D, YYYY"),". You will not be charged for any over-usage moving on. If you would like to keep the spend cap disabled and scale as you go, you may still cancel the scheduled change."]}),(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{type:"default",loading:S,onClick:function(){return O({slug:a})},children:"Cancel"})})]})]}),(0,M.jsxs)("div",{className:"flex space-x-6",children:[(0,M.jsx)("div",{children:(0,M.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,M.jsx)(ew(),{alt:"Spend Cap",width:160,height:96,src:b?"".concat(w.GW,"/img/spend-cap-off").concat(null!=i&&i.includes("dark")?"":"--light",".png?v=3"):"".concat(w.GW,"/img/spend-cap-on").concat(null!=i&&i.includes("dark")?"":"--light",".png?v=3")})})}),(0,M.jsxs)("div",{children:[(0,M.jsxs)("p",{className:"mb-1",children:["Spend cap is ",b?"disabled":"enabled"]}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:b?(0,M.jsx)("span",{children:"You will be charged for any usage above the included quota."}):(0,M.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),b&&(0,M.jsx)("p",{className:"text-sm text-foreground-light mt-1",children:"Your projects will never become unresponsive. Only when your usage reaches the quota limit will you be charged for any excess usage."}),(0,M.jsx)(ei.Z,{projectUpdateDisabled:l,children:(0,M.jsx)(ea.z,{type:"default",className:"mt-4 pointer-events-auto",disabled:!y,onClick:function(){return c.setPanelKey("costControl")},children:"Change spend cap"})})]})]})]})]})]}),(0,M.jsx)(e_,{})]})},eI=r(73302),ez=function(){var e,n=C({slug:(0,m.UO)().slug}),r=n.data,t=n.error,s=n.isLoading,a=n.isError,i=n.isSuccess,c=(null!==(e=null==r?void 0:r.balance)&&void 0!==e?e:0)/100,l=c<0,d=c>0,u=l&&0!==c?c.toFixed(2).toString().replace("-",""):c.toFixed(2);return(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Credit balance"}),l&&(0,M.jsx)(eI.Z,{children:"You have credits available"}),d&&(0,M.jsx)(eI.Z,{color:"red",children:"Outstanding payments"})]}),(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Charges will be deducted from your balance first"})]})}),(0,M.jsxs)(o.Lc,{children:[s&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),a&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve organization customer profile",error:t}),i&&(0,M.jsxs)("div",{className:"flex items-end space-x-1",children:[d&&(0,M.jsx)("h4",{className:"opacity-50",children:"-"}),(0,M.jsx)("h4",{className:"opacity-50",children:"$"}),(0,M.jsx)("h2",{className:"text-4xl relative top-[2px]",children:u}),l&&(0,M.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]})]})},eT=["enabled"];function eR(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function eL(){return(eL=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/payments"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var eF=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,eT);return(0,b.a)(N.O.paymentMethods(n),function(e){return function(e,n){return eL.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?eR(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:void 0===t||t},s))},eM=r(210),eU=r(31375),eY=r(13980),eB=r.n(eY);function eG(){return(eG=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var eW=(0,p.forwardRef)(function(e,n){var r=e.color,t=e.size,s=void 0===t?24:t,a=function(e,n){if(null==e)return{};var r,t,s=function(e,n){if(null==e)return{};var r,t,s={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,["color","size"]);return p.createElement("svg",eG({ref:n,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:void 0===r?"currentColor":r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),p.createElement("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),p.createElement("line",{x1:"1",y1:"10",x2:"23",y2:"10"}))});eW.propTypes={color:eB().string,size:eB().oneOfType([eB().string,eB().number])},eW.displayName="CreditCard";var eV=r(12223);function eq(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var eK=function(e){return(0,M.jsx)(eV.Z,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?eq(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({icon:eW},e))},eX=r(93306),eH=r(77961),e$=r(36849),eQ=function(e){var n,r=e.selectedPaymentMethod,t=e.onClose,s=(0,z.oR)().ui,a=(0,m.UO)().slug,i=(0,J.G)({orgSlug:a}).data,o=eh({onSuccess:function(){s.setNotification({category:"success",message:"Successfully changed payment method to the card ending with ".concat(r.card.last4)}),t()},onError:function(e){s.setNotification({category:"error",message:"Failed to change payment method: ".concat(e.message)})}}),l=o.mutate,u=o.isLoading,p=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(i){e.next=4;break}return e.abrupt("return",console.error("Subscription is required"));case 4:if(r){e.next=6;break}return e.abrupt("return",console.error("Card ID is required"));case 6:l({slug:a,tier:"pro"===i.plan.id&&i.usage_billing_enabled?"tier_payg":"tier_".concat(i.plan.id),paymentMethod:r.id});case 8:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,M.jsx)(e$.C,{visible:void 0!==r,size:"medium",header:"Confirm to use payment method ending with ".concat(null==r?void 0:r.card.last4),onCancel:function(){return t()},customFooter:(0,M.jsxs)("div",{className:"flex items-center gap-2",children:[(0,M.jsx)(ea.z,{type:"default",disabled:u,onClick:function(){return t()},children:"Cancel"}),(0,M.jsx)(ea.z,{type:"primary",disabled:u,loading:u,onClick:p,children:"Confirm"})]}),children:(0,M.jsx)("div",{className:"py-4",children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==r?void 0:r.card.last4,". There are no immediate charges."]})})})})},eJ=["onSuccess","onError"];function e0(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function e1(){return(e1=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.cardId,e.next=3,(0,y.$v)("".concat(w.T5,"/organizations/").concat(r,"/payments"),{card_id:t});case 3:if(!(s=e.sent).error){e.next=6;break}throw s.error;case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var e2=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,eJ),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return e1.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e0(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e0(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(N.O.paymentMethods(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to delete payment method: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},e4=function(e){var n,r=e.selectedPaymentMethod,t=e.onClose,s=(0,z.oR)().ui,a=(0,m.UO)().slug,i=e2({onSuccess:function(){s.setNotification({category:"success",message:"Successfully removed payment method ending with ".concat(r.card.last4)}),t()}}),o=i.mutate,l=i.isLoading,u=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(r){e.next=4;break}return e.abrupt("return",console.error("Card ID is required"));case 4:o({slug:a,cardId:r.id});case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,M.jsx)(e$.C,{visible:void 0!==r,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==r?void 0:r.card.last4),onCancel:function(){return t()},customFooter:(0,M.jsxs)("div",{className:"flex items-center gap-2",children:[(0,M.jsx)(ea.z,{type:"default",disabled:l,onClick:function(){return t()},children:"Cancel"}),(0,M.jsx)(ea.z,{type:"primary",disabled:l,loading:l,onClick:u,children:"Confirm"})]}),children:(0,M.jsx)("div",{className:"py-4",children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)(er.b,{withIcon:!0,variant:"info",title:"This will permanently delete your payment method.",children:(0,M.jsx)("p",{children:"You can re-add the payment method any time."})})})})})},e3=r(96514),e5=function(){var e,n=(0,z.oR)().ui,r=(0,m.UO)().slug,t=(0,k.NL)(),s=(0,p.useState)(),a=s[0],i=s[1],l=(0,p.useState)(),v=l[0],j=l[1],b=(0,p.useState)(!1),y=b[0],O=b[1],S=(0,J.G)({orgSlug:r}).data,_=eF({slug:r}),C=_.data,P=_.error,Z=_.isLoading,E=_.isError,A=_.isSuccess,D=(0,z.Xo)(u.KA.BILLING_READ,"stripe.payment_methods"),I=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.payment_methods");return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Payment methods"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"After adding a payment method, make sure to mark it as active to use it for billing. You can remove unused cards."})]})}),(0,M.jsx)(o.Lc,{children:D?(0,M.jsxs)(M.Fragment,{children:[Z&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),E&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve payment methods",error:P}),A&&(0,M.jsxs)(M.Fragment,{children:[(null==S?void 0:S.payment_method_type)==="invoice"&&(0,M.jsx)(er.b,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,M.jsx)(ea.z,{asChild:!0,type:"default",children:(0,M.jsx)($(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,M.jsx)(x.by,{footer:(0,M.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[I?(0,M.jsx)("div",{}):(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,M.jsx)(ea.z,{type:"default",icon:(0,M.jsx)(eU.Z,{}),disabled:!I,onClick:function(){return O(!0)},children:"Add new card"})]}),children:(0,M.jsx)(x.hj,{children:(0,M.jsx)(x.B4,{fullWidth:!0,loading:!1,children:(null!==(e=null==C?void 0:C.length)&&void 0!==e?e:0)===0?(0,M.jsxs)("div",{className:"flex items-center space-x-2 opacity-50",children:[(0,M.jsx)(eK,{}),(0,M.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,M.jsx)("div",{className:"space-y-3",children:null==C?void 0:C.map(function(e){var n=(null==S?void 0:S.payment_method_id)===e.id;return(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,M.jsx)("img",{alt:"Credit card brand",src:"".concat(w.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,M.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",e.card.last4]}),(0,M.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",e.card.exp_month,"/",e.card.exp_year]})]}),n&&(0,M.jsx)(eI.Z,{color:"green",children:"Active"}),I&&!n?(0,M.jsxs)(eX.h_,{children:[(0,M.jsx)(eX.$F,{children:(0,M.jsx)(ea.z,{asChild:!0,type:"outline",icon:(0,M.jsx)(eH.Z,{}),className:"hover:border-gray-500 px-1",children:(0,M.jsx)("span",{})})}),(0,M.jsxs)(eX.AW,{align:"end",children:[(null==S?void 0:S.plan.id)!=="free"&&(null==S?void 0:S.payment_method_type)==="card"&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(eX.Xi,{onClick:function(){return i(e)},children:(0,M.jsx)("p",{children:"Use this card"})},"make-default"),(0,M.jsx)(eX.VD,{})]}),(0,M.jsx)(eX.Xi,{onClick:function(){return j(e)},children:(0,M.jsx)("p",{children:"Delete card"})},"delete-method")]})]}):null]},e.id)})})})})})]})]}):(0,M.jsx)(f.Z,{resourceText:"view this organization's payment methods"})})]}),(0,M.jsx)(e3.Z,{visible:y,returnUrl:"".concat((0,eM.Ax)(),"/org/").concat(r,"/billing"),onCancel:function(){return O(!1)},onConfirm:(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O(!1),n.setNotification({category:"success",message:"Successfully added new payment method"}),e.next=4,t.invalidateQueries(N.O.paymentMethods(r));case 4:case"end":return e.stop()}},e)}))}),(0,M.jsx)(eQ,{selectedPaymentMethod:a,onClose:function(){return i(void 0)}}),(0,M.jsx)(e4,{selectedPaymentMethod:v,onClose:function(){return j(void 0)}})]})},e6=r(2741),e8=r(24990),e7=r(88281),e9=r(42984),ne=["enabled"];function nn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function nr(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nn(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nt(){return(nt=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.organizationSlug,t=n.tier,r){e.next=3;break}throw Error("organizationSlug is required");case 3:if(t){e.next=5;break}throw Error("tier is required");case 5:return e.next=7,(0,Y.v_)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:r}},body:{tier:t}});case 7:if(a=(s=e.sent).data,!(i=s.error)){e.next=12;break}throw i;case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ns=function(e){var n=e.organizationSlug,r=e.tier,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.enabled,a=(0,j.Z)(t,ne);return(0,b.a)(N.O.subscriptionPreview(n,r),function(){return function(e){return nt.apply(this,arguments)}({organizationSlug:n,tier:r})},nr(nr({enabled:(void 0===s||s)&&void 0!==n&&void 0!==r},a),{},{retry:function(e,n){return("object"!=typeof n||null===n||!("code"in n)||400!==n.code)&&e<3}}))},na=["enabled"];function ni(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function no(){return(no=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.orgSlug){e.next=3;break}throw Error("orgSlug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/billing/plans"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s.plans);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var nc=function(e){var n=e.orgSlug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,na);return(0,b.a)(el.U.orgPlans(n),function(e){return function(e,n){return no.apply(this,arguments)}({orgSlug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ni(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ni(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},nl=r(3382),nd=r(97346),nu=r(72637);function np(){return(np=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var nm=(0,p.forwardRef)(function(e,n){var r=e.color,t=e.size,s=void 0===t?24:t,a=function(e,n){if(null==e)return{};var r,t,s=function(e,n){if(null==e)return{};var r,t,s={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,["color","size"]);return p.createElement("svg",np({ref:n,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:void 0===r?"currentColor":r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),p.createElement("circle",{cx:"12",cy:"12",r:"10"}),p.createElement("line",{x1:"8",y1:"12",x2:"16",y2:"12"}))});function nh(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}nm.propTypes={color:eB().string,size:eB().oneOfType([eB().string,eB().number])},nm.displayName="MinusCircle";var nx=function(e){return(0,M.jsx)(eV.Z,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nh(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nh(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({icon:nm},e))},nf=r(34287),ng=function(e){var n=e.projectAddon,r=n.addons.find(function(e){return"compute_instance"===e.type}),t=n.addons.map(function(e){return"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name});return(0,M.jsxs)("li",{className:"list-disc ml-6",children:[n.name,": ",t.join(", ")," will be removed.",r?(0,M.jsxs)(M.Fragment,{children:[" ","Project will also ",(0,M.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})},nv=function(e){var n,r=e.visible,t=e.selectedPlan,s=e.subscription,a=e.onClose,i=e.onConfirm;return(0,M.jsx)(e$.C,{size:"large",alignFooter:"right",visible:r,onCancel:a,onConfirm:i,header:"Confirm to downgrade to ".concat(null==t?void 0:t.name," plan"),children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"py-6",children:[(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(er.b,{withIcon:!0,variant:"warning",title:"Downgrading to the free plan will lead to reductions in your organization's quota",children:(0,M.jsx)("p",{children:"If you're already past the limits of the free plan, your projects could become unresponsive or enter read only mode."})}),(null!==(n=null==s?void 0:s.project_addons.length)&&void 0!==n?n:0)>0&&(0,M.jsx)(er.b,{title:"A total of ".concat(null==s?void 0:s.project_addons.length," project(s) will be affected from the downgrade"),variant:"warning",withIcon:!0,children:(0,M.jsx)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:null==s?void 0:s.project_addons.map(function(e){return(0,M.jsx)(ng,{projectAddon:e},e.ref)})})})]}),(0,M.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,M.jsxs)("li",{className:"flex gap-3",children:[(0,M.jsx)("div",{children:(0,M.jsx)(nu.Z,{})}),(0,M.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,M.jsx)("li",{children:(0,M.jsxs)("div",{className:"flex gap-3 mb-2",children:[(0,M.jsx)("div",{children:(0,M.jsx)(nx,{})}),(0,M.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]})}),(0,M.jsxs)("li",{className:"flex gap-3",children:[(0,M.jsx)(nf.Z,{w:14,className:"flex-shrink-0"}),(0,M.jsxs)("div",{children:[(0,M.jsxs)("strong",{children:["Before you downgrade to the ",null==t?void 0:t.name," plan, consider:"]}),(0,M.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,M.jsx)("li",{className:"list-disc ml-4",children:"Your projects no longer require their respective add ons."}),(0,M.jsxs)("li",{className:"list-disc ml-4",children:["Your resource consumption are well within the ",null==t?void 0:t.name," plan's quota."]}),(0,M.jsx)("li",{className:"list-disc ml-4",children:"Alternatively, you may also transfer projects across organizations."})]})]})]})]}),(null==s?void 0:s.billing_via_partner)===!0&&(0,M.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})})},nj=function(e){var n=e.plan,r=e.isCurrentPlan;return(0,M.jsxs)("div",{className:(0,eo.default)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-background","py-4 col-span-12 justify-between gap-x-8"),children:[(0,M.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:(0,eo.default)("text-brand text-sm uppercase"),children:n.name}),r?(0,M.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):n.nameBadge?(0,M.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:n.nameBadge}):null]}),(0,M.jsx)("p",{className:"text-sm mt-2 mb-4",children:n.description}),(0,M.jsx)("a",{href:n.href,className:"hidden md:block",target:"_blank",children:(0,M.jsx)(ea.z,{block:!0,type:"default",size:"tiny",children:n.cta})})]}),(0,M.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,M.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:n.features.map(function(e){return(0,M.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,M.jsx)(nd.Z,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,M.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:e})]},e)})}),(0,M.jsx)("a",{href:n.href,className:"visible md:hidden mt-8",target:"_blank",children:(0,M.jsx)(ea.z,{block:!0,type:"default",size:"tiny",children:n.cta})})]})]},n.id)},nb=r(12741),ny=r(77087),nw=r(76635),nN=r(78466),nO=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","I’m migrating to/starting a new project","None of the above"],nS=function(e){var n,r,t,s=e.visible,a=e.subscription,i=e.onClose,o=(0,z.oR)().ui,l=(0,m.UO)().slug,u=(0,p.useRef)(null),h=(0,p.useState)(""),x=h[0],f=h[1],g=(0,p.useState)(null),v=g[0],j=g[1],b=(0,p.useReducer)(function(e,n){return(0,nw.includes)(e,n.target.value)?(0,nw.without)(e,n.target.value):[].concat((0,nb.Z)(e),[n.target.value])},[]),y=b[0],w=b[1],N=(0,z.P5)("disableProjectCreationAndUpdate"),O=(0,nN.S)(),S=O.mutateAsync,_=O.isLoading,C=eh({onError:function(e){o.setNotification({category:"error",message:"Failed to downgrade project: ".concat(e.message)})}}),k=C.mutateAsync,P=C.isLoading||_,Z=null!==(t=null==a?void 0:a.project_addons.filter(function(e){return e.addons.find(function(e){return"compute_instance"===e.type})}))&&void 0!==t?t:[],E=Z.length>0,A=function(){var e;j(null),null===(e=u.current)||void 0===e||e.resetCaptcha()},D=(n=(0,c.Z)(d().mark(function e(){var n,r,t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==y.length){e.next=2;break}return e.abrupt("return",o.setNotification({category:"error",message:"Please select at least one reason for canceling your subscription"}));case 2:if(v){e.next=10;break}return e.next=6,null===(n=u.current)||void 0===n?void 0:n.execute({async:!0});case 6:return null==(t=e.sent)||t.response,e.next=10,I();case 10:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),I=(r=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:return e.prev=2,e.next=5,k({slug:l,tier:"tier_free"});case 5:A();case 6:return e.prev=6,e.finish(6);case 8:return e.prev=8,e.next=11,S({orgSlug:l,reasons:y.reduce(function(e,n){return"".concat(e,"- ").concat(n,"\n")},""),message:x,exitAction:"downgrade"});case 11:return e.prev=11,e.finish(11);case 13:o.setNotification({category:"success",duration:E?8e3:4e3,message:E?"Your organization has been downgraded and your projects are currently restarting to update their compute instances":"Successfully downgraded organization to the free plan"}),i(!0),window.scrollTo({top:0,left:0,behavior:"smooth"});case 16:case"end":return e.stop()}},e,null,[[2,,6,8],[8,,11,13]])})),function(){return r.apply(this,arguments)});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"self-center",children:(0,M.jsx)(ny.Z,{ref:u,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:function(e){j(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:function(){return j(null)},onOpen:function(){void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:function(){void 0!==document&&document.body.classList.remove("!pointer-events-auto")}})}),(0,M.jsxs)(e$.C,{hideFooter:!0,size:"xlarge",visible:s,onCancel:i,header:"We're sad that you're leaving",children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"py-6 space-y-4",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,M.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,M.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:nO.map(function(e){var n=y.find(function(n){return n===e});return(0,M.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(n?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,M.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:w}),(0,M.jsx)("div",{children:e})]},e)})}),(0,M.jsx)("div",{className:"text-area-text-sm",children:(0,M.jsx)(R.Z.TextArea,{id:"message",name:"message",value:x,onChange:function(e){return f(e.target.value)},label:"Anything else that we can improve on?"})})]}),E&&(0,M.jsxs)(er.b,{withIcon:!0,variant:"warning",title:"".concat(Z.length," of your project").concat(Z.length>1?"s":""," will be restarted upon hitting confirm"),children:["This is due to changes in compute instances from the downgrade. Affected project(s) include ",Z.map(function(e){return e.name}).join(", "),"."]})]})}),(0,M.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[(0,M.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining of your billing cycle will be refunded as credits"}),(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)(ea.z,{type:"default",onClick:function(){return i()},children:"Cancel"}),(0,M.jsx)(ei.Z,{projectUpdateDisabled:N,children:(0,M.jsx)(ea.z,{type:"danger",className:"pointer-events-auto",loading:P,disabled:N||P,onClick:D,children:"Confirm downgrade"})})]})]})]})]})},n_=function(e){var n=e.visible,r=e.onClose,t=(0,z.lL)(),s=null==t?void 0:t.slug,a=(0,e9.u)({slug:s}).data;return(0,M.jsx)(e$.C,{hideFooter:!0,visible:n,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:r,children:(0,M.jsxs)("div",{className:"py-4 space-y-4",children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,M.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(a||[]).map(function(e,n){return(0,M.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(n))})}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("div",{className:"flex items-center gap-2",children:(0,M.jsx)(ea.z,{htmlType:"button",type:"default",onClick:r,block:!0,children:"Understood"})})})]})})},nC=r(29027),nk=r(23733),nP=function(e){var n=e.selectedPaymentMethod,r=e.onSelectPaymentMethod,t=e.layout,s=(0,z.oR)().ui;(0,m.UO)().ref;var a=(0,z.lL)(),i=null==a?void 0:a.slug,o=(0,p.useState)(!1),l=o[0],h=o[1],x=eF({slug:i}),f=x.data,g=x.isLoading,v=x.isSuccess,j=x.refetch,b=(0,p.useMemo)(function(){return null!=f?f:[]},[f]),y=C({slug:i}),N=y.data,O=y.isSuccess,S=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.payment_methods");return(0,p.useEffect)(function(){if(v&&O&&b.length>0){var e=b.some(function(e){return e.id===n});if(!n||!e){var t=b.find(function(e){return e.id===N.invoice_settings.default_payment_method});void 0!==t?r(t.id):r(b[0].id)}}},[v,O,n,N,b,r]),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{children:g?(0,M.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,M.jsx)(nC.Z,{className:"animate-spin",size:14}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):0===b.length?(0,M.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,M.jsx)(nk.Z,{size:16,strokeWidth:1.5}),(0,M.jsx)("p",{className:"text-sm",children:"No saved payment methods"})]}),(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"default",disabled:!S,icon:(0,M.jsx)(eK,{}),onClick:function(){return h(!0)},htmlType:"button",children:"Add new"})}),!S&&(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-48 border border-background text-center",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to add new payment methods to this organization"})})]})})]})]}):(0,M.jsxs)(L.Z,{layout:void 0===t?"vertical":t,label:"Payment method",value:n,onChange:r,className:"flex items-center",children:[b.map(function(e){var n="•••• •••• •••• ".concat(e.card.last4);return(0,M.jsx)(L.Z.Option,{label:n,value:e.id,addOnBefore:function(){return(0,M.jsx)("img",{alt:"Credit Card Brand",src:"".concat(w.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"})},children:(0,M.jsx)("div",{children:n})},e.id)}),(0,M.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:function(){return h(!0)},children:[(0,M.jsx)(eU.Z,{size:16}),(0,M.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,M.jsx)(e3.Z,{visible:l,returnUrl:"".concat((0,eM.Ax)(),"/org/").concat(null==a?void 0:a.slug,"/billing?panel=subscriptionPlan"),onCancel:function(){return h(!1)},onConfirm:(0,c.Z)(d().mark(function e(){var n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(!1),s.setNotification({category:"success",message:"Successfully added new payment method"}),e.next=4,j();case 4:null!=(n=e.sent.data)&&n.length&&r(n.reduce(function(e,n){return e.created>n.created?e:n},n[0]).id);case 7:case"end":return e.stop()}},e)}))})]})};function nZ(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function nE(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nZ(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var nA=function(){var e,n,r=(0,z.oR)().ui,t=(0,ef.useRouter)(),s=(0,z.lL)(),a=null==s?void 0:s.slug,i=(0,p.useState)(!1),o=i[0],l=i[1],m=(0,p.useState)(),x=m[0],f=m[1],v=(0,p.useState)(!1),j=v[0],b=v[1],y=(0,p.useState)(),N=y[0],O=y[1],S=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.subscriptions"),_=(0,ee.Wu)(),C="subscriptionPlan"===_.panelKey,k=function(){return _.setPanelKey(void 0)},P=(0,J.G)({orgSlug:a}).data,Z=nc({orgSlug:a}),E=Z.data,A=Z.isLoading,D=(0,e9.u)({slug:a}).data,I=eh({onSuccess:function(){r.setNotification({category:"success",message:"Successfully updated subscription to ".concat(null==K?void 0:K.name,"!")}),O(void 0),k(),window.scrollTo({top:0,left:0,behavior:"smooth"})},onError:function(e){r.setNotification({error:e,category:"error",message:"Unable to update subscription: ".concat(e.message)})}}),T=I.mutate,R=I.isLoading,L=(null==P?void 0:P.billing_via_partner)===!0,F=(null==P?void 0:P.payment_method_type)==="invoice",U=ns({tier:N,organizationSlug:a}),Y=U.data,B=U.error,G=U.isLoading,W=U.isSuccess,V=null!=E?E:[],q=(D||[]).length>0,K=nl.z.find(function(e){return e.id===N});(0,p.useEffect)(function(){C&&(O(void 0),ex.Z.sendActivity(nE({activity:"Side Panel Viewed",source:"Dashboard",data:{title:"Change Subscription Plan",section:"Subscription plan"}},a&&{orgSlug:a}),t))},[C]);var X=(e=(0,c.Z)(d().mark(function e(){var n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",console.error("org slug is required"));case 2:if(N){e.next=4;break}return e.abrupt("return",console.error("Selected plan is required"));case 4:if(!(!x&&!F)){e.next=6;break}return e.abrupt("return",r.setNotification({category:"error",message:"Please select a payment method"}));case 6:T({slug:a,tier:(null==P?void 0:null===(n=P.plan)||void 0===n?void 0:n.id)==="team"&&N===w.ev.PRO?w.ev.PAYG:N,paymentMethod:x});case 8:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),H=N?V.find(function(e){return e.id===N.split("tier_")[1]}):null;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ev.ZP,{hideFooter:!0,size:"xxlarge",visible:C,onCancel:function(){return k()},header:(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("h4",{children:["Change subscription plan for ",null==s?void 0:s.name]}),(0,M.jsx)(ea.z,{asChild:!0,type:"default",icon:(0,M.jsx)(en.Z,{strokeWidth:1.5}),children:(0,M.jsx)($(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),children:(0,M.jsx)(ev.ZP.Content,{children:(0,M.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:nl.z.map(function(e){var n,r,s,i=V.find(function(n){return n.id===e.id.split("tier_")[1]}),o=nl.z.find(function(n){return n.id===e.id}),c=null!==(n=null==i?void 0:i.price)&&void 0!==n?n:0,l=(null==i?void 0:i.change_type)==="downgrade",d=(null==i?void 0:i.id)===(null==P?void 0:null===(r=P.plan)||void 0===r?void 0:r.id);return"tier_enterprise"===e.id?(0,M.jsx)(nj,{plan:e,isCurrentPlan:d},e.id):(0,M.jsxs)("div",{className:(0,eo.default)("border rounded-md px-4 py-4 flex flex-col items-start justify-between","tier_enterprise"===e.id?"col-span-12":"col-span-12 md:col-span-4","tier_enterprise"===e.id?"bg-background":"bg-surface-200"),children:[(0,M.jsxs)("div",{className:"w-full",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:(0,eo.default)("text-brand text-sm uppercase"),children:e.name}),d?(0,M.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,M.jsx)("div",{className:"text-xs bg-brand-400 text-brand rounded px-2 py-0.5",children:e.nameBadge}):(0,M.jsx)(M.Fragment,{})]}),(0,M.jsxs)("div",{className:"mt-4 flex items-center space-x-1",children:[(null!=c?c:0)>0&&(0,M.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),A?(0,M.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,M.jsx)(g.Z,{className:"w-[30px] h-[24px]"})}):(0,M.jsxs)("p",{className:"text-foreground text-lg",children:["$",c]}),(0,M.jsx)("p",{className:"text-foreground-light text-sm",children:null==o?void 0:o.costUnit})]}),(0,M.jsx)("div",{className:(0,eo.default)("flex mt-1 mb-4",!(null!=o&&o.warning)&&"opacity-0"),children:(0,M.jsx)("div",{className:"bg-background text-brand-600 border shadow-sm rounded-md bg-opacity-30 py-0.5 px-2 text-xs",children:null==o?void 0:o.warning})}),d?(0,M.jsx)(ea.z,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)("div",{children:(0,M.jsxs)(ea.z,{block:!0,disabled:(null==P?void 0:null===(s=P.plan)||void 0===s?void 0:s.id)==="enterprise"||!S,type:l?"default":"primary",onClick:function(){O(e.id),ex.Z.sendActivity(nE({activity:"Popup Viewed",source:"Dashboard",data:{title:l?"Downgrade":"Upgrade to "+e.name,section:"Subscription plan"}},a&&{orgSlug:a}),t)},children:[l?"Downgrade":"Upgrade"," to ",e.name]})})}),S?null:(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"You do not have permission to change the subscription plan."})})]})})]}),(0,M.jsx)("div",{className:"border-t my-6"}),(0,M.jsx)("ul",{role:"list",children:e.features.map(function(e){return(0,M.jsxs)("li",{className:"flex py-2",children:[(0,M.jsx)("div",{className:"w-[12px]",children:(0,M.jsx)(nd.Z,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,M.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:e})]},e)})})]}),e.footer&&(0,M.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,M.jsx)("p",{className:"text-foreground-light text-xs",children:e.footer})})]},e.id)})})})}),(0,M.jsx)(nv,{visible:"tier_free"===N,selectedPlan:K,subscription:P,onClose:function(){return O(void 0)},onConfirm:function(){O(void 0),q?b(!0):l(!0)}}),(0,M.jsxs)(e$.C,{loading:R,alignFooter:"right",size:"large",visible:void 0!==N&&"tier_free"!==N,onCancel:function(){return O(void 0)},onConfirm:X,overlayClassName:"pointer-events-none",header:"Confirm ".concat((null==H?void 0:H.change_type)==="downgrade"?"downgrade":"upgrade"," to ").concat(null==K?void 0:K.name),children:[(0,M.jsxs)(e$.C.Content,{className:"mt-4",children:[B&&(0,M.jsx)(h.Z,{error:B,subject:"Failed to preview subscription."}),G&&(0,M.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),W&&(0,M.jsxs)("div",{children:[(0,M.jsx)(e7.Z,{defaultVisibility:!1,title:(0,M.jsxs)("span",{children:["Estimated monthly price is $",Math.round(Y.breakdown.reduce(function(e,n){return e+n.total_price},0))," ","+ usage"]}),hideCollapse:!1,description:(0,M.jsx)(ec.Z,{borderless:!0,head:[(0,M.jsx)(ec.Z.th,{children:"Item"},"header-item"),(0,M.jsx)(ec.Z.th,{children:"Count"},"header-count"),(0,M.jsx)(ec.Z.th,{children:"Unit Price"},"header-unit-price"),(0,M.jsx)(ec.Z.th,{className:"text-right",children:"Price"},"header-price")],body:(0,M.jsxs)(M.Fragment,{children:[Y.breakdown.map(function(e){var n;return(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:null!==(n=e.description)&&void 0!==n?n:"Unknown"}),(0,M.jsx)(ec.Z.td,{children:e.quantity}),(0,M.jsx)(ec.Z.td,{children:0===e.unit_price?"FREE":"$".concat(e.unit_price)}),(0,M.jsxs)(ec.Z.td,{className:"text-right",children:["$",e.total_price]})]},e.description)}),(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:"Total"}),(0,M.jsx)(ec.Z.td,{}),(0,M.jsx)(ec.Z.td,{}),(0,M.jsxs)(ec.Z.td,{className:" text-right",children:["$",null!==(n=Math.round(Y.breakdown.reduce(function(e,n){return e+n.total_price},0)))&&void 0!==n?n:0]})]})]})})}),void 0!==Y.number_of_projects&&Y.number_of_projects>1&&(0,M.jsxs)("p",{className:"text-sm mt-2",children:["All ",Y.number_of_projects,' projects from your organization "',null==s?void 0:s.name,'" will use the new ',null==H?void 0:H.name," plan."]})]})]}),(0,M.jsx)(e$.C.Content,{children:L?(0,M.jsxs)("div",{className:"py-4 space-y-2",children:[(0,M.jsx)("p",{className:"text-sm",children:"This organization is billed through one of our partners and you will be charged by them directly."}),(null==Y?void 0:Y.billed_via_partner)&&(null==Y?void 0:Y.plan_change_type)==="downgrade"&&(0,M.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,M.jsxs)("div",{className:"py-4 space-y-2",children:[(0,M.jsx)("p",{className:"text-sm",children:"Upon clicking confirm, your monthly invoice will be adjusted and your credit card will be charged immediately. Changing the plan resets your billing cycle and may result in a prorated charge for previous usage."}),(0,M.jsx)("div",{className:"!mt-4",children:(0,M.jsx)(nP,{selectedPaymentMethod:x,onSelectPaymentMethod:f})})]})})]}),(0,M.jsx)(n_,{visible:j,onClose:function(){return b(!1)}}),(0,M.jsx)(nS,{visible:o,subscription:P,onClose:function(e){l(!1),e&&k()}})]})},nD=function(){var e,n,r,t,s,a,i,c,l=(0,m.UO)().slug,d=(0,ee.Wu)(),u=(0,z.P5)("disableProjectCreationAndUpdate"),p=(0,J.G)({orgSlug:l}),x=p.data,f=p.error,v=p.isLoading,j=p.isError,b=p.isSuccess,y=eA(),w=y.mutate,N=y.isLoading,O=null==x?void 0:x.plan,S=null!==(e=null==O?void 0:O.name)&&void 0!==e?e:"Unknown",_=ek().unix(null!==(n=null==x?void 0:x.current_period_start)&&void 0!==n?n:0).utc(),C=ek().unix(null!==(r=null==x?void 0:x.current_period_end)&&void 0!==r?r:0).utc(),k=C.diff(ek()(),"days"),P=C.diff(_,"days"),Z=!u&&!["enterprise"].includes(null!==(t=null==O?void 0:O.id)&&void 0!==t?t:"");return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Subscription Plan"}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,M.jsx)("div",{children:(0,M.jsx)($(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:(0,M.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,M.jsx)("p",{className:"text-sm m-0",children:"Pricing"}),(0,M.jsx)(en.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,M.jsxs)(o.Lc,{children:[v&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),j&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:f}),b&&(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-sm",children:"This organization is currently on the plan:"}),(0,M.jsx)("p",{className:"text-2xl text-brand uppercase",children:null!==(s=null==O?void 0:O.name)&&void 0!==s?s:"Unknown"})]}),(null==x?void 0:x.scheduled_plan_change)&&(null==x?void 0:null===(a=x.scheduled_plan_change)||void 0===a?void 0:a.target_plan)!==x.plan.id&&(0,M.jsxs)(et.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,M.jsx)(es.Z,{className:"h-4 w-4"}),(0,M.jsx)(et.Cd,{children:"Scheduled downgrade"}),(0,M.jsxs)(et.X,{className:"flex flex-col gap-3",children:[(0,M.jsxs)("div",{children:["Your organization will automatically be downgraded from the"," ",(0,M.jsx)("span",{children:x.plan.name})," plan to the"," ",(0,M.jsx)("span",{className:"capitalize",children:null==x?void 0:null===(i=x.scheduled_plan_change)||void 0===i?void 0:i.target_plan})," ","plan on"," ",ek()(null==x?void 0:null===(c=x.scheduled_plan_change)||void 0===c?void 0:c.at).format("MMMM D, YYYY"),". If you would like to stay on the ",(0,M.jsx)("span",{children:x.plan.name})," plan, cancel the scheduled downgrade."]}),(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{type:"default",loading:N,onClick:function(){return w({slug:l})},children:"Cancel downgrade"})})]})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)(ei.Z,{projectUpdateDisabled:u,children:(0,M.jsx)(ea.z,{type:"default",className:"pointer-events-auto",disabled:!Z,onClick:function(){return d.setPanelKey("subscriptionPlan")},children:"Change subscription plan"})}),!Z&&(u?(0,M.jsx)(er.b,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(S),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,M.jsx)(er.b,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(S),actions:[(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{asChild:!0,type:"default",children:(0,M.jsx)($(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(S),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null!=x&&x.usage_billing_enabled)&&(0,M.jsx)(er.b,{withIcon:!0,variant:"info",title:"This organization is limited by the included usage",actions:(null==O?void 0:O.id)==="free"?(0,M.jsx)(ea.z,{type:"default",onClick:function(){return d.setPanelKey("subscriptionPlan")},children:"Upgrade Plan"}):(0,M.jsx)(ea.z,{type:"default",onClick:function(){return d.setPanelKey("costControl")},children:"Adjust Spend Cap"}),children:(0,M.jsxs)("div",{className:"text-sm text-foreground-light mr-2",children:["When this organization exceeds its"," ",(0,M.jsx)($(),{href:"#breakdown",className:"text-sm text-green-900 transition hover:text-green-1000",children:"included usage quotas"}),", its projects may become unresponsive."," ",(null==O?void 0:O.id)==="free"?(0,M.jsx)("p",{className:"pr-4 mt-1",children:"If you wish to exceed the included usage, you should upgrade to a paid plan."}):(0,M.jsx)("p",{className:"pr-4 mt-1",children:"You currently have Spend Cap enabled - when you exceed your plan's limit, you will experience restrictions. To scale seamlessly and pay for over-usage, you can adjust your Cost Control settings."})]})}),(0,M.jsx)(e6.Z,{type:"horizontal",value:P-k,max:P,barClass:"bg-foreground",labelBottom:"Current billing cycle (".concat(_.format("MMM DD")," - ").concat(C.format("MMM DD"),")"),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light pb-1",labelTop:"".concat(k," days remaining")})]})]})]}),(0,M.jsx)(nA,{})]})},nI=["enabled"];function nz(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function nT(){return(nT=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/tax-ids"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var nR=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,nI);return(0,b.a)(N.O.taxIds(n),function(e){return function(e,n){return nT.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nz(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},nL=["onSuccess","onError"];function nF(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function nM(){return(nM=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i,o;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.slug,t=n.existingIds,s=n.newIds,r){e.next=4;break}return console.error("Slug is required"),e.abrupt("return",{});case 4:if(!(t.length>0)){e.next=7;break}return e.next=7,Promise.all(t.map(function(){var e=(0,c.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.$v)("".concat(w.T5,"/organizations/").concat(r,"/tax-ids"),{id:n.id});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()));case 7:return e.next=9,Promise.all(s.map(function(){var e=(0,c.Z)(d().mark(function e(n){var t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.v_)("".concat(w.T5,"/organizations/").concat(r,"/tax-ids"),{type:n.type,value:n.value});case 2:return t=e.sent,e.abrupt("return",{id:n.id,result:t});case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()));case 9:return i=(a=e.sent).filter(function(e){if(e.result.error)return e}),o=a.filter(function(e){return!e.result.error}).map(function(e){return e.result}),e.abrupt("return",{created:o,errors:i});case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var nU=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,nL),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return nM.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nF(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(N.O.taxIds(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update tax IDs: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},nY=r(59227),nB=[{name:"AE TRN",code:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345"},{name:"AT VAT",code:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU"},{name:"AU ABN",code:"au_abn",country:"Australia",placeholder:"12345678912"},{name:"AU ARN",code:"au_arn",country:"Australia",placeholder:"123456789123"},{name:"BE VAT",code:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE"},{name:"BG VAT",code:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG"},{name:"BR CNPJ",code:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10"},{name:"BR CPF",code:"br_cpf",country:"Brazil",placeholder:"123.456.789-87"},{name:"CA BN",code:"ca_bn",country:"Canada",placeholder:"123456789"},{name:"CA GST/HST",code:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002"},{name:"CA PST-BC",code:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678"},{name:"CA PST-MB",code:"ca_pst_mb",country:"Canada",placeholder:"123456-7"},{name:"CA PST-SK",code:"ca_pst_mb",country:"Canada",placeholder:"1234567"},{name:"CA QST",code:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234"},{name:"CH VAT",code:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE"},{name:"CL TIN",code:"cl_tin",country:"Chile",placeholder:"12.345.678-K"},{name:"CY VAT",code:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY"},{name:"CZ VAT",code:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ"},{name:"DE VAT",code:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE"},{name:"DK VAT",code:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK"},{name:"EE VAT",code:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE"},{name:"ES CIF",code:"es_cif",country:"Spain",placeholder:"A12345678"},{name:"ES VAT",code:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES"},{name:"FI VAT",code:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI"},{name:"FR VAT",code:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR"},{name:"GB VAT",code:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB"},{name:"GE VAT",code:"ge_vat",country:"Georgia",placeholder:"123456789"},{name:"EL VAT",code:"eu_vat",country:"Greece",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",code:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678"},{name:"HR VAT",code:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR"},{name:"HU VAT",code:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU"},{name:"ID NPWP",code:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345"},{name:"IE VAT",code:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE"},{name:"IL VAT",code:"il_vat",country:"Israel",placeholder:"000012345"},{name:"IN GST",code:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH"},{name:"IS VAT",code:"is_vat",country:"Iceland",placeholder:"123456"},{name:"IT VAT",code:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT"},{name:"JP CN",code:"jp_cn",country:"Japan",placeholder:"1234567891234"},{name:"JP RN",code:"jp_rn",country:"Japan",placeholder:"12345"},{name:"KR BRN",code:"kr_brn",country:"Korea",placeholder:"123-45-67890"},{name:"LI UID",code:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789"},{name:"LT VAT",code:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT"},{name:"LU VAT",code:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU"},{name:"LV VAT",code:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV"},{name:"MT VAT",code:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT"},{name:"MX RFC",code:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9"},{name:"MY FRP",code:"my_frp",country:"Malaysia",placeholder:"12345678"},{name:"MY ITN",code:"my_itn",country:"Malaysia",placeholder:"C 1234567890"},{name:"MY SST",code:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345"},{name:"NL VAT",code:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL"},{name:"NO VAT",code:"no_vat",country:"Norway",placeholder:"123456789MVA"},{name:"NZ GST",code:"nz_gst",country:"New Zealand",placeholder:"123456789"},{name:"PL VAT",code:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL"},{name:"PT VAT",code:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT"},{name:"RO VAT",code:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO"},{name:"RU INN",code:"ru_inn",country:"Russia",placeholder:"1234567891"},{name:"RU KPP",code:"ru_kpp",country:"Russia",placeholder:"123456789"},{name:"SA VAT",code:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345"},{name:"SE VAT",code:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE"},{name:"SG GST",code:"sg_gst",country:"Singapore",placeholder:"M12345678X"},{name:"SG UEN",code:"sg_uen",country:"Singapore",placeholder:"123456789F"},{name:"SI VAT",code:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI"},{name:"SK VAT",code:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK"},{name:"TH VAT",code:"th_vat",country:"Thailand",placeholder:"1234567891234"},{name:"TW VAT",code:"tw_vat",country:"Taiwan",placeholder:"12345678"},{name:"UA VAT",code:"ua_vat",country:"Ukraine",placeholder:"123456789"},{name:"US EIN",code:"us_ein",country:"United States",placeholder:"12-3456789"},{name:"XI VAT",code:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI"},{name:"ZA VAT",code:"za_vat",country:"South Africa",placeholder:"4123456789"}],nG=function(e){var n=nB.find(function(n){return n.name===e.name}),r=null==n?void 0:n.vatPrefix;return r&&!e.value.startsWith(r)&&(e.value="".concat(r).concat(e.value)),e},nW=function(e,n){var r=e.map(function(e){return{type:e.type,value:e.value,name:e.name}}),t=n.map(function(e){return{type:e.type,value:e.value,name:e.name}});return(0,nw.isEqual)((0,nw.sortBy)(r,"name"),(0,nw.sortBy)(t,"name"))};function nV(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function nq(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?nV(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var nK=function(){var e,n,r=(0,z.oR)().ui,t=(0,m.UO)().slug,s=nR({slug:t}),a=s.data,i=s.error,l=s.isLoading,j=s.isSuccess,b=s.isError,y=nU({onSuccess:function(e){var n,t,s=e.created,a=e.errors;_(null!==(n=null==a?void 0:a.map(function(e){return e.id}))&&void 0!==n?n:[]),P(null!==(t=null==s?void 0:s.map(function(e){var n,r;return{id:e.id,type:e.type,value:e.value,name:"eu_vat"===e.type?"".concat(e.country," VAT"):null!==(n=null===(r=nB.find(function(n){return n.code===e.type}))||void 0===r?void 0:r.name)&&void 0!==n?n:""}}))&&void 0!==t?t:[]),void 0!==a&&a.length>0?a.forEach(function(e){r.setNotification({category:"error",message:e.result.error.message})}):r.setNotification({category:"success",message:"Successfully updated tax IDs"})}}),w=y.mutate,N=y.isLoading,O=(0,p.useState)([]),S=O[0],_=O[1],C=(0,p.useState)([]),k=C[0],P=C[1],Z=null!==(n=null==a?void 0:a.map(function(e){var n,r;return{id:e.id,type:e.type,value:e.value,name:"eu_vat"===e.type?"".concat(e.country," VAT"):null!==(n=null===(r=nB.find(function(n){return n.code===e.type}))||void 0===r?void 0:r.name)&&void 0!==n?n:""}}))&&void 0!==n?n:[],E="tax-id-form",A=!nW(k,Z),D=(0,z.Xo)(u.KA.BILLING_READ,"stripe.tax_ids"),I=(0,z.Xo)(u.KA.BILLING_WRITE,"stripe.tax_ids");(0,p.useEffect)(function(){if(j){if(0===k.length)P(Z);else{var e=k.filter(function(e){return S.includes(e.id)});P(Z.concat(e))}}},[j]);var F=function(e,n,r){P(k.map(function(t){if(t.id===e){if("name"!==n)return nq(nq({},t),{},(0,v.Z)({},n,r));var s,a=nB.find(function(e){return e.name===r});return nq(nq({},t),{},(s={},(0,v.Z)(s,n,r),(0,v.Z)(s,"type",null==a?void 0:a.code),s))}return t}))},U=function(){var e={id:(0,eM.k$)(),type:nB[0].code,value:"",name:nB[0].name};P(k.concat([e]))},Y=function(e){P(k.filter(function(n){return n.id!==e}))},B=function(){P(Z)},G=(e=(0,c.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(void 0!==a){e.next=4;break}return e.abrupt("return",console.error("Tax IDs are required"));case 4:w({slug:t,existingIds:a,newIds:k.map(function(e){return nG(e)})});case 6:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)});return(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Tax ID"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add tax ID(s) to have them appear in your invoices. Old invoices are not affected."}),(0,M.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,M.jsx)(o.Lc,{children:D?(0,M.jsxs)(M.Fragment,{children:[l&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),b&&(0,M.jsx)(h.Z,{error:i,subject:"Failed to retrieve organization tax IDs"}),j&&(0,M.jsx)(T.Z,{validateOnBlur:!0,id:E,initialValues:{},onSubmit:G,children:function(){return(0,M.jsx)(x.by,{footer:(0,M.jsx)("div",{className:"flex py-4 px-8",children:(0,M.jsx)(x.iN,{form:E,isSubmitting:N,hasChanges:A,handleReset:function(){return B()},helper:I?void 0:"You need additional permissions to manage this organization's tax IDs"})}),children:(0,M.jsx)(x.hj,{children:(0,M.jsxs)(x.B4,{fullWidth:!0,loading:!1,children:[k.length>=1?(0,M.jsx)("div",{className:"w-full space-y-2",children:k.map(function(e,n){var r,t=nB.find(function(n){return n.name===e.name});return(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)(L.Z,{value:null==t?void 0:t.name,onChange:function(n){return F(e.id,"name",n)},disabled:!I,className:"w-[200px]",children:nB.sort(function(e,n){return e.country.localeCompare(n.country)}).map(function(e){return(0,M.jsxs)(L.Z.Option,{value:e.name,label:e.name,children:[e.country," - ",e.name]},e.name)})}),(0,M.jsx)(R.Z,{value:e.value,placeholder:null!==(r=null==t?void 0:t.placeholder)&&void 0!==r?r:"",onChange:function(n){return F(e.id,"value",n.target.value)},disabled:!I}),I&&(0,M.jsx)(ea.z,{type:"text",className:"px-1",icon:(0,M.jsx)(nY.Z,{}),onClick:function(){return Y(e.id)}})]},"tax-id-".concat(n))})}):(0,M.jsx)("div",{children:(0,M.jsx)("p",{className:"flex items-center space-x-2 text-sm text-foreground-lighter",children:"No tax IDs"})}),I&&(0,M.jsxs)("div",{className:"flex cursor-pointer items-center space-x-2 opacity-50 transition hover:opacity-100",onClick:function(){return U()},children:[(0,M.jsx)(eU.Z,{size:14}),(0,M.jsx)("p",{className:"text-sm",children:"Add another ID"})]})]})})})}})]}):(0,M.jsx)(f.Z,{resourceText:"view this organization's tax IDs"})})]})},nX=r(90213),nH=r(27148),n$=[{key:nH.tk.DATABASE_SIZE,name:"Database space",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB"},{key:nH.tk.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:nH.tk.MONTHLY_ACTIVE_USERS,name:"Active users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:nH.tk.MONTHLY_ACTIVE_SSO_USERS,name:"Active SSO users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:nH.tk.STORAGE_SIZE,name:"Storage space",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:nH.tk.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage",unitName:"image"},{key:nH.tk.REALTIME_PEAK_CONNECTIONS,name:"Realtime peak connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime",unitName:"connection"},{key:nH.tk.REALTIME_MESSAGE_COUNT,name:"Realtime messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime",unitName:"message"},{key:nH.tk.FUNCTION_INVOCATIONS,name:"Edge Function invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions",unitName:"invocation"},{key:nH.tk.FUNCTION_COUNT,name:"Edge Functions",units:"absolute",anchor:"funcCount",category:"Edge Functions",unitName:"function"}],nQ=[{key:"db_size",name:"Database space",units:"bytes",anchor:"dbSize",metric:"DATABASE_SIZE",category:"Database",unitName:"GB"},{key:"db_egress",name:"Database egress",units:"bytes",anchor:"dbEgress",metric:"DATABASE_EGRESS",category:"Database",unitName:"GB"},{key:"monthly_active_users",name:"Active users",units:"absolute",anchor:"mau",metric:"MONTHLY_ACTIVE_USERS",category:"Authentication",unitName:"MAU"},{key:"monthly_active_sso_users",name:"Active SSO users",units:"absolute",anchor:"mauSso",metric:"MONTHLY_ACTIVE_SSO_USERS",category:"Authentication",unitName:"MAU"},{key:"storage_size",name:"Storage space",units:"bytes",anchor:"storageSize",metric:"STORAGE_SIZE",category:"Storage",unitName:"GB"},{key:"storage_egress",name:"Storage egress",units:"bytes",anchor:"storageEgress",metric:"STORAGE_EGRESS",category:"Storage",unitName:"GB"},{key:"storage_image_render_count",name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",metric:"STORAGE_IMAGES_TRANSFORMED",category:"Storage",unitName:"image"},{key:"realtime_peak_connection",name:"Realtime peak connections",units:"absolute",anchor:"realtimePeakConnections",metric:"REALTIME_PEAK_CONNECTIONS",category:"Realtime",unitName:"connection"},{key:"realtime_message_count",name:"Realtime messages",units:"absolute",anchor:"realtimeMessageCount",metric:"REALTIME_MESSAGE_COUNT",category:"Realtime",unitName:"message"},{key:"func_invocations",name:"Edge Function invocations",units:"absolute",anchor:"funcInvocations",metric:"FUNCTION_INVOCATIONS",category:"Edge Functions",unitName:"invocation"},{key:"func_count",name:"Edge Functions",units:"absolute",anchor:"funcCount",metric:"FUNCTION_COUNT",category:"Edge Functions",unitName:"function"}],nJ=r(49631),n0=r(35981),n1=function(e){var n,r,t,s,a,i,o,c,l,d=e.idx,u=e.slug,p=e.metric,m=e.usage,h=e.subscription,x=(0,ee.Wu)(),f=m.usages.find(function(e){return e.metric===p.key}),g="number"!=typeof f?(null!==(n=null==f?void 0:f.usage)&&void 0!==n?n:0)/(null!==(r=null==f?void 0:f.pricing_free_units)&&void 0!==r?r:0):0,v=null==h?void 0:null===(t=h.usage_fees)||void 0===t?void 0:t.find(function(e){return e.metric===p.key}),j=null==h?void 0:h.usage_billing_enabled,b=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),y=!1==!!(null!=f&&f.unlimited),w=y&&g>=.8,N=y&&g>=1,O="bytes"===p.units?"".concat(null!==(s=null==f?void 0:null===(a=f.usage)||void 0===a?void 0:a.toLocaleString())&&void 0!==s?s:0," GB"):null==f?void 0:null===(i=f.usage)||void 0===i?void 0:i.toLocaleString(),S="bytes"===p.units?"".concat(null!==(o=null==f?void 0:f.pricing_free_units)&&void 0!==o?o:0," GB"):null==f?void 0:null===(c=f.pricing_free_units)||void 0===c?void 0:c.toLocaleString(),_="".concat((100*g).toFixed(2),"%"),C="".concat(O," ").concat(y?"of ".concat(S):"");return(0,M.jsxs)("div",{className:(0,eo.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",d%2==0?"md:border-r md:pr-4":"md:pl-4",d<nQ.length-3&&"border-b"),children:[(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsx)($(),{href:"/org/".concat(u,"/usage#").concat(p.anchor),children:(0,M.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:p.name}),(0,M.jsx)(eb.Z,{strokeWidth:1.5,size:16,className:"transition opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0"})]})}),j&&y&&v&&(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)("div",{className:"flex items-center",children:(0,M.jsx)(nJ.Z,{size:14,strokeWidth:2,className:"hover:text-foreground-light"})})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("div",{className:"text-xs text-foreground",children:"UNIT"===v.pricingStrategy?(0,M.jsxs)("div",{children:[(0,M.jsxs)("p",{children:[b.format(v.pricingOptions.freeUnits)," ",p.unitName," included"]}),(0,M.jsxs)("p",{children:["then $",v.pricingOptions.perUnitPrice," per ",p.unitName]})]}):"PACKAGE"===v.pricingStrategy?(0,M.jsxs)("div",{children:[(0,M.jsxs)("p",{children:[b.format(v.pricingOptions.freeUnits)," included"]}),(0,M.jsxs)("p",{children:["then $",v.pricingOptions.packagePrice," per"," ",b.format(v.pricingOptions.packageSize)]})]}):null})})]})})]}),!j&&g>=.8&&(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:N&&!j?(0,M.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,M.jsx)(n0.Z,{size:14,strokeWidth:2,className:"text-red-900"}),(0,M.jsx)("p",{className:"text-sm text-red-900",children:"Exceeded limit"})]}):w&&!j?(0,M.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,M.jsx)(n0.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,M.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]}):null}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,M.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,M.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]}),null!=f&&f.available_in_plan?(0,M.jsx)(e6.Z,{type:"horizontal",max:f.pricing_free_units||1,value:null!==(l=f.usage)&&void 0!==l?l:0,barClass:!y&&f.usage>0?"bg-foreground-light":N&&!j?"bg-red-900":w&&!j?"bg-amber-900":"bg-foreground-light",bgClass:"bg-overlay-hover",labelBottom:C,labelBottomClass:"!text-foreground-light",labelTop:y?_:void 0,labelTopClass:y?N&&!j?"!text-red-900":w&&!j?"!text-amber-900":"":""}):(0,M.jsxs)("div",{className:"flex items-center justify-between flex-grow",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"Unavailable in your plan"}),(0,M.jsx)(ea.z,{type:"default",onClick:function(){return x.setPanelKey("subscriptionPlan")},children:"Upgrade"})]})]})},n2=r(81333),n4=r(96132),n3=["enabled"];function n5(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function n6(){return(n6=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.orgSlug){e.next=3;break}throw Error("orgSlug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/billing/invoices/upcoming"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var n8=function(e){var n=e.orgSlug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,n3);return(0,b.a)(n4.Y.orgUpcomingPreview(n),function(e){return function(e,n){return n6.apply(this,arguments)}({orgSlug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?n5(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},n7=function(e){var n,r,t=n8({orgSlug:e.slug}),s=t.data,a=t.error,i=t.isLoading,o=t.isError,c=t.isSuccess,l=(0,p.useState)(!1),d=l[0],u=l[1],m=(0,nw.partition)(null!==(n=null==s?void 0:s.lines)&&void 0!==n?n:[],function(e){return e.usage_based}),x=(0,n2.Z)(m,2),f=x[0],v=x[1],j=Number(f.reduce(function(e,n){return e+n.amount},0).toFixed(2));return(0,M.jsxs)(M.Fragment,{children:[i&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),o&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve upcoming invoice",error:a}),c&&(0,M.jsxs)("table",{className:"w-full",children:[(0,M.jsx)("thead",{children:(0,M.jsxs)("tr",{className:"border-b",children:[(0,M.jsx)("th",{className:"py-2 font-normal text-left text-sm text-foreground-light w-1/2",children:"Item"}),(0,M.jsx)("th",{className:"py-2 font-normal text-left text-sm text-foreground-light",children:"Count"}),(0,M.jsx)("th",{className:"py-2 font-normal text-left text-sm text-foreground-light",children:"Unit price"}),(0,M.jsx)("th",{className:"py-2 font-normal text-right text-sm text-foreground-light",children:"Price"})]})}),(0,M.jsx)("tbody",{children:v.map(function(e){var n;return(0,M.jsxs)("tr",{className:"border-b",children:[(0,M.jsx)("td",{className:"py-2 text-sm",children:null!==(n=e.description)&&void 0!==n?n:"Unknown"}),(0,M.jsx)("td",{className:"py-2 text-sm",children:e.quantity}),(0,M.jsx)("td",{className:"py-2 text-sm",children:0===e.unit_price?"FREE":"$".concat(e.unit_price)}),(0,M.jsxs)("td",{className:"py-2 text-sm text-right",children:["$",e.amount]})]},e.description)})}),f.length>0&&(0,M.jsx)(ej.ZP,{asChild:!0,open:d,onOpenChange:u,children:(0,M.jsxs)("tbody",{children:[(0,M.jsx)(ej.ZP.Trigger,{asChild:!0,children:(0,M.jsxs)("tr",{className:"border-b cursor-pointer",style:{WebkitAppearance:"initial"},children:[(0,M.jsxs)("td",{className:"py-2 text-sm flex items-center space-x-2",children:[(0,M.jsx)(ea.z,{type:"text",className:"!px-1",icon:(0,M.jsx)(eb.Z,{className:(0,eo.default)("transition",d&&"rotate-90")})}),(0,M.jsx)("p",{children:"Usage items"})]}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{className:"text-sm text-right",children:d?null:"$".concat(j)})]})}),(0,M.jsx)(ej.ZP.Content,{asChild:!0,children:(0,M.jsx)(M.Fragment,{children:f.map(function(e){var n;return(0,M.jsxs)("tr",{className:"border-b",children:[(0,M.jsx)("td",{className:"py-2 text-sm pl-8",children:e.description}),(0,M.jsx)("td",{className:"py-2 text-sm"}),(0,M.jsx)("td",{className:"py-2 text-sm",children:e.unit_price?"$".concat(e.unit_price):null}),(0,M.jsxs)("td",{className:"py-2 text-sm text-right",children:["$",null!==(n=e.amount)&&void 0!==n?n:0]})]},e.description)})})})]})}),(0,M.jsx)("tbody",{children:(0,M.jsxs)("tr",{children:[(0,M.jsx)("td",{className:"py-2 text-sm",children:"Total"}),(0,M.jsx)("td",{className:"py-2 text-sm"}),(0,M.jsx)("td",{className:"py-2 text-sm"}),(0,M.jsxs)("td",{className:"py-2 text-sm text-right",children:["$",null!==(r=null==s?void 0:s.amount_total)&&void 0!==r?r:0]})]})})]})]})},n9=function(){var e,n,r=(0,ee.Wu)(),t=(0,m.UO)().slug,s=(0,nX.v)({orgSlug:t}),a=s.data,i=s.error,c=s.isLoading,l=s.isError,d=s.isSuccess,u=(0,J.G)({orgSlug:t}),p=u.data,x=u.error,f=u.isLoading,v=u.isError,j=u.isSuccess,b=(0,z.N3)("billing:invoices"),y=null==p?void 0:p.plan,w=null==p?void 0:p.usage_billing_enabled,N=ek().unix(null!==(e=null==p?void 0:p.current_period_start)&&void 0!==e?e:0).utc(),O=ek().unix(null!==(n=null==p?void 0:p.current_period_end)&&void 0!==n?n:0).utc(),S=!w&&!!(null==a?void 0:a.usages.find(function(e){var n;return!e.unlimited&&e.capped&&e.usage>(null!==(n=null==e?void 0:e.pricing_free_units)&&void 0!==n?n:0)}));return(0,M.jsxs)(o.jX,{children:[(0,M.jsx)(o.g$,{children:(0,M.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Billing breakdown"}),(0,M.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Current billing cycle: ",N.format("MMM DD")," -"," ",O.format("MMM DD")]})]})}),(0,M.jsxs)(o.Lc,{children:[f&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),v&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:x}),j&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("p",{className:"text-sm",children:"Included usage summary"}),w?(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, your subscription will be charged for the overages. It may take up to 24 hours for usage stats to update."}):(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, you may experience restrictions, as you are currently not billed for overages. It may take up to 24 hours for usage stats to update."}),S&&(0,M.jsxs)(er.b,{withIcon:!0,variant:"danger",title:"Your organization's usage has exceeded its included quota",actions:[(0,M.jsx)(ea.z,{type:"default",className:"ml-8",onClick:function(){return r.setPanelKey((null==y?void 0:y.id)==="free"?"subscriptionPlan":"costControl")},children:(null==y?void 0:y.id)==="free"?"Upgrade plan":"Change spend cap"},"upgrade-button")],children:["Your projects can become unresponsive or enter read only mode."," ",(null==y?void 0:y.id)==="free"?"Please upgrade to the Pro plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),c&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),l&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve usage data",error:i}),d&&(0,M.jsx)("div",{className:"grid grid-cols-12",children:n$.map(function(e,n){return(0,M.jsx)(n1,{idx:n,slug:t,metric:e,usage:a,subscription:p},e.key)})}),b&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("p",{className:"!mt-10 text-sm",children:"Upcoming cost for next invoice"}),(0,M.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following table shows your upcoming costs. Depending on your usage, the final amount may vary. Next invoice on"," ",(0,M.jsx)("span",{className:"text-foreground-light whitespace-nowrap",children:O.format("MMM DD, YYYY")}),"."]}),(0,M.jsx)(n7,{slug:t})]})]})]})]})},re=function(){var e=(0,z.N3)(["billing:account_data","billing:payment_methods","billing:credits"]),n=e.billingAccountData,r=e.billingPaymentMethods,t=e.billingCredits;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o._S,{id:"subscription",children:(0,M.jsx)(nD,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"cost-control",children:(0,M.jsx)(eD,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"breakdown",children:(0,M.jsx)(n9,{})}),t&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"credits-balance",children:(0,M.jsx)(ez,{})})]}),r&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"payment-methods",children:(0,M.jsx)(e5,{})})]}),n&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"email",children:(0,M.jsx)(K,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"address",children:(0,M.jsx)(U,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"taxId",children:(0,M.jsx)(nK,{})})]})]})},rn=r(46776),rr=r(49257),rt=r(59021),rs=r(45008),ra=r(98953),ri=["onSuccess","onError"];function ro(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function rc(){return(rc=(0,c.Z)(d().mark(function e(n){var r,t,s,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,e.next=3,(0,Y.IV)("/platform/organizations/{slug}",{params:{path:{slug:r}}});case 3:if(s=(t=e.sent).data,!(a=t.error)){e.next=8;break}throw a;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,ri),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return rc.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ro(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ro(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([s.invalidateQueries(N.O.list()),s.invalidateQueries(ra.F.list())]);case 2:return a.next=4,null==n?void 0:n(e,r,t);case 4:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to delete organization: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},rd=function(){var e,n=(0,ef.useRouter)(),r=(0,z.oR)().ui,t=(0,z.lL)(),s=null!=t?t:{},a=s.slug,i=s.name,o=(0,p.useState)(!1),l=o[0],m=o[1],h=(0,p.useState)(""),x=h[0],f=h[1],g=(0,z.Xo)(u.KA.UPDATE,"organizations"),v=rl(),j=v.mutateAsync,b=v.isLoading,y=(e=(0,c.Z)(d().mark(function e(t){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=2;break}return e.abrupt("return",r.setNotification({category:"error",message:"You do not have the required permissions to delete this organization"}));case 2:if(a){e.next=4;break}return e.abrupt("return",console.error("Org slug is required"));case 4:return e.prev=4,e.next=7,j({slug:a});case 7:return e.prev=7,r.setNotification({category:"success",message:"Successfully deleted ".concat(i)}),n.push("/projects"),e.finish(7);case 11:case"end":return e.stop()}},e,null,[[4,,7,11]])})),function(n){return e.apply(this,arguments)});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"mt-2",children:(0,M.jsx)(ea.z,{loading:!a,onClick:function(){return m(!0)},type:"danger",children:"Delete organization"})}),(0,M.jsx)(e$.C,{closable:!0,hideFooter:!0,size:"small",visible:l,onCancel:function(){return m(!1)},header:(0,M.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,M.jsx)("h5",{className:"text-sm text-foreground",children:"Delete organization"}),(0,M.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),children:(0,M.jsx)(T.Z,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:y,validate:function(e){var n={};return e.orgName||(n.orgName="Enter the name of the organization."),e.orgName!==a&&(n.orgName="Value entered does not match the value above."),n},children:function(){return(0,M.jsxs)("div",{className:"space-y-4 py-3",children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,M.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,M.jsx)("span",{className:"text-foreground",children:i})," ","organization and remove all of its projects."]})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)(R.Z,{id:"orgName",label:(0,M.jsxs)("span",{children:["Please type ",(0,M.jsx)("span",{className:"font-bold",children:a})," to confirm"]}),onChange:function(e){return f(e.target.value)},value:x,placeholder:"Enter the string above",className:"w-full"})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)(ea.z,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:b,disabled:b,children:"I understand, delete this organization"})})]})}})})]})},ru=(0,rn.Pi)(function(){return(0,M.jsx)(rs.Z,{title:(0,M.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),children:(0,M.jsx)(rs.Z.Content,{children:(0,M.jsxs)(er.b,{withIcon:!0,variant:"danger",title:(0,M.jsx)("span",{className:"text-red-900",children:"Deleting this organization will also remove its projects"}),children:[(0,M.jsx)("p",{className:"text-red-900",children:"Make sure you have made a backup if you want to keep your data"}),(0,M.jsx)(rd,{})]})})})}),rp=(0,rn.Pi)(function(){var e,n=(0,k.NL)(),r=(0,z.oR)().ui,t=(0,m.UO)().slug,s=(0,p.useState)(!1),a=s[0],i=s[1],l=(0,z.lL)(),h=null!=l?l:{},f=h.name,g=h.opt_in_tags,v="org-general-settings",j=null==g?void 0:g.includes(w.PV.AI_SQL),b=(0,z.N3)("organizations:delete"),y=(0,z.Xo)(u.KA.UPDATE,"organizations"),N=(0,z.Xo)(u.KA.UPDATE,"organizations"),O=V(),S=O.mutate,_=O.isLoading,C=(e=(0,c.Z)(d().mark(function e(s,a){var i,o,c,u;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.resetForm,y){e.next=3;break}return e.abrupt("return",r.setNotification({category:"error",message:"You do not have the required permissions to update this organization"}));case 3:if(t){e.next=5;break}return e.abrupt("return",console.error("Slug is required"));case 5:c=null!==(i=null==l?void 0:l.opt_in_tags)&&void 0!==i?i:[],u=s.isOptedIntoAi&&!c.includes(w.PV.AI_SQL)?c.concat([w.PV.AI_SQL]):!s.isOptedIntoAi&&c.includes(w.PV.AI_SQL)?c.filter(function(e){return e!==w.PV.AI_SQL}):c,S({slug:t,name:s.name,opt_in_tags:u},{onSuccess:function(){o({values:s,initialValues:s}),(0,q.aL)(n),r.setNotification({category:"success",message:"Successfully saved settings"})}});case 8:case"end":return e.stop()}},e)})),function(n,r){return e.apply(this,arguments)});return(0,M.jsxs)(o.gW,{children:[(0,M.jsx)(rt.Z,{organization:l}),(0,M.jsx)(T.Z,{id:v,initialValues:{name:null!=f?f:"",isOptedIntoAi:j},onSubmit:C,children:function(e){var n=e.handleReset,r=e.values,t=e.initialValues,s=e.resetForm,o=JSON.stringify(r)!==JSON.stringify(t);return(0,p.useEffect)(function(){var e={name:null!=f?f:"",isOptedIntoAi:j};s({values:e,initialValues:e})},[null==l?void 0:l.slug]),(0,M.jsx)(x.by,{footer:(0,M.jsx)("div",{className:"flex py-4 px-8",children:(0,M.jsx)(x.iN,{form:v,isSubmitting:_,hasChanges:o,handleReset:n,helper:y?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,M.jsx)(x.hj,{header:(0,M.jsx)(x.S0,{children:"General settings"}),children:(0,M.jsxs)(x.B4,{loading:!1,children:[(0,M.jsx)(R.Z,{id:"name",size:"small",label:"Organization name",disabled:!y}),(0,M.jsx)(R.Z,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==l?void 0:l.slug}),(0,M.jsxs)("div",{className:"mt-4",children:[(0,M.jsx)(rr.Z,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!y,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you"}),(0,M.jsxs)(ej.ZP,{open:a,onOpenChange:i,children:[(0,M.jsx)(ej.ZP.Trigger,{asChild:!0,children:(0,M.jsxs)("div",{className:"flex items-center space-x-2 ml-16 cursor-pointer",children:[(0,M.jsx)(eb.Z,{strokeWidth:2,size:16,className:(0,eo.default)("transition-all",a?"rotate-90":"")}),(0,M.jsx)("p",{className:"text-sm text-foreground-light underline",children:"Important information regarding opting in"})]})}),(0,M.jsx)(ej.ZP.Content,{children:(0,M.jsxs)("div",{className:"space-y-2 py-4 ml-16 text-sm text-foreground-light",children:[(0,M.jsx)("p",{children:"Supabase AI is a chatbot support tool powered by OpenAI. Supabase will share the query you submit and information about the databases you manage through Supabase with OpenAI, L.L.C. and its affiliates in order to provide the Supabase AI tool."}),(0,M.jsx)("p",{children:"OpenAI will only access information about the structure of your databases, such as table names, column and row headings. OpenAI will not access the contents of the database itself."}),(0,M.jsx)("p",{children:"OpenAI uses this information to generate responses to your query, and does not retain or use the information to train its algorithms or otherwise improve its products and services."}),(0,M.jsx)("p",{children:"If you have your own individual account on Supabase, we will use any personal information collected through [Supabase AI] to provide you with the [Supabase AI] tool. If you are in the UK, EEA or Switzerland, the processing of this personal information is necessary for the performance of a contract between you and us."}),(0,M.jsx)("p",{children:"Supabase collects information about the queries you submit through Supabase AI and the responses you receive to assess the performance of the Supabase AI tool and improve our services. If you are in the UK, EEA or Switzerland, the processing is necessary for our legitimate interests, namely informing our product development and improvement."}),(0,M.jsxs)("p",{children:["For more information about how we use personal information, please see our"," ",(0,M.jsx)($(),{href:"https://supabase.com/privacy",target:"_blank",rel:"noreferrer",className:"text-brand border-b border-brand",children:"privacy policy"}),"."]})]})})]})]})]})})})}}),b&&N&&(0,M.jsx)(ru,{})]})}),rm=r(10209),rh=r(83933),rx=r(25825),rf=r(74715),rg=r(87875),rv=r(59485),rj=r(30203),rb=r(46920),ry=r(22517),rw=function(e){var n=e.title;return(0,M.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(w.GW,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover")})},rN=function(){var e,n=(0,z.oR)().ui,r=(0,z.lL)(),t=(0,rg.T)({orgSlug:null==r?void 0:r.slug}).data,s=(0,rv.x5)(),a=(0,rf.A)({onSuccess:function(){n.setNotification({category:"success",message:"Successfully deleted Github connection"})}}).mutate,i=null==t?void 0:t.filter(function(e){return"GitHub"===e.integration.name}),l=(0,p.useCallback)(function(e){s.setGithubConnectionsIntegrationId(e),s.setGithubConnectionsOpen(!0)},[s]),u=(0,p.useCallback)((e=(0,c.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a({connectionId:n.id,integrationId:n.organization_integration_id,orgSlug:null==r?void 0:r.slug});case 1:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)}),[a,null==r?void 0:r.slug]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(function(){return(0,M.jsx)(o._S,{children:(0,M.jsxs)(o.jX,{children:[(0,M.jsxs)(o.g$,{title:"GitHub Connections",children:[(0,M.jsx)(rx.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,M.jsx)(rw,{title:"github"})]}),(0,M.jsxs)(o.Lc,{children:[(0,M.jsx)(rx.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n\nThese connections will be part of a GitHub workflow that is currently in development.\n"}),i&&i.length>0&&i.map(function(e,n){var t="".concat(e.connections.length," project ").concat((0,eM._6)(e.connections.length,"connection")," ");return(0,M.jsxs)("div",{children:[(0,M.jsx)(rm.ML,{title:"GitHub",integration:e}),e.connections.length>0?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(rm.WY,{title:t,markdown:"Repository connections for GitHub"}),(0,M.jsx)("ul",{className:"flex flex-col",children:e.connections.map(function(e){return(0,M.jsx)(rj.z,{connection:e,type:"GitHub",onDeleteConnection:u},e.id)})})]}):(0,M.jsx)(rm.WY,{markdown:"### ".concat(e.connections.length," project ").concat((0,eM._6)(e.connections.length,"connection")," Repository connections for GitHub")}),(0,M.jsx)(rm.FP,{onClick:function(){return l(e.id)},orgSlug:null==r?void 0:r.slug,children:"Add new project connection"})]},e.id)})]})]})})},{}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(rh.Z,{isProjectScoped:!1}),(0,M.jsx)(ry.Z,{}),(0,M.jsx)(rb.Z,{})]})};function rO(){return(rO=(0,c.Z)(d().mark(function e(n,r){var t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.id){e.next=3;break}throw Error("Invoice ID is required");case 3:return e.next=5,(0,Y.U2)("/platform/stripe/invoices/{id}",{params:{path:{id:t}},signal:r});case 5:if(a=(s=e.sent).data,!(i=s.error)){e.next=10;break}throw i;case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}(t=a||(a={})).DRAFT="draft",t.PAID="paid",t.VOID="void",t.UNCOLLECTIBLE="uncollectible",t.OPEN="open";var rS=["enabled"];function r_(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function rC(){return(rC=(0,c.Z)(d().mark(function e(n,r){var t,s,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.customerId,s=n.slug,t){e.next=3;break}throw Error("Customer ID is required");case 3:if(s){e.next=5;break}throw Error("Slug is required");case 5:return e.next=7,(0,Y.YM)("/platform/stripe/invoices",{params:{query:{customer:t,slug:s}},signal:r,parseAs:"text"});case 7:if(!(a=e.sent).error){e.next=10;break}throw a.error;case 10:return e.abrupt("return",Number(a.response.headers.get("X-Total-Count")));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rk=function(e){var n=e.customerId,r=e.slug,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.enabled,a=(0,j.Z)(t,rS);return(0,b.a)(n4.Y.count(n,r),function(e){return function(e,n){return rC.apply(this,arguments)}({customerId:n,slug:r},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?r_(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===s||s)&&void 0!==n&&void 0!==r},a))},rP=["enabled"];function rZ(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function rE(){return(rE=(0,c.Z)(d().mark(function e(n,r){var t,s,a,i,o,c,l,u,p;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.customerId,s=n.slug,i=void 0===(a=n.offset)?0:a,c=void 0===(o=n.limit)?10:o,t){e.next=3;break}throw Error("Customer ID is required");case 3:if(s){e.next=5;break}throw Error("Org slug is required");case 5:return e.next=7,(0,Y.U2)("/platform/stripe/invoices",{params:{query:{offset:i.toString(),limit:c.toString(),customer:t,slug:s}},signal:r});case 7:if(u=(l=e.sent).data,!(p=l.error)){e.next=12;break}throw p;case 12:return e.abrupt("return",u);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rA=function(e){var n=e.customerId,r=e.slug,t=e.offset,s=e.limit,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.enabled,o=(0,j.Z)(a,rP);return(0,b.a)(n4.Y.list(n,r,t),function(e){return function(e,n){return rE.apply(this,arguments)}({customerId:n,slug:r,offset:t,limit:s},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?rZ(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===i||i)&&void 0!==n&&void 0!==r},o))},rD=r(61422),rI=r(28208),rz=r(51803),rT=(i={},(0,v.Z)(i,a.DRAFT,{label:"Upcoming",badgeColor:"yellow"}),(0,v.Z)(i,a.PAID,{label:"Paid",badgeColor:"green"}),(0,v.Z)(i,a.VOID,{label:"Forgiven",badgeColor:"green"}),(0,v.Z)(i,a.UNCOLLECTIBLE,{label:"Outstanding",badgeColor:"red"}),(0,v.Z)(i,a.OPEN,{label:"Outstanding",badgeColor:"red"}),i),rR=function(e){var n=e.status,r=rT[n];return(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)(eI.Z,{size:"small",className:"capitalize",color:(null==r?void 0:r.badgeColor)||"gray",children:(null==r?void 0:r.label)||n})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[[a.OPEN,a.UNCOLLECTIBLE].includes(n)&&(0,M.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the money. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the using the "Pay Now" button.'}),n===a.DRAFT&&(0,M.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),n===a.PAID&&(0,M.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),n===a.VOID&&(0,M.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})})]})},rL=function(){var e,n=(0,z.oR)().ui,r=(0,p.useState)(1),t=r[0],s=r[1],i=(0,z.lL)(),l=null!=i?i:{},m=l.stripe_customer_id,x=l.slug,v=(t-1)*10,j=(0,z.Xo)(u.KA.READ,"invoices"),b=rk({customerId:m,slug:x}),y=b.data,w=b.isError,N=rA({customerId:m,slug:x,offset:v,limit:10}),O=N.data,S=N.error,_=N.isLoading,C=N.isError,k=N.isSuccess,P=O||[];(0,p.useEffect)(function(){s(1)},[x]);var Z=(e=(0,c.Z)(d().mark(function e(r){var t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,n){return rO.apply(this,arguments)}({id:r});case 3:null!=(t=e.sent)&&t.invoice_pdf&&window.open(t.invoice_pdf,"_blank"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.setNotification({category:"info",message:"Failed to fetch the selected invoice: ".concat(e.t0.message)});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(n){return e.apply(this,arguments)});return j?(0,M.jsxs)(o.gW,{children:[_&&(0,M.jsx)(g.A,{}),C&&(0,M.jsx)(h.Z,{error:S,subject:"Failed to retrieve invoices"}),k&&(0,M.jsx)(ec.Z,{head:[(0,M.jsx)(ec.Z.th,{},"header-icon"),(0,M.jsx)(ec.Z.th,{children:"Date"},"header-date"),(0,M.jsx)(ec.Z.th,{children:"Amount due"},"header-amount"),(0,M.jsx)(ec.Z.th,{children:"Invoice number"},"header-invoice"),(0,M.jsx)(ec.Z.th,{className:"flex items-center",children:"Status"},"header-status"),(0,M.jsx)(ec.Z.th,{className:"text-right"},"header-download")],body:0===P.length?(0,M.jsx)(ec.Z.tr,{children:(0,M.jsx)(ec.Z.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,M.jsx)("p",{className:"text-foreground-light",children:_?"Checking for invoices":"No invoices for this organization yet"})})}):(0,M.jsxs)(M.Fragment,{children:[P.map(function(e){return(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)(rD.Z,{size:"xxl"})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{children:new Date(1e3*e.period_end).toLocaleString()})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsxs)("p",{children:["$",e.subtotal/100]})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{children:e.number})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)(rR,{status:e.status})}),(0,M.jsx)(ec.Z.td,{className:"align-right",children:(0,M.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[[a.UNCOLLECTIBLE,a.OPEN].includes(e.status)&&(0,M.jsx)(ea.z,{asChild:!0,children:(0,M.jsx)($(),{href:"https://redirect.revops.supabase.com/pay-invoice/".concat(e.id),target:"_blank",rel:"noreferrer",children:"Pay Now"})}),(0,M.jsx)(ea.z,{type:"outline",icon:(0,M.jsx)(rI.Z,{size:16,strokeWidth:1.5}),onClick:function(){return Z(e.id)}})]})})]},e.id)}),(0,M.jsx)(ec.Z.tr,{children:(0,M.jsx)(ec.Z.td,{colSpan:6,children:(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsx)("p",{className:"text-sm opacity-50",children:w?"Failed to retrieve total number of invoices":"Showing ".concat(v+1," to ").concat(v+P.length," out of ").concat(y," invoices")}),(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)(ea.z,{icon:(0,M.jsx)(rz.Z,{}),type:"default",size:"tiny",disabled:1===t,onClick:(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s(t-1));case 1:case"end":return e.stop()}},e)}))}),(0,M.jsx)(ea.z,{icon:(0,M.jsx)(eb.Z,{}),type:"default",size:"tiny",disabled:10*t>=(null!=y?y:0),onClick:(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s(t+1));case 1:case"end":return e.stop()}},e)}))})]})]})})},"navigation")]})})]}):(0,M.jsx)(f.Z,{resourceText:"view invoices"})},rF=r(66432),rM=r(81253),rU=r(98168),rY=function(e){var n=e.visible,r=e.onHide;return(0,M.jsx)(e$.C,{hideFooter:!0,visible:n,size:"xlarge",header:"Spend cap",onCancel:function(){return r()},children:(0,M.jsxs)("div",{className:"py-4 space-y-4",children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)("p",{className:"text-sm",children:"Enabling the spend cap sets a limit on your usage to stay within your plan's quota, which controls costs but can limit service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,M.jsx)("p",{className:"text-sm",children:"Take a look at the following table to see which resources are chargeable and how they are charged:"}),(0,M.jsxs)("div",{className:"border rounded border-control bg-overlay-hover",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm text-foreground-light",children:"Item"}),(0,M.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Limit"}),(0,M.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Rate"})]}),(0,M.jsxs)("div",{className:"py-2",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Database size"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"8GB"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$0.125 per GB"})]}),(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Egress"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"250GB"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$0.09 per GB"})]})]}),(0,M.jsxs)("div",{className:"py-2",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-sm",children:"Auth MAUs"}),(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)(rM.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,M.jsx)(e8.h_,{children:(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"100,000"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$0.00325 per user"})]}),(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-sm",children:"Single Sign-On (SAML 2.0) MAUs"}),(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)(rM.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,M.jsx)(e8.h_,{children:(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"Single Sign-On Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"50"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$0.015 per user"})]})]}),(0,M.jsxs)("div",{className:"py-2",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Storage size"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"100GB"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$0.021 per GB"})]}),(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Storage Image Transformations"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"100 origin images"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$5 per 1000 origin images"})]})]}),(0,M.jsxs)("div",{className:"py-2",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime concurrent peak connections"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"500"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$10 per 1000"})]}),(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime messages"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"5 Million"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$2.50 per Million"})]})]}),(0,M.jsxs)("div",{className:"py-2",children:[(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Function invocations"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"2 Million"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$2 per Million"})]}),(0,M.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,M.jsx)("p",{className:"w-[50%] text-sm",children:"Function count"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"100 functions"}),(0,M.jsx)("p",{className:"w-[25%] text-sm",children:"$10 per 100 functions"})]})]})]}),(0,M.jsxs)("p",{className:"text-sm",children:["See"," ",(0,M.jsx)($(),{href:"https://supabase.com/pricing",className:"text-brand",target:"_blank",rel:"noreferrer",children:(0,M.jsx)("span",{children:"pricing page"})})," ","for a full overview."]})]})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("div",{className:"flex items-center gap-2",children:(0,M.jsx)(ea.z,{block:!0,type:"primary",onClick:function(){return r()},children:"Understood"})})})]})})},rB=r(10118);function rG(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function rW(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?rG(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var rV={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},rq={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"},rK=function(e){var n,r,t=e.onPaymentMethodReset,s=(0,k.NL)(),a=(0,z.oR)().ui,i=(0,ef.useRouter)(),o=(0,rF.useStripe)(),l=(0,rF.useElements)(),u=(0,m.UO)().plan,h=(0,p.useState)(""),x=h[0],f=h[1],g=(0,p.useState)("PERSONAL"),v=g[0],j=g[1],b=(0,p.useState)("1"),y=b[0],N=b[1],O=(0,p.useState)(!1),S=O[0],_=O[1],C=(0,p.useState)(),P=C[0],Z=C[1],E=(0,p.useState)(u&&["free","team","pro"].includes(u)?u.toUpperCase():"FREE"),A=E[0],D=E[1],I=(0,p.useState)(!1),T=I[0],F=I[1],U=(0,p.useState)(!0),Y=U[0],B=U[1],G=(0,rB.T)({onSuccess:(n=(0,c.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,q.aL)(s);case 2:i.push("/new/".concat(n.slug));case 3:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})}).mutateAsync;function W(e){return V.apply(this,arguments)}function V(){return(V=(0,c.Z)(d().mark(function e(n){var r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="PRO"!==A||Y?A:"PAYG",e.prev=1,e.next=4,G(rW(rW({name:x,kind:v,tier:"tier_"+r.toLowerCase()},"COMPANY"==v?{size:y}:{}),{},{payment_method:n}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),_(!1);case 9:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}var K=(r=(0,c.Z)(d().mark(function e(n){var r,t,s,i,c;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),(x?x.trim():"").length>=1){e.next=4;break}return e.abrupt("return",a.setNotification({category:"error",message:"Organization name is empty"}));case 4:if(!(!o||!l)){e.next=6;break}return e.abrupt("return",console.error("Stripe.js has not loaded"));case 6:if(_(!0),"FREE"!==A){e.next=12;break}return e.next=10,W();case 10:case 26:e.next=30;break;case 12:if(P){e.next=28;break}return e.next=15,o.confirmSetup({elements:l,redirect:"if_required",confirmParams:{return_url:"".concat((0,eM.Ax)(),"/new"),expand:["payment_method"]}});case 15:if(t=(r=e.sent).error,s=r.setupIntent,!(t||!s.payment_method)){e.next=22;break}return a.setNotification({category:"error",message:null!==(i=null==t?void 0:t.message)&&void 0!==i?i:" Failed to save card details"}),_(!1),e.abrupt("return");case 22:return Z(c=s.payment_method),e.next=26,W(c.id);case 28:return e.next=30,W(P.id);case 30:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)});return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("form",{onSubmit:K,children:(0,M.jsxs)(rs.Z,{hideHeaderStyling:!0,title:(0,M.jsx)("div",{children:(0,M.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,M.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,M.jsx)(ea.z,{type:"default",onClick:function(){return i.push("/projects")},children:"Cancel"}),(0,M.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,M.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,M.jsx)(ea.z,{htmlType:"submit",type:"primary",loading:S,disabled:S,children:"Create organization"})]})]},"panel-footer"),children:[(0,M.jsxs)(rs.Z.Content,{className:"pt-0",children:[(0,M.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,M.jsx)(rs.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,M.jsx)(R.Z,{autoFocus:!0,label:"Name",type:"text",layout:"horizontal",placeholder:"Organization name",descriptionText:"What's the name of your company or team?",value:x,onChange:function(e){f(e.target.value)}})}),(0,M.jsx)(rs.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,M.jsx)(L.Z,{label:"Type of organization",layout:"horizontal",value:v,onChange:function(e){j(e)},descriptionText:"What would best describe your organization?",children:Object.entries(rV).map(function(e){var n=(0,n2.Z)(e,2),r=n[0],t=n[1];return(0,M.jsx)(L.Z.Option,{label:t,value:r,children:t},r)})})}),"COMPANY"==v?(0,M.jsx)(rs.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,M.jsx)(L.Z,{label:"Company size",layout:"horizontal",value:y,onChange:function(e){N(e)},descriptionText:"How many people are in your company?",children:Object.entries(rq).map(function(e){var n=(0,n2.Z)(e,2),r=n[0],t=n[1];return(0,M.jsx)(L.Z.Option,{label:t,value:r,children:t},r)})})}):(0,M.jsx)(M.Fragment,{}),(0,M.jsx)(rs.Z.Content,{children:(0,M.jsx)(L.Z,{label:"Pricing Plan",layout:"horizontal",value:A,onChange:function(e){D(e)},descriptionText:(0,M.jsxs)(M.Fragment,{children:["Select a plan that suits your needs.\xa0",(0,M.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:"https://supabase.com/pricing",children:"More details"})]}),children:Object.entries(w.f6).map(function(e){var n=(0,n2.Z)(e,2),r=n[0],t=n[1];return(0,M.jsx)(L.Z.Option,{label:t,value:r,children:t},r)})})}),"PRO"===A&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(rs.Z.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,M.jsx)(rr.Z,{id:"spend-cap",layout:"horizontal",label:(0,M.jsxs)("div",{className:"flex space-x-4",children:[(0,M.jsx)("span",{children:"Spend Cap"}),(0,M.jsx)(rM.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:function(){return F(!0)}})]}),checked:Y,onChange:function(){return B(!Y)},descriptionText:(0,M.jsx)("div",{children:(0,M.jsx)("p",{children:"By default, Pro plan organizations have a spend cap to control costs. When enabled, usage is limited to the plan's quota, with restrictions when limits are exceeded. To scale beyond Pro limits without restrictions, disable the spend cap and pay for over-usage beyond the quota."})})})}),(0,M.jsx)(rY,{visible:T,onHide:function(){return F(!1)}})]}),"FREE"!==A&&(0,M.jsx)(rs.Z.Content,{children:(null==P?void 0:P.card)!==void 0?(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,M.jsx)("img",{alt:"Card",src:"".concat(w.GW,"/img/payment-methods/").concat(P.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,M.jsx)(R.Z,{readOnly:!0,className:"w-64",size:"small",value:"•••• •••• •••• ".concat(P.card.last4)}),(0,M.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",P.card.exp_month,"/",P.card.exp_year]})]}),(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{type:"outline",icon:(0,M.jsx)(rU.Z,{}),onClick:function(){return Z(void 0),t()},disabled:S,className:"hover:border-gray-500"})})]},P.id):(0,M.jsx)(rF.PaymentElement,{})}),(0,M.jsx)(rs.Z.Content,{children:(0,M.jsx)(e7.Z,{icon:(0,M.jsx)(nJ.Z,{size:"large",strokeWidth:1.5}),defaultVisibility:!0,hideCollapse:!0,title:"Billed via organization",description:(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsxs)("p",{className:"text-sm leading-normal",children:["This organization will use the new organization-based billing, which gives you a single subscription for your entire organization, instead of having individual subscriptions per project."," "]}),(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{asChild:!0,type:"default",icon:(0,M.jsx)(en.Z,{strokeWidth:1.5}),children:(0,M.jsx)($(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]})})})]})})})},rX=r(67702),rH=r(29298),r$=function(e){var n=e.title,r=e.description;return(0,M.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14",children:(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-xl",children:n}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:r})]})})},rQ=r(46791),rJ=r(75095),r0=function(e){var n=e.section,r=e.includedInPlan,t=e.children,s=n.name,a=n.description,i=n.links;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o._S,{children:(0,M.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-16",children:(0,M.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,M.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,M.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,M.jsxs)("div",{className:"space-y-1",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-base capitalize",children:s}),!1===r&&(0,M.jsx)(eI.Z,{color:"gray",children:"Not included"})]}),(0,M.jsx)("div",{className:"grid gap-4",children:a.split("\n").map(function(e,n){return(0,M.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(n))})})]}),i&&i.length&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),i.map(function(e){return(0,M.jsx)("div",{children:(0,M.jsx)($(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,M.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,M.jsx)("p",{className:"text-sm",children:e.name}),(0,M.jsx)(en.Z,{size:16,strokeWidth:1.5})]})})},e.url)})]})]})}),(0,M.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:t})]})})}),(0,M.jsx)(o.I7,{})]})},r1=function(e,n){var r;return n?(null==n?void 0:null===(r=n.plan)||void 0===r?void 0:r.id)==="pro"&&(null==n?void 0:n.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan"):"/org/".concat(e,"/billing")},r2=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),r4=function(e,n){if("string"==typeof e)return e;if("bytes"!==n)return r2.format(e);var r=r6(e).replace(/\s/g,"");return"0bytes"===r?"0":r},r3=function(e,n){if("string"==typeof e)return e;if("bytes"!==n)return r2.format(e);var r=r8(e).replace(/\s/g,"");return"0bytes"===r?"0":r},r5=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],r6=function(e){if(0===e||void 0===e)return"0 bytes";var n=Math.floor(Math.log(e)/Math.log(1024)),r=r5[n],t=2;return["bytes","KB","MB"].includes(r)?t=0:["GB"].includes(r)&&(t=1),parseFloat((e/Math.pow(1024,n)).toFixed(t))+" "+r},r8=function(e){if(0===e||void 0===e)return"0 bytes";var n=Math.floor(Math.log(e)/Math.log(1024)),r=r5[n];return parseFloat((e/Math.pow(1024,n)).toFixed(3))+" "+r},r7=r(56875),r9=function(e){var n,r,t,s,a,i,o,c,l,d,u,m,x,f,v=e.slug,j=e.projectRef,b=e.attribute,y=e.usage,N=e.usageMeta,O=e.chartMeta,S=e.subscription,_=e.error,C=e.isLoading,k=e.isError,P=e.isSuccess,Z=e.currentBillingCycleSelected,E=r1(null!=v?v:"",S),A=(null!==(n=null==N?void 0:N.usage)&&void 0!==n?n:0)/(null!==(r=null==N?void 0:N.pricing_free_units)&&void 0!==r?r:0),D=(null!==(t=null==N?void 0:N.usage)&&void 0!==t?t:0)-(null!==(s=null==N?void 0:N.pricing_free_units)&&void 0!==s?s:0),I=null==S?void 0:S.usage_billing_enabled,z=I?"text-amber-900":"text-red-900",T=(0,p.useMemo)(function(){var e,n;return null!==(e=null===(n=O[b.key])||void 0===n?void 0:n.data)&&void 0!==e?e:[]},[b.key,O]),R=void 0===j&&Z&&!1===I&&A>=w.wc,L=(0,p.useMemo)(function(){var e,n;return null!==(e=null===(n=b.attributes)||void 0===n?void 0:n.map(function(e){return T.some(function(n){return 0!==Number(n[e.key])})}).some(function(e){return!!e}))&&void 0!==e&&e},[b.attributes,T]);return(0,M.jsx)("div",{id:b.anchor,children:(0,M.jsxs)(r0,{section:b,children:[C&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),k&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve usage data",error:_}),P&&(0,M.jsx)(M.Fragment,{children:null!=N&&N.available_in_plan?(0,M.jsxs)(M.Fragment,{children:[!j&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,M.jsxs)("p",{className:"text-sm",children:[b.name," usage"]}),R&&(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:A>=1?(0,M.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,M.jsx)(n0.Z,{size:14,strokeWidth:2,className:z}),(0,M.jsx)("p",{className:"text-sm ".concat(z),children:"Exceeded limit"})]}):A>=w.wc&&(0,M.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,M.jsx)(n0.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,M.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,M.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,M.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]}),R&&(0,M.jsx)(ea.z,{type:"default",size:"tiny",asChild:!0,children:(0,M.jsx)($(),{href:E,className:"pb-1",children:(null==S?void 0:null===(a=S.plan)||void 0===a?void 0:a.id)==="free"?"Upgrade plan":"Change spend cap"})})]}),Z&&!N.unlimited&&(0,M.jsx)(e6.Z,{type:"horizontal",barClass:(0,eo.default)(A>=1?I?"bg-foreground-light":"bg-red-900":!1===I&&A>=w.wc?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!==(i=null==N?void 0:N.usage)&&void 0!==i?i:0,max:(null==N?void 0:N.pricing_free_units)||1}),(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,M.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==S?void 0:null===(o=S.plan)||void 0===o?void 0:o.name.toLowerCase()," plan"]}),N.unlimited?(0,M.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,M.jsx)("p",{className:"text-xs",children:"bytes"===b.unit?"".concat(null!==(c=N.pricing_free_units)&&void 0!==c?c:0," GB"):(null!==(l=N.pricing_free_units)&&void 0!==l?l:0).toLocaleString()})]}),Z&&(0,M.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,M.jsxs)("p",{className:"text-xs text-foreground-light",children:[b.chartPrefix||"Used "," in period"]}),(0,M.jsx)("p",{className:"text-xs",children:"bytes"===b.unit?"".concat((null!==(d=null==N?void 0:N.usage)&&void 0!==d?d:0).toFixed(2)," GB"):(null!==(u=null==N?void 0:N.usage)&&void 0!==u?u:0).toLocaleString()})]}),Z&&(null!==(m=null==N?void 0:N.pricing_free_units)&&void 0!==m?m:0)>0&&(0,M.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,M.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,M.jsx)("p",{className:"text-xs",children:(null!==(x=null==N?void 0:N.pricing_free_units)&&void 0!==x?x:0)===-1||D<0?"0".concat("bytes"===b.unit?" GB":""):"bytes"===b.unit?"".concat(D.toFixed(2)," GB"):D.toLocaleString()})]})]})]}),null===(f=b.additionalInfo)||void 0===f?void 0:f.call(b,S,y),(0,M.jsxs)("div",{className:"space-y-1",children:[(0,M.jsxs)("p",{className:"text-sm",children:[b.chartPrefix||""," ",b.name," ",b.chartSuffix||"per day"]}),b.chartDescription.split("\n").map(function(e,n){return(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(n))})]}),O[b.key].isLoading?(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}):T.length>0&&L?(0,M.jsx)(r7.Z,{name:"".concat(b.chartPrefix||"").concat(b.name),unit:b.unit,attributes:b.attributes,data:T,yLeftMargin:O[b.key].margin,yFormatter:function(e){return r4(e,b.unit)},tooltipFormatter:function(e){return r3(e,b.unit)}}):(0,M.jsx)(rs.Z,{children:(0,M.jsx)(rs.Z.Content,{children:(0,M.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,M.jsx)(rJ.Z,{className:"text-foreground-light mb-2"}),(0,M.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,M.jsx)(rs.Z,{children:(0,M.jsx)(rs.Z.Content,{children:(0,M.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,M.jsxs)("div",{className:"space-y-1",children:[(0,M.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,M.jsx)("div",{children:(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,M.jsx)(ea.z,{type:"primary",asChild:!0,children:(0,M.jsx)($(),{href:E,children:"Upgrade plan"})})]})})})})]})})},te=function(e){var n=e.orgSlug,r=e.projectRef,t=e.categoryKey,s=e.chartMeta,a=e.subscription,i=e.currentBillingCycleSelected,c=(0,nX.v)({orgSlug:n}),l=c.data,d=c.error,u=c.isLoading,p=c.isError,m=c.isSuccess,h=rQ.ty.find(function(e){return e.key===t});return h?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o._S,{children:(0,M.jsx)(r$,{title:h.name,description:h.description})}),(0,M.jsx)(o.I7,{}),h.attributes.map(function(e){return(0,M.jsx)(r9,{slug:n,projectRef:r,attribute:e,usage:l,usageMeta:null==l?void 0:l.usages.find(function(n){return n.metric===e.key}),chartMeta:s,subscription:a,error:d,isLoading:u,isError:p,isSuccess:m,currentBillingCycleSelected:i},e.name)})]}):null},tn=function(e){var n,r,t,s,a,i,o,c=e.orgSlug,l=e.projectRef,d=e.subscription,u=e.startDate,p=e.endDate,m=e.currentBillingCycleSelected,h=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:p}),x=h.data,f=h.isLoading,g=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:p}),j=g.data,b=g.isLoading,y=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:p}),w=y.data,N=y.isLoading,O=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:p}),S=O.data,_=O.isLoading,C=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:p}),k=C.data,P=C.isLoading,Z=(0,nH.L6)({orgSlug:c,projectRef:l,metric:nH.tk.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:p}),E=Z.data,A=Z.isLoading,D=(o={},(0,v.Z)(o,nH.tk.MONTHLY_ACTIVE_USERS,{data:null!==(n=null==x?void 0:x.data)&&void 0!==n?n:[],margin:18,isLoading:f}),(0,v.Z)(o,nH.tk.MONTHLY_ACTIVE_SSO_USERS,{data:null!==(r=null==j?void 0:j.data)&&void 0!==r?r:[],margin:20,isLoading:b}),(0,v.Z)(o,nH.tk.STORAGE_IMAGES_TRANSFORMED,{data:null!==(t=null==w?void 0:w.data)&&void 0!==t?t:[],margin:0,isLoading:N}),(0,v.Z)(o,nH.tk.FUNCTION_INVOCATIONS,{data:null!==(s=null==S?void 0:S.data)&&void 0!==s?s:[],margin:26,isLoading:_}),(0,v.Z)(o,nH.tk.REALTIME_MESSAGE_COUNT,{data:null!==(a=null==k?void 0:k.data)&&void 0!==a?a:[],margin:38,isLoading:P}),(0,v.Z)(o,nH.tk.REALTIME_PEAK_CONNECTIONS,{data:null!==(i=null==E?void 0:E.data)&&void 0!==i?i:[],margin:0,isLoading:A}),o);return(0,M.jsx)(te,{orgSlug:c,projectRef:l,categoryKey:"activity",chartMeta:D,subscription:d,currentBillingCycleSelected:m})},tr=function(e){var n,r=e.orgSlug,t=e.projectRef,s=e.subscription,a=e.startDate,i=e.endDate,o=e.currentBillingCycleSelected,c=(0,nH.L6)({orgSlug:r,projectRef:t,metric:nH.tk.EGRESS,interval:"1d",startDate:a,endDate:i}),l=c.data,d=c.isLoading,u=(0,v.Z)({},nH.tk.EGRESS,{data:null!==(n=null==l?void 0:l.data)&&void 0!==n?n:[],margin:16,isLoading:d});return(0,M.jsx)(te,{orgSlug:r,projectRef:t,categoryKey:"bandwidth",chartMeta:u,subscription:s,currentBillingCycleSelected:o})},tt=function(e){var n,r,t,s,a=e.orgSlug,i=e.projectRef,o=e.startDate,c=e.endDate,l=e.subscription,d=e.currentBillingCycleSelected,u=(0,nH.L6)({orgSlug:a,projectRef:i,metric:nH.tk.DATABASE_SIZE,interval:"1d",startDate:o,endDate:c}),p=u.data,m=u.isLoading,h=(0,nH.L6)({orgSlug:a,projectRef:i,metric:nH.tk.STORAGE_SIZE,interval:"1d",startDate:o,endDate:c}),x=h.data,f=h.isLoading,g=(0,nH.L6)({orgSlug:a,projectRef:i,metric:nH.tk.FUNCTION_COUNT,interval:"1d",startDate:o,endDate:c}),j=g.data,b=g.isLoading,y=(s={},(0,v.Z)(s,nH.tk.DATABASE_SIZE,{isLoading:m,margin:14,data:null!==(n=null==p?void 0:p.data)&&void 0!==n?n:[]}),(0,v.Z)(s,nH.tk.STORAGE_SIZE,{isLoading:f,margin:14,data:null!==(r=null==x?void 0:x.data)&&void 0!==r?r:[]}),(0,v.Z)(s,nH.tk.FUNCTION_COUNT,{isLoading:b,margin:0,data:null!==(t=null==j?void 0:j.data)&&void 0!==t?t:[]}),s);return(0,M.jsx)(te,{orgSlug:a,projectRef:i,categoryKey:"sizeCount",chartMeta:y,subscription:l,currentBillingCycleSelected:d})},ts=function(){var e,n,r=(0,m.UO)(),t=r.slug,s=r.projectRef,a=(0,p.useState)(),i=a[0],c=a[1],l=(0,p.useState)(),d=l[0],u=l[1],x=(0,z.lL)(),f=(0,rH.Sy)(),v=f.data,j=f.isSuccess,b=(0,J.G)({orgSlug:t}),y=b.data,N=b.error,O=b.isLoading,S=b.isError,_=b.isSuccess,C=(0,nX.v)({orgSlug:t}).data,k=null==v?void 0:v.filter(function(e){return e.organization_id===(null==x?void 0:x.id)});(0,p.useEffect)(function(){s&&j&&void 0!==k&&k.find(function(e){return e.ref===s})&&u(s)},[s,j]);var P=ek().unix(null!==(e=null==y?void 0:y.current_period_start)&&void 0!==e?e:0).utc(),Z=ek().unix(null!==(n=null==y?void 0:y.current_period_end)&&void 0!==n?n:0).utc(),E=(0,p.useMemo)(function(){if(!(null!=i&&i.period_start)||!(null!=i&&i.period_end)||!y)return!0;var e=y.current_period_start,n=y.current_period_end;return ek()(i.period_start.date).isSame(new Date(1e3*e))&&ek()(i.period_end.date).isSame(new Date(1e3*n))},[i,y]),A=(0,p.useMemo)(function(){var e,n;if(null!=i&&null!==(e=i.period_start)&&void 0!==e&&e.date)return new Date(null==i?void 0:null===(n=i.period_start)||void 0===n?void 0:n.date).toISOString().slice(0,-5)+"Z"},[i,y]),D=(0,p.useMemo)(function(){var e,n;return null!=i&&null!==(e=i.period_end)&&void 0!==e&&e.date&&ek()(i.period_end.date).isAfter(ek()())?ek()().endOf("day").toISOString().slice(0,-5)+"Z":null!=i&&null!==(n=i.period_end)&&void 0!==n&&n.date?new Date(i.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[i,y]),I=d?null==k?void 0:k.find(function(e){return e.ref===d}):void 0,T=!!(null==C?void 0:C.usages.find(function(e){var n;return!e.unlimited&&e.capped&&e.usage>(null!==(n=null==e?void 0:e.pricing_free_units)&&void 0!==n?n:0)}));return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o._S,{className:"sticky top-0 border-b bg-background z-10 overflow-hidden",children:(0,M.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[O&&(0,M.jsx)(g.Z,{className:"w-[250px]"}),S&&(0,M.jsx)(h.Z,{className:"w-full",subject:"Failed to retrieve usage data",error:N}),_&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(rX.Z,{onChange:c,value:w.eB[0].key,options:[].concat((0,nb.Z)(w.eB),(0,nb.Z)(w._T)),loading:O,currentBillingPeriodStart:null==y?void 0:y.current_period_start,currentBillingPeriodEnd:null==y?void 0:y.current_period_end}),(0,M.jsxs)(L.Z,{size:"tiny",name:"schema",className:"w-[180px]",value:d,onChange:function(e){"all-projects"===e?u(void 0):u(e)},children:[(0,M.jsx)(L.Z.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==k?void 0:k.map(function(e){return(0,M.jsx)(L.Z.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref)})]}),(0,M.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,M.jsxs)("p",{className:(0,eo.default)("text-sm transition",O&&"opacity-50"),children:["Organization is on the ",y.plan.name," plan"]}),(0,M.jsxs)("p",{className:"text-sm text-foreground-light",children:[P.format("DD MMM YYYY")," -"," ",Z.format("DD MMM YYYY")]})]})]})]})}),!I&&y&&T&&(0,M.jsx)(o._S,{className:"mt-5",children:(0,M.jsxs)(er.b,{withIcon:!0,variant:"danger",title:"Your organization's usage has exceeded its included quota",actions:[(0,M.jsx)(ea.z,{asChild:!0,type:"default",className:"ml-8",children:(0,M.jsx)($(),{href:"/org/".concat(t,"/billing?panel=").concat("free"===y.plan.id?"subscriptionPlan":"costControl"),children:"free"===y.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button")],children:["Your projects can become unresponsive or enter read only mode."," ","free"===y.plan.id?"Please upgrade to the Pro plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]})}),d&&(0,M.jsx)(o._S,{className:"mt-5",children:(0,M.jsx)(e7.Z,{title:"Usage filtered by project",description:(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsxs)("p",{children:['You are currently viewing usage for the "',(null==I?void 0:I.name)||d,'" project. Since your organization is using the new organization-based billing, the included quota is for your whole organization and not just this project. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']}),(0,M.jsx)("div",{children:(0,M.jsx)(ea.z,{asChild:!0,type:"default",icon:(0,M.jsx)(en.Z,{strokeWidth:1.5}),children:(0,M.jsx)($(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]}),defaultVisibility:!0,hideCollapse:!0,icon:(0,M.jsx)(nJ.Z,{})})}),(0,M.jsx)(tr,{orgSlug:t,projectRef:d,subscription:y,startDate:A,endDate:D,currentBillingCycleSelected:E}),(0,M.jsx)(tt,{orgSlug:t,projectRef:d,subscription:y,startDate:A,endDate:D,currentBillingCycleSelected:E}),(0,M.jsx)(tn,{orgSlug:t,projectRef:d,subscription:y,startDate:A,endDate:D,currentBillingCycleSelected:E})]})},ta=r(38421),ti=r.n(ta),to=r(25149),tc=r(71320),tl=r(25455),td=r(2653),tu=r(62644),tp=r(34161),tm=["enabled"];function th(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tx(){return(tx=(0,c.Z)(d().mark(function e(n,r){var t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug,s=n.iso_timestamp_start,a=n.iso_timestamp_end,n.project_refs,t){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/audit?iso_timestamp_start=").concat(s,"&iso_timestamp_end=").concat(a),{signal:r});case 5:if(!(i=e.sent).error){e.next=8;break}throw i.error;case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tf=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enabled,t=(0,j.Z)(n,tm),s=e.slug,a=e.iso_timestamp_start,i=e.iso_timestamp_end,o=ek()(a).utc().format("YYYY-MM-DD"),c=ek()(i).utc().format("YYYY-MM-DD");return(0,b.a)(N.O.auditLogs(s,{date_start:o,date_end:c}),function(n){return function(e,n){return tx.apply(this,arguments)}(e,n.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?th(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):th(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===r||r)&&void 0!==s},t))},tg=["enabled"];function tv(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tj(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?tv(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tb(){return(tb=(0,c.Z)(d().mark(function e(n,r){var t,s,a,i,o,c,l,u,p,m;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,Promise.all([(0,Y.U2)("/platform/organizations/{slug}/members",{params:{path:{slug:t}},signal:r}),(0,Y.U2)("/platform/organizations/{slug}/members/invite",{params:{path:{slug:t}},signal:r})]);case 5:if(s=e.sent,i=(a=(0,n2.Z)(s,2))[0],o=a[1],c=i.data,l=i.error,u=o.data,p=o.error,!l){e.next=13;break}throw l;case 13:if(!p){e.next=15;break}throw p;case 15:return m=u.map(function(e){return tj(tj({},{invited_at:e.invited_at,invited_id:e.invited_id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email}),{},{role_ids:[e.role_id]})}),e.abrupt("return",[].concat((0,nb.Z)(c),(0,nb.Z)(m)));case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ty=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,tg);return(0,b.a)(N.O.members(n),function(e){return function(e,n){return tb.apply(this,arguments)}({slug:n},e.signal)},tj({enabled:(void 0===t||t)&&void 0!==n},s))},tw=["enabled"];function tN(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tO(){return(tO=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.T5,"/organizations/").concat(t,"/roles"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",{roles:s});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tS=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,tw);return(0,b.a)(N.O.roles(n),function(e){return function(e,n){return tO.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?tN(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))};function t_(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tC(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t_(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var tk=function(){var e,n,r,t,s,a,i,c=(0,m.UO)().slug,l=ek()().utc().set("millisecond",0),d=(0,p.useState)(!0),u=d[0],x=d[1],f=(0,p.useState)({from:l.subtract(1,"day").toISOString(),to:l.toISOString()}),v=f[0],j=f[1],b=(0,p.useState)(),y=b[0],w=b[1],N=(0,p.useState)({users:[],projects:[]}),O=N[0],S=N[1],_=(0,rH.Sy)().data,C=(0,q.tl)().data,k=ty({slug:c}).data,P=tS({slug:c}).data,Z=tf({slug:c,iso_timestamp_start:v.from,iso_timestamp_end:v.to},{retry:function(e,n){return!n.message.endsWith("upgrade to team or enterprise plan to access audit logs.")},retryOnMount:!1,refetchOnWindowFocus:!1}),E=Z.data,A=Z.error,D=Z.isLoading,I=Z.isSuccess,z=Z.isError,T=Z.isRefetching,R=Z.refetch;(0,p.useEffect)(function(){var e=ek()(v.from).diff(ek()(v.to)),n=setInterval(function(){var n=ek()().utc().set("millisecond",0);j({from:n.add(e).toISOString(),to:n.toISOString()})},3e5);return function(){return clearInterval(n)}},[v.from,v.to]);var L=null!==(e=null==P?void 0:P.roles)&&void 0!==e?e:[],F=null!==(n=null==E?void 0:E.retention_period)&&void 0!==n?n:0,U=null!==(r=null==E?void 0:E.result)&&void 0!==r?r:[],Y=null==U?void 0:null===(t=U.sort(function(e,n){return u?Number(new Date(n.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(n.occurred_at))}))||void 0===t?void 0:null===(s=t.filter(function(e){return O.users.length>0?O.users.includes(e.actor.id):e}))||void 0===s?void 0:s.filter(function(e){return O.projects.length>0?O.projects.includes(e.target.metadata.project_ref||""):e}),B=null==C?void 0:C.find(function(e){return e.slug===c});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.gW,{children:(0,M.jsxs)("div",{className:"space-y-4 flex flex-col",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,M.jsx)(tu.E,{name:"Users",options:null!=k?k:[],labelKey:"username",valueKey:"gotrue_id",activeOptions:O.users,onSaveFilters:function(e){return S(tC(tC({},O),{},{users:e}))}}),(0,M.jsx)(tu.E,{name:"Projects",options:null!==(a=null==_?void 0:_.filter(function(e){return e.organization_id===(null==B?void 0:B.id)}))&&void 0!==a?a:[],labelKey:"name",valueKey:"ref",activeOptions:O.projects,onSaveFilters:function(e){return S(tC(tC({},O),{},{projects:e}))}}),(0,M.jsx)(tp.M,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:v.from,to:v.to,minDate:ek()().subtract(F,"days").toDate(),maxDate:ek()().toDate(),onChange:function(e){if(null!==e.from&&null!==e.to){var n=ek()().utc();j({from:ek()(e.from).utc().hour(n.hour()).minute(n.minute()).second(n.second()).toISOString(),to:ek()(e.to).utc().hour(n.hour()).minute(n.minute()).second(n.second()).toISOString()})}},renderFooter:function(){return(0,M.jsxs)(er.b,{title:"",variant:"info",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:["Your organization has a log retention period of"," ",(0,M.jsxs)("span",{className:"text-brand",children:[F," day",F>1?"s":""]}),". You may only view logs from"," ",ek()().subtract(F,"days").format("DD MMM YYYY")," as the earliest date."]})}}),I&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,M.jsxs)("p",{className:"prose text-xs",children:["Viewing ",Y.length," logs in total"]})]})]}),(0,M.jsx)(ea.z,{type:"default",disabled:D||T,icon:(0,M.jsx)(to.Z,{className:T?"animate-spin":""}),onClick:function(){return R()},children:T?"Refreshing":"Refresh"})]}),D&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),z?A.message.endsWith("upgrade to team or enterprise plan to access audit logs.")?(0,M.jsxs)(et.bZ,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,M.jsx)(n0.Z,{className:"h-4 w-4 mt-3"}),(0,M.jsxs)("div",{className:"flex flex-row pt-3 pb-2",children:[(0,M.jsxs)("div",{className:"grow",children:[(0,M.jsx)(et.Cd,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,M.jsx)(et.X,{className:"flex flex-row justify-between gap-3",children:(0,M.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,M.jsx)("div",{className:"flex items-center",children:(0,M.jsx)(ea.z,{type:"primary",asChild:!0,children:(0,M.jsx)($(),{href:"/org/".concat(c,"/billing?panel=subscriptionPlan"),children:"Upgrade subscription"})})})]})]}):(0,M.jsx)(h.Z,{error:A,subject:"Failed to retrieve audit logs"}):null,I&&(0,M.jsx)(M.Fragment,{children:0===U.length?(0,M.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,M.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):U.length>0&&0===Y.length?(0,M.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,M.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,M.jsx)(ec.Z,{head:[(0,M.jsx)(ec.Z.th,{className:"py-2",children:"User"},"user"),(0,M.jsx)(ec.Z.th,{className:"py-2",children:"Action"},"action"),(0,M.jsx)(ec.Z.th,{className:"py-2",children:"Target"},"target"),(0,M.jsx)(ec.Z.th,{className:"py-2",children:(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{children:"Date"}),(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"text",className:"px-1",icon:u?(0,M.jsx)(tc.Z,{strokeWidth:1.5,size:14}):(0,M.jsx)(tl.Z,{strokeWidth:1.5,size:14}),onClick:function(){return x(!u)}})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"right",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:u?"Sort latest first":"Sort earliest first"})})]})})]})]})},"date"),(0,M.jsx)(ec.Z.th,{className:"py-2"},"actions")],body:null!==(i=null==Y?void 0:Y.map(function(e){var n,r,t,s,a,i,o,c,l,d=(null!=k?k:[]).find(function(n){return n.gotrue_id===e.actor.id}),u=L.find(function(e){var n;return(null==d?void 0:null===(n=d.role_ids)||void 0===n?void 0:n[0])===e.id}),p=null==_?void 0:_.find(function(n){return n.ref===e.target.metadata.project_ref}),m=null==C?void 0:C.find(function(n){return n.slug===e.target.metadata.org_slug}),h=(null===(n=e.action.metadata[0])||void 0===n?void 0:n.status)!==void 0,x=void 0===d?(0,M.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,M.jsx)("p",{children:"?"})}):null!=d&&d.invited_id||(null==d?void 0:d.username)===(null==d?void 0:d.primary_email)?(0,M.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,M.jsx)(td.Z,{size:18,strokeWidth:2})}):(0,M.jsx)(ti(),{alt:null==d?void 0:d.username,src:"https://github.com/".concat(null!==(r=null==d?void 0:d.username)&&void 0!==r?r:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,M.jsxs)(ec.Z.tr,{onClick:function(){return w(e)},className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,M.jsx)("div",{children:x}),(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-foreground-light",children:null!==(t=null==d?void 0:d.username)&&void 0!==t?t:"-"}),u&&(0,M.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==u?void 0:u.name})]})]})}),(0,M.jsx)(ec.Z.td,{className:"max-w-[250px]",children:(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[h&&(0,M.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,M.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,M.jsxs)(ec.Z.td,{children:[(0,M.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!==(s=null!==(a=null==p?void 0:p.name)&&void 0!==a?a:null==m?void 0:m.name)&&void 0!==s?s:"-",children:[null!=p&&p.name?"Project: ":null!=m&&m.name?"Organization: ":null,null!==(i=null!==(o=null==p?void 0:p.name)&&void 0!==o?o:null==m?void 0:m.name)&&void 0!==i?i:"Unknown"]}),(0,M.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!==(c=e.target.metadata.project_ref)&&void 0!==c?c:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!==(l=e.target.metadata.project_ref)&&void 0!==l?l:e.target.metadata.org_slug]})]}),(0,M.jsx)(ec.Z.td,{children:ek()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,M.jsx)(ec.Z.td,{align:"right",children:(0,M.jsx)(ea.z,{type:"default",children:"View details"})})]},e.occurred_at)}))&&void 0!==i?i:[]})})]})}),(0,M.jsx)(tu.h,{selectedLog:y,onClose:function(){return w(void 0)}})]})},tP={oauthApps:function(e){return[e,"oauth-apps"]},authorizedApps:function(e){return[e,"authorized-apps"]}},tZ=["enabled"];function tE(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tA(){return(tA=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("Organization slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.Q2,"/organizations/").concat(t,"/oauth/apps?type=authorized"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tD=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,tZ);return(0,b.a)(tP.authorizedApps(n),function(e){return function(e,n){return tA.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?tE(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},tI=["enabled"];function tz(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tT(){return(tT=(0,c.Z)(d().mark(function e(n,r){var t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.slug){e.next=3;break}throw Error("Organization slug is required");case 3:return e.next=5,(0,y.U2)("".concat(w.Q2,"/organizations/").concat(t,"/oauth/apps?type=published"),{signal:r});case 5:if(!(s=e.sent).error){e.next=8;break}throw s.error;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tR=function(e){var n=e.slug,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.enabled,s=(0,j.Z)(r,tI);return(0,b.a)(tP.oauthApps(n),function(e){return function(e,n){return tT.apply(this,arguments)}({slug:n},e.signal)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?tz(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({enabled:(void 0===t||t)&&void 0!==n},s))},tL=r(77426),tF=function(e){var n=e.app,r=e.onSelectRevoke;return(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:n.icon?"url('".concat(n.icon,"')"):"none"},children:n.icon?"":"".concat(n.name[0])})}),(0,M.jsx)(ec.Z.td,{children:n.name}),(0,M.jsx)(ec.Z.td,{children:ek()(n.authorized_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,M.jsx)(ec.Z.td,{align:"right",children:(0,M.jsx)(ea.z,{type:"default",icon:(0,M.jsx)(tL.Z,{}),className:"px-1",onClick:function(){return r()}})})]})},tM=["onSuccess","onError"];function tU(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tY(){return(tY=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.id,t=n.slug,r){e.next=3;break}throw Error("OAuth app ID is required");case 3:if(t){e.next=5;break}throw Error("Organization slug is required");case 5:return e.next=7,(0,y.$v)("".concat(w.Q2,"/organizations/").concat(t,"/oauth/apps/").concat(r,"?type=published"));case 7:if(!(s=e.sent).error){e.next=10;break}throw s.error;case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tB=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,tM),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return tY.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?tU(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(tP.oauthApps(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to delete application: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},tG=r(22962),tW=function(e){var n,r=e.selectedApp,t=e.onClose,s=(0,z.oR)().ui,a=(0,m.UO)().slug,i=tB({onSuccess:function(){s.setNotification({category:"success",message:'Successfully deleted the app "'.concat(null==r?void 0:r.name,'"')}),t()}}),o=i.mutate,l=i.isLoading,u=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(null!=r&&r.id){e.next=4;break}return e.abrupt("return",console.error("App ID is required"));case 4:o({slug:a,id:null==r?void 0:r.id});case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,M.jsx)(e$.C,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==r?void 0:r.name),visible:void 0!==r,loading:l,onCancel:t,onConfirm:u,children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"py-4",children:[(0,M.jsxs)(er.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:["Deleting ",null==r?void 0:r.name," will invalidate any access tokens from this application that were authorized by users."]}),(0,M.jsx)("ul",{className:"mt-4 space-y-5",children:(0,M.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,M.jsx)(tG.Z,{w:14,className:"flex-shrink-0"}),(0,M.jsxs)("div",{children:[(0,M.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,M.jsx)("ul",{className:"space-y-2 mt-2",children:(0,M.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})]})})})},tV=r(51459),tq=r(924),tK=r(34040),tX=function(e){var n=e.app,r=e.onSelectEdit,t=e.onSelectDelete,s=(0,p.useState)(!1),a=s[0],i=s[1];return(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:n.icon?"url('".concat(n.icon,"')"):"none"},children:n.icon?"":"".concat(n.name[0])})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("p",{title:n.name,className:"truncate",children:n.name})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)("p",{className:"font-mono truncate w-[220px]",title:n.client_id,children:n.client_id}),(0,M.jsx)(ea.z,{type:"default",icon:a?(0,M.jsx)(nd.Z,{className:"text-brand",strokeWidth:3}):(0,M.jsx)(tV.Z,{}),className:"ml-2 px-1",onClick:function(){(0,eM.vQ)(n.client_id),i(!0),setTimeout(function(){i(!1)},3e3)}})]})}),(0,M.jsx)(ec.Z.td,{children:(0,M.jsxs)("span",{className:"font-mono",title:n.client_secret_alias,children:[n.client_secret_alias,"..."]})}),(0,M.jsx)(ec.Z.td,{children:ek()(n.created_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,M.jsx)(ec.Z.td,{align:"right",children:(0,M.jsxs)(eX.h_,{children:[(0,M.jsx)(eX.$F,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"default",icon:(0,M.jsx)(tq.Z,{}),className:"px-1"})}),(0,M.jsxs)(eX.AW,{align:"end",side:"bottom",children:[(0,M.jsxs)(eX.Xi,{className:"space-x-2",onClick:function(){return r()},children:[(0,M.jsx)(tK.Z,{}),(0,M.jsx)("p",{children:"Edit app"})]},"edit"),(0,M.jsx)(eX.VD,{}),(0,M.jsxs)(eX.Xi,{className:"space-x-2",onClick:function(){return t()},children:[(0,M.jsx)(tL.Z,{}),(0,M.jsx)("p",{children:"Delete app"})]},"delete")]})]})})]})},tH=["onSuccess","onError"];function t$(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function tQ(){return(tQ=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i,o,c;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.name,s=n.website,a=n.icon,i=n.scopes,o=n.redirect_uris,e.next=3,(0,y.v_)("".concat(w.Q2,"/organizations/").concat(r,"/oauth/apps"),{name:t,website:s,icon:a,scopes:i,redirect_uris:o});case 3:if(!(c=e.sent).error){e.next=6;break}throw c.error;case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tJ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,tH),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return tQ.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t$(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(tP.oauthApps(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to create OAuth application: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},t0=["onSuccess","onError"];function t1(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function t2(){return(t2=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i,o,c,l;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.id,t=n.slug,s=n.name,a=n.website,i=n.icon,o=n.scopes,c=n.redirect_uris,r){e.next=3;break}throw Error("OAuth app ID is required");case 3:if(t){e.next=5;break}throw Error("Organization slug is required");case 5:if(s){e.next=7;break}throw Error("OAuth app name is required");case 7:if(a){e.next=9;break}throw Error("OAuth app URL is required");case 9:if(!(!c||0===c.length)){e.next=11;break}throw Error("Redirect URIs are required");case 11:return e.next=13,(0,y.gz)("".concat(w.Q2,"/organizations/").concat(t,"/oauth/apps/").concat(r),{name:s,website:a,icon:i,scopes:o,redirect_uris:c});case 13:if(!(l=e.sent).error){e.next=16;break}throw l.error;case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}var t4=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,t0),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return t2.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t1(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(tP.oauthApps(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update application: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},t3=r(70536),t5=(s=(0,c.Z)(d().mark(function e(n,r,t){var s,a,i,o,c,l,u,p=arguments;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(p.length>3)||void 0===p[3]||p[3],a=(0,t3.eI)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTIyNjkzMjYsImV4cCI6MjAwNzg0NTMyNn0.1S6qpBbHtEmGuMsIx5UOhRiFd4YbVv-yLTrLk6tVGmM",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:function(e){},setItem:function(e,n){},removeItem:function(e){}}}}),i={cacheControl:"3600"},e.next=5,a.storage.from(n).upload(r,t,i);case 5:if(c=(o=e.sent).data,!(l=o.error)){e.next=11;break}return console.error("Failed to upload:",l),e.abrupt("return",void 0);case 11:if(!(c&&s)){e.next=17;break}return e.next=14,a.storage.from(n).getPublicUrl(c.path);case 14:return u=e.sent.data,e.abrupt("return",null==u?void 0:u.publicUrl);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}},e)})),function(e,n,r){return s.apply(this,arguments)}),t6=r(33725),t8=r(54859),t7=r(77740),t9=function(e){var n=e.children,r=e.scopeName,t=e.scopes,s=e.onChange;return(0,M.jsx)(eX.bO,{checked:t.includes(r),onCheckedChange:function(e){e?s([].concat((0,nb.Z)(t),[r])):s((0,nb.Z)(t.filter(function(e){return e!==r})))},children:n})},se=function(e){var n=e.title,r=e.description,t=e.readScopeName,s=e.writeScopeName,a=e.scopes,i=e.setScopes,o="Access: No access";return a.includes(t)&&(o="Access: Read-only"),a.includes(s)&&(o="Access: Write-only"),a.includes(t)&&a.includes(s)&&(o="Access: Read and write"),(0,M.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b",children:[(0,M.jsxs)("div",{className:"flex flex-col",children:[(0,M.jsx)("span",{className:"text-foreground text-sm",children:n}),(0,M.jsx)("span",{className:"text-foreground-light text-xs",children:r})]}),(0,M.jsxs)(eX.h_,{children:[(0,M.jsx)(eX.$F,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"default",iconRight:(0,M.jsx)(t7.Z,{}),children:(0,M.jsx)("p",{children:o})})}),(0,M.jsxs)(eX.AW,{align:"end",children:[(0,M.jsx)(eX.Ju,{children:"Select an access level"}),(0,M.jsx)(eX.VD,{}),(0,M.jsx)(t9,{scopeName:t,scopes:a,onChange:i,children:"Read"}),(0,M.jsx)(t9,{scopeName:s,scopes:a,onChange:i,children:"Write"})]})]})]},n)},sn=function(e){var n=e.scopes,r=e.setScopes;return(0,M.jsxs)("div",{className:"-space-y-px",children:[(0,M.jsx)(se,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:u.YX.AUTH_READ,writeScopeName:u.YX.AUTH_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:u.YX.DATABASE_READ,writeScopeName:u.YX.DATABASE_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:u.YX.DOMAINS_READ,writeScopeName:u.YX.DOMAINS_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Edge Functions",description:"Edge functions.",readScopeName:u.YX.EDGE_FUNCTIONS_READ,writeScopeName:u.YX.EDGE_FUNCTIONS_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Environment",description:"Environments/branches.",readScopeName:u.YX.ENVIRONMENT_READ,writeScopeName:u.YX.ENVIRONMENT_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Organizations",description:"Organizations and all its members.",readScopeName:u.YX.ORGANIZATIONS_READ,writeScopeName:u.YX.ORGANIZATIONS_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:u.YX.PROJECTS_READ,writeScopeName:u.YX.PROJECTS_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"REST",description:"PostgREST configurations.",readScopeName:u.YX.REST_READ,writeScopeName:u.YX.REST_WRITE,scopes:n,setScopes:r}),(0,M.jsx)(se,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:u.YX.SECRETS_READ,writeScopeName:u.YX.SECRETS_WRITE,scopes:n,setScopes:r})]})},sr=function(e){var n,r,t=e.visible,s=e.selectedApp,a=e.onClose,i=e.onCreateSuccess,o=(0,z.oR)().ui,l=(0,m.UO)().slug,u=(0,p.useRef)(),h=tJ({onSuccess:function(e,n){o.setNotification({category:"success",message:'Successfully created OAuth app "'.concat(n.name,'"!')}),a(),i(e),v(!1)},onError:function(e){o.setNotification({error:e,category:"error",message:"Failed to create OAuth application: ".concat(e.message)}),v(!1)}}).mutate,x=t4({onSuccess:function(e,n){o.setNotification({category:"success",message:'Successfully updated OAuth app "'.concat(n.name,'"!')}),a(),v(!1)},onError:function(e){o.setNotification({error:e,category:"error",message:"Failed to update OAuth application: ".concat(e.message)}),v(!1)}}).mutate,f=(0,p.useState)(!1),g=f[0],v=f[1],j=(0,p.useState)(!1),b=j[0],y=j[1],w=(0,p.useState)(),N=w[0],O=w[1],S=(0,p.useState)(),_=S[0],C=S[1],k=(0,p.useState)({}),P=k[0],Z=k[1],E=(0,p.useState)([{id:(0,eM.k$)(),value:""}]),A=E[0],D=E[1],I=(0,p.useState)([]),L=I[0],F=I[1];(0,p.useEffect)(function(){t&&(Z({}),v(!1),O(void 0),void 0!==s?(D(s.redirect_uris.map(function(e){return{id:(0,eM.k$)(),value:e}})),F(s.scopes),C(null===s.icon?void 0:s.icon)):(D([{id:(0,eM.k$)(),value:""}]),F([]),C(void 0)))},[t,s]);var U=function(e,n){D(A.map(function(r){return r.id===e?{id:e,value:n}:r})),Z({})},Y=function(e){D(A.filter(function(n){return n.id!==e}))},B=(n=(0,c.Z)(d().mark(function e(n){var r,t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.persist(),r=n.target.files||n.dataTransfer.items,O(t=(0,n2.Z)(r,1)[0]),C(URL.createObjectURL(t)),n.target.value="";case 5:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),G=(r=(0,c.Z)(d().mark(function e(n){var r,t,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(0!==(r=A.filter(function(e){return e.value.length>0}).map(function(e){return e.value})).length){e.next=8;break}return Z({urls:"Please provide at least one URL"}),e.abrupt("return");case 8:Z({});case 9:if(v(!0),t=n.name,a=n.website,!(void 0!==N)){e.next=17;break}return e.next=14,t5("oauth-app-icons","".concat(l,"/").concat((0,eM.k$)(),".png"),N);case 14:e.t0=e.sent,e.next=18;break;case 17:e.t0=_;case 18:i=e.t0,void 0===s?h({slug:l,name:t,website:a,redirect_uris:r,scopes:L,icon:i}):x({id:s.id,slug:l,name:t,website:a,redirect_uris:r,scopes:L,icon:void 0===i?null:i});case 20:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)});return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(ev.ZP,{hideFooter:!0,size:"large",visible:t,header:void 0!==s?"Update OAuth application":"Publish a new OAuth application",onCancel:function(){return a()},children:(0,M.jsx)(T.Z,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:function(e){var n={};return e.name||(n.name="Please provide a name for your application"),e.website||(n.website="Please provide a URL for your site"),(0,eM.HH)(e.website)||(n.website="Please provide a valid URL for your site"),n},onSubmit:G,children:function(e){var n=e.resetForm,r=e.values;return(0,p.useEffect)(function(){if(t&&void 0!==s){var e={name:s.name,website:s.website};n({values:e,initialValues:e})}},[t,s]),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"h-full flex flex-col",children:[(0,M.jsxs)("div",{className:"flex-grow",children:[(0,M.jsx)(ev.ZP.Content,{children:(0,M.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,M.jsxs)("div",{className:"space-y-4 w-full",children:[(0,M.jsx)(R.Z,{id:"name",label:"Application name",descriptionText:(null==s?void 0:s.id)&&"ID: ".concat(s.id)}),(0,M.jsx)(R.Z,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,M.jsxs)("div",{children:[void 0!==_?(0,M.jsx)("div",{className:(0,eo.default)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:_?'url("'.concat(_,'")'):"none"},children:(0,M.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,M.jsxs)(eX.h_,{children:[(0,M.jsx)(eX.$F,{children:(0,M.jsx)(ea.z,{type:"default",icon:(0,M.jsx)(tK.Z,{}),className:"px-1"})}),(0,M.jsxs)(eX.AW,{align:"end",side:"bottom",children:[(0,M.jsx)(eX.Xi,{onClick:function(){u.current&&u.current.click()},children:(0,M.jsx)("p",{children:"Upload image"})},"upload"),(0,M.jsx)(eX.Xi,{onClick:function(){O(void 0),C(void 0)},children:(0,M.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,M.jsxs)("div",{className:(0,eo.default)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:function(){u.current&&u.current.click()},children:[(0,M.jsx)(t6.Z,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,M.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,M.jsx)("input",{multiple:!0,type:"file",ref:u,className:"hidden",accept:"image/png, image/jpeg",onChange:B})]})]})}),(0,M.jsx)(ev.ZP.Separator,{}),(0,M.jsxs)(ev.ZP.Content,{className:"py-4",children:[(0,M.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"prose text-sm",children:"Authorization callback URLs"}),(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,M.jsx)(ea.z,{onClick:function(){return D(A.concat({id:(0,eM.k$)(),value:""}))},children:"Add URL"})]}),(0,M.jsxs)("div",{className:"space-y-2 pb-2",children:[A.map(function(e){return(0,M.jsx)(R.Z,{value:e.value,onChange:function(n){return U(e.id,n.target.value)},placeholder:"e.g https://my-website.com",actions:[A.length>1?(0,M.jsx)(ea.z,{type:"default",onClick:function(){return Y(e.id)},children:"Remove"},"remove-url"):null]},e.id)}),P.urls&&(0,M.jsx)("p",{className:"text-red-900 text-sm",children:P.urls})]})]}),(0,M.jsx)(ev.ZP.Separator,{}),(0,M.jsxs)("div",{className:"p-6 ",children:[(0,M.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,M.jsxs)("div",{className:"flex flex-col",children:[(0,M.jsx)("span",{className:"prose text-sm",children:"Application permissions"}),(0,M.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,M.jsx)(ea.z,{asChild:!0,type:"default",icon:(0,M.jsx)(en.Z,{}),children:(0,M.jsx)($(),{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes",target:"_blank",rel:"noreferrer",children:"Documentation"})})]}),(0,M.jsx)(sn,{scopes:L,setScopes:F})]})]}),(0,M.jsx)(ev.ZP.Separator,{}),(0,M.jsx)(ev.ZP.Content,{children:(0,M.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,M.jsx)(ea.z,{type:"default",onClick:function(){return y(!0)},disabled:0===r.name.length||0===r.website.length,children:"Preview consent for users"}),(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)(ea.z,{type:"default",disabled:g,onClick:function(){return a()},children:"Cancel"}),(0,M.jsx)(ea.z,{htmlType:"submit",loading:g,disabled:g,children:"Confirm"})]})]})})]}),(0,M.jsxs)(e$.C,{hideFooter:!0,className:"!max-w-[600px]",visible:b,onCancel:function(){return y(!1)},children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"pt-4 pb-2 px-2 flex items-center justify-between",children:[(0,M.jsxs)("p",{children:["Authorize API access for ",r.name]}),(0,M.jsx)(eI.Z,{color:"green",children:"Preview"})]})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"px-2 py-4",children:[(0,M.jsx)(t8.Z,{icon:_||null,name:r.name,domain:r.website,scopes:L}),(0,M.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,M.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,M.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,M.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,M.jsx)(ea.z,{type:"default",onClick:function(){return y(!1)},children:"Close"})]})})]})]})}})})})},st=["onSuccess","onError"];function ss(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sa(){return(sa=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.id,t=n.slug,r){e.next=3;break}throw Error("App ID is required");case 3:if(t){e.next=5;break}throw Error("Organization slug is required");case 5:return e.next=7,(0,y.v_)("".concat(w.Q2,"/organizations/").concat(t,"/oauth/apps/").concat(r,"/revoke"),{});case 7:if(!(s=e.sent).error){e.next=10;break}throw s.error;case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var si=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,st),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return sa.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ss(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,s.invalidateQueries(tP.authorizedApps(i));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to revoke application: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},so=function(e){var n,r=e.selectedApp,t=e.onClose,s=(0,z.oR)().ui,a=(0,m.UO)().slug,i=si({onSuccess:function(){s.setNotification({category:"success",message:'Successfully revoked the app "'.concat(null==r?void 0:r.name,'"')}),t()}}),o=i.mutate,l=i.isLoading,u=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",console.error("Slug is required"));case 2:if(null!=r&&r.id){e.next=4;break}return e.abrupt("return",console.error("App ID is required"));case 4:o({slug:a,id:null==r?void 0:r.id});case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,M.jsx)(e$.C,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==r?void 0:r.name),visible:void 0!==r,loading:l,onCancel:t,onConfirm:u,children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"py-4",children:[(0,M.jsxs)(er.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:[null==r?void 0:r.name," application will no longer have access to your organization's settings and projects."]}),(0,M.jsx)("ul",{className:"mt-4 space-y-5",children:(0,M.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,M.jsx)(tG.Z,{w:14,className:"flex-shrink-0"}),(0,M.jsxs)("div",{children:[(0,M.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,M.jsx)("ul",{className:"space-y-2 mt-2",children:(0,M.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})]})})})},sc=function(){var e,n,r,t,s=(0,m.UO)().slug,a=(0,p.useState)(!1),i=a[0],c=a[1],l=(0,p.useState)(),d=l[0],u=l[1],x=(0,p.useState)(),f=x[0],v=x[1],j=(0,p.useState)(),b=j[0],y=j[1],w=(0,p.useState)(),N=w[0],O=w[1],S=tR({slug:s}),_=S.data,C=S.error,k=S.isLoading,P=S.isSuccess,Z=S.isError,E=null==_?void 0:_.sort(function(e,n){return Number(new Date(e.created_at))-Number(new Date(n.created_at))}),A=tD({slug:s}),D=A.data,I=A.isLoading,z=A.isSuccess,T=A.isError,L=null==D?void 0:D.sort(function(e,n){return Number(new Date(e.authorized_at))-Number(new Date(n.authorized_at))});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.gW,{children:[(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{children:"Published Apps"}),(0,M.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,M.jsx)(ea.z,{type:"primary",onClick:function(){return c(!0)},children:"Add application"})]}),k&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),Z&&(0,M.jsx)(h.Z,{error:C,subject:"Failed to retrieve published OAuth apps"}),void 0!==d&&(0,M.jsxs)(er.b,{withIcon:!0,variant:"success",title:"Successfully published a new application!",children:[(0,M.jsx)("div",{className:"absolute top-4 right-4",children:(0,M.jsx)(ea.z,{type:"text",icon:(0,M.jsx)(nY.Z,{size:18}),className:"px-1",onClick:function(){return u(void 0)}})}),(0,M.jsxs)("div",{className:"w-full space-y-4",children:[(0,M.jsx)("p",{className:"text-sm",children:"Ensure that you store the client secret securely - you will not be able to see it again."}),(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)(R.Z,{copy:!0,readOnly:!0,size:"small",label:"Client ID",className:"max-w-xl input-mono",value:d.client_id,onChange:function(){}}),(0,M.jsx)(R.Z,{copy:!0,readOnly:!0,size:"small",label:"Client secret",className:"max-w-xl input-mono",value:d.client_secret,onChange:function(){}})]})]})]}),P&&(0,M.jsx)(M.Fragment,{children:(null!==(e=null==_?void 0:_.length)&&void 0!==e?e:0)===0?(0,M.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,M.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,M.jsx)(ec.Z,{head:[(0,M.jsx)(ec.Z.th,{className:"w-[30px]"},"icon"),(0,M.jsx)(ec.Z.th,{children:"Name"},"name"),(0,M.jsx)(ec.Z.th,{children:"Client ID"},"client-id"),(0,M.jsx)(ec.Z.th,{children:"Client Secret"},"client-secret"),(0,M.jsx)(ec.Z.th,{children:"Created at"},"created-at"),(0,M.jsx)(ec.Z.th,{},"delete-action")],body:null!==(n=null==E?void 0:E.map(function(e){return(0,M.jsx)(tX,{app:e,onSelectEdit:function(){c(!0),v(e)},onSelectDelete:function(){return y(e)}},e.id)}))&&void 0!==n?n:[]})})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{children:"Authorized Apps"}),(0,M.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,M.jsxs)("div",{className:"mt-4",children:[I&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),T&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve authorized apps"}),z&&(0,M.jsx)(M.Fragment,{children:(null!==(r=D.length)&&void 0!==r?r:0)===0?(0,M.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,M.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,M.jsx)(ec.Z,{className:"mt-4",head:[(0,M.jsx)(ec.Z.th,{className:"w-[30px]"},"icon"),(0,M.jsx)(ec.Z.th,{children:"Name"},"name"),(0,M.jsx)(ec.Z.th,{children:"Authorized at"},"authorized-at"),(0,M.jsx)(ec.Z.th,{},"delete-action")],body:null!==(t=null==L?void 0:L.map(function(e){return(0,M.jsx)(tF,{app:e,onSelectRevoke:function(){return O(e)}},e.id)}))&&void 0!==t?t:[]})})]})]})]}),(0,M.jsx)(sr,{visible:i,selectedApp:f,onClose:function(){v(void 0),c(!1)},onCreateSuccess:u}),(0,M.jsx)(tW,{selectedApp:b,onClose:function(){return y(void 0)}}),(0,M.jsx)(so,{selectedApp:N,onClose:function(){return O(void 0)}})]})},sl=r(55210),sd=r(13734),su=["onSuccess","onError"];function sp(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sm(){return(sm=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.gotrueId,e.next=3,(0,y.$v)("".concat(w.T5,"/organizations/").concat(r,"/members/").concat(t));case 3:if(!(s=e.sent).error){e.next=6;break}throw s.error;case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var sh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,su),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return sm.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sp(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sp(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]);case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to remove member: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},sx=r(43095),sf=r(44183),sg=r(15688),sv=r(65413),sj=["onSuccess","onError"];function sb(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sy(){return(sy=(0,c.Z)(d().mark(function e(n){var r,t,s,a,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.invitedEmail,s=n.ownerId,a=n.roleId,e.next=3,(0,y.v_)("".concat(w.T5,"/organizations/").concat(r,"/members/invite"),{invited_email:t,owner_id:s,role_id:a});case 3:if(!(i=e.sent).error){e.next=6;break}throw i.error;case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var sw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,sj),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return sy.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sb(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]);case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to invite member: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))};function sN(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sO(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sN(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var sS=function(e){var n,r=e.orgId,t=e.userId,s=e.members,a=void 0===s?[]:s,i=e.roles,o=void 0===i?[]:i,l=e.rolesAddable,h=void 0===l?[]:l,x=(0,z.oR)().ui,f=(0,m.UO)().slug,g=(0,p.useState)(!1),v=g[0],j=g[1],b=(0,z.Rc)().permissions,y=o.some(function(e){var n=e.id;return(0,z.G8)(b,u.KA.CREATE,"user_invites",{resource:{role_id:n}},r)}),w={email:"",role:""},N=(0,sv.object)({email:(0,sv.string)().email("Must be a valid email address").required("Email is required"),role:(0,sv.string)().required("Role is required")}),O=sw(),S=O.mutateAsync,_=O.isLoading,C=(n=(0,c.Z)(d().mark(function e(n,r){var s,i,o,c;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.resetForm,f){e.next=3;break}throw Error("slug is required");case 3:if(!(void 0!==(i=a.find(function(e){return e.primary_email===n.email.toLowerCase()})))){e.next=10;break}if(!i.invited_id){e.next=9;break}return e.abrupt("return",x.setNotification({category:"info",message:"User has already been invited to this organization"}));case 9:return e.abrupt("return",x.setNotification({category:"info",message:"User is already in this organization"}));case 10:return o=Number(n.role),e.prev=11,e.next=14,S({slug:f,invitedEmail:n.email.toLowerCase(),ownerId:t,roleId:o});case 14:c=e.sent,(0,nw.isNil)(c)?x.setNotification({category:"error",message:"Failed to add member"}):(x.setNotification({category:"success",message:"Successfully added new member."}),j(!v),s({initialValues:sO(sO({},w),{},{role:o})})),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(11);case 20:case"end":return e.stop()}},e,null,[[11,18]])})),function(e,r){return n.apply(this,arguments)});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)(ea.z,{disabled:!y,onClick:function(){return j(!0)},children:"Invite"})}),!y&&(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to invite a member to this organization"})})]})})]}),(0,M.jsx)(e$.C,{hideFooter:!0,size:"medium",layout:"vertical",className:"!overflow-visible",visible:v,onCancel:function(){return j(!1)},header:"Invite a member to this organization",children:(0,M.jsx)(T.Z,{validationSchema:N,initialValues:w,onSubmit:C,children:function(e){var n=e.values,r=e.resetForm;(0,p.useEffect)(function(){if(o){var e,n;r({values:sO(sO({},w),{},{role:null===(e=o.find(function(e){return"Developer"===e.name}))||void 0===e?void 0:e.id}),initialValues:sO(sO({},w),{},{role:null===(n=o.find(function(e){return"Developer"===e.name}))||void 0===n?void 0:n.id})})}},[o]);var t=o.find(function(e){return e.id===Number(n.role)}),s=n.role&&!h.includes(Number(n.role));return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("div",{className:"w-full py-4",children:(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)("div",{className:"space-y-2",children:o&&(0,M.jsx)(L.Z,{id:"role",name:"role",label:"Member role",error:s?"You need additional permissions to assign users the role of ".concat(null==t?void 0:t.name):"",children:o.map(function(e){return(0,M.jsx)(L.Z.Option,{value:e.id,label:e.name,children:e.name},e.id)})})}),(0,M.jsx)(R.Z,{autoFocus:!0,id:"email",icon:(0,M.jsx)(sg.Z,{}),placeholder:"Enter email address",label:"Email address"})]})})}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("div",{className:"pt-2 pb-3",children:(0,M.jsx)(ea.z,{block:!0,size:"medium",htmlType:"submit",disabled:_||s,loading:_,children:"Invite new member"})})})]})}})})]})},s_=r(3929),sC=["onSuccess","onError"];function sk(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sP(){return(sP=(0,c.Z)(d().mark(function e(n){var r,t,s,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.gotrueId,s=n.roleId,e.next=3,(0,y.r$)("".concat(w.T5,"/organizations/").concat(r,"/members/").concat(t),{role_id:s});case 3:if(!(a=e.sent).error){e.next=6;break}throw a.error;case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var sZ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,sC),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return sP.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sk(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,a.next=3,Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]);case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to update member: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))};function sE(e){var n=new Date(e);return!((new Date().valueOf()-n.valueOf())/1e3/60/60<24)}var sA=function(e){if(!e)return"";var n=e||{},r=n.username,t=n.primary_email;return void 0!==n.invited_id?t:r||""},sD=["onSuccess","onError"];function sI(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sz(){return(sz=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.slug,t=n.invitedId,e.next=3,(0,y.$v)("".concat(w.T5,"/organizations/").concat(r,"/members/invite?invited_id=").concat(t),{});case 3:if(!(s=e.sent).error){e.next=6;break}throw s.error;case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var sT=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,t=(0,j.Z)(e,sD),s=(0,k.NL)();return(0,P.D)(function(e){return function(e){return sz.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sI(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,c.Z)(d().mark(function a(){var i,o;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.slug,o=r.invalidateDetail,a.next=3,Promise.all([].concat((0,nb.Z)(null==o||o?[s.invalidateQueries(N.O.members(i))]:[]),[s.invalidateQueries(N.O.roles(i))]));case 3:return a.next=5,null==n?void 0:n(e,r,t);case 5:case"end":return a.stop()}},a)}))()},onError:function(e,n,t){return(0,c.Z)(d().mark(function s(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?Z.Am.error("Failed to revoke invitation: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},t))},sR=function(e,n,r){var t=(0,z.Rc)(r,e,void 0!==r&&void 0!==e),s=t.permissions,a=t.organizationId,i=[],o=[];return n&&e&&n.forEach(function(e){(0,z.G8)(s,u.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},a)&&i.push(e.id),(0,z.G8)(s,u.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},a)&&o.push(e.id)}),{rolesAddable:i,rolesRemovable:o}},sL=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(function(e){var r,t=null!==(r=e.role_ids)&&void 0!==r?r:[],s=(0,n2.Z)(t,1)[0],a=n.find(function(e){return e.id===s});return(null==a?void 0:a.name)==="Owner"&&!e.invited_at}).length>1},sF=(0,rn.Pi)(function(e){var n,r,t,s,a,i,o,l=e.member,h=e.roles,x=(0,z.oR)().ui,f=(0,m.UO)().slug,g=(0,z.N3)("organization_members:delete"),v=(0,z.lL)(),j=(0,sx.js)().data,b=sR(null==v?void 0:v.id,h,null!=j?j:[]).rolesRemovable;sE(null!==(s=null==l?void 0:l.invited_at)&&void 0!==s?s:"");var y=l.invited_id,w=null!==(a=null===(i=l.role_ids)||void 0===i?void 0:i[0])&&void 0!==a?a:-1,N=b.includes((null!==(o=null==l?void 0:l.role_ids)&&void 0!==o?o:[-1])[0]),O=(0,z.Xo)(u.KA.CREATE,"user_invites",{resource:{role_id:w}}),S=(0,z.Xo)(u.KA.DELETE,"user_invites",{resource:{role_id:w}}),_=(0,p.useState)(!1),C=_[0],k=_[1],P=sh({onSuccess:function(){x.setNotification({category:"success",message:"Successfully removed ".concat(l.primary_email)}),k(!1)}}),Z=P.mutate,E=P.isLoading,A=sw({onSuccess:function(){x.setNotification({category:"success",message:"Resent the invitation."})},onError:function(e){x.setNotification({category:"error",message:"Failed to resend invitation: ".concat(e.message)})}}),D=A.mutate,I=A.isLoading,T=sT(),R=T.mutateAsync,L=T.isLoading,F=(n=(0,c.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}return e.abrupt("return",console.error("slug is required"));case 2:if(l.gotrue_id){e.next=4;break}return e.abrupt("return",console.error("gotrue_id is required"));case 4:Z({slug:f,gotrueId:l.gotrue_id});case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),U=(r=(0,c.Z)(d().mark(function e(n){var r,t,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(null!==(r=null==n?void 0:n.role_ids)&&void 0!==r?r:[])[0],s=n.invited_id,f){e.next=4;break}return e.abrupt("return",console.error("Slug is required"));case 4:if(s){e.next=6;break}return e.abrupt("return",console.error("Member invited ID is required"));case 6:return e.next=8,R({slug:f,invitedId:s,invalidateDetail:!1});case 8:D({slug:f,invitedEmail:n.primary_email,ownerId:s,roleId:t});case 9:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),Y=(t=(0,c.Z)(d().mark(function e(n){var r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.invited_id,f){e.next=3;break}return e.abrupt("return",console.error("Slug is required"));case 3:if(r){e.next=5;break}return e.abrupt("return",console.error("Member invited ID is required"));case 5:return e.next=7,R({slug:f,invitedId:r});case 7:x.setNotification({category:"success",message:"Successfully revoked the invitation."});case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)});if(!N||y&&!O&&!S)return(0,M.jsx)("div",{className:"flex items-center justify-end",children:(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"text",icon:(0,M.jsx)(eH.Z,{})})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to manage this team member"})})]})})]})});var B=E||L||I;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:"flex items-center justify-end",children:(0,M.jsxs)(eX.h_,{children:[(0,M.jsx)(eX.$F,{children:(0,M.jsx)(ea.z,{asChild:!0,type:"text",disabled:B,loading:B,icon:(0,M.jsx)(eH.Z,{}),children:(0,M.jsx)("span",{})})}),(0,M.jsx)(eX.AW,{side:"bottom",align:"end",children:(0,M.jsx)(M.Fragment,{children:y?(0,M.jsxs)(M.Fragment,{children:[S&&(0,M.jsx)(eX.Xi,{onClick:function(){return Y(l)},children:(0,M.jsxs)("div",{className:"flex flex-col",children:[(0,M.jsx)("p",{children:"Cancel invitation"}),(0,M.jsx)("p",{className:"block opacity-50",children:"Revoke this invitation."})]})}),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(eX.VD,{}),(0,M.jsx)(eX.Xi,{onClick:function(){return U(l)},children:(0,M.jsxs)("div",{className:"flex flex-col",children:[(0,M.jsx)("p",{children:"Resend invitation"}),(0,M.jsx)("p",{className:"block opacity-50",children:"Invites expire after 24hrs."})]})})]})]}):g&&(0,M.jsxs)(eX.Xi,{className:"space-x-2",onClick:function(){k(!0)},children:[(0,M.jsx)(tL.Z,{size:16}),(0,M.jsx)("p",{children:"Remove member"})]})})})]})}),(0,M.jsx)(sd.Z,{visible:C,header:"Confirm to remove",buttonLabel:"Remove",onSelectCancel:function(){return k(!1)},onSelectConfirm:function(){F()},children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("p",{className:"py-4 text-sm text-foreground-light",children:["This is permanent! Are you sure you want to remove ",l.primary_email]})})})]})}),sM=[{title:"Organization",actions:[{description:"Can change organization name",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete organization",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Members",actions:[{description:"Can add an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add an Adminstrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Administrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can revoke an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resend an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Billing",actions:[{description:"Can read invoices",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can read billing email",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can change billing email",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!0}},{description:"Can view subscription",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update subscription",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read billing address",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update billing address",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read tax codes",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update tax codes",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read payment methods",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update payment methods",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}}]},{title:"Projects",actions:[{description:"Can view projects",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can update a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can pause a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resume a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can restart a project",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read API anon keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read API secret keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can generate new JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can update API settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Database",actions:[{description:"Can read tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read create/update/delete RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read update database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read scheduled database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a scheduled database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read PITR database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a PITR database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database replications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update database replications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"SQL Editor",actions:[{description:"Can run a SELECT-based query",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can run all other types of queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can create/update/delete queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Storage",actions:[{description:"Can access storage",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Authentication",actions:[{description:"Can view users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can remove users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can invite users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can view authentication logs",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Edge Functions",actions:[{description:"Can view edge functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Logs Explorer",actions:[{description:"Can view logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create queries in the logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Reports",actions:[{description:"Can view reports",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update a report",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]}],sU=function(){var e=(0,p.useState)(!1),n=e[0],r=e[1],t="w-[40%] text-sm pl-4 font-bold",s="w-[12%] text-sm h-8 flex items-center justify-center border-l border-control font-bold",a=(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)(nJ.Z,{size:14,strokeWidth:2})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"top",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"Only available in Team/Enterprise plan."})})]})})]});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(rM.Z,{size:16,strokeWidth:1.5,className:"cursor-pointer transition hover:text-foreground",onClick:function(){return r(!n)}}),(0,M.jsx)(e$.C,{closable:!0,hideFooter:!0,visible:n,size:"xxlarge",header:"Permissions for each role",onCancel:function(){return r(!n)},children:(0,M.jsxs)("div",{className:"space-y-4 py-4",children:[(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("p",{className:"text-sm",children:"The following table shows the corresponding permissions for each available role in the dashboard."})}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"rounded border border-default bg-surface-200",children:[(0,M.jsxs)("div",{className:"flex items-center border-b border-control",children:[(0,M.jsx)("div",{className:t,children:"Permissions"}),(0,M.jsx)("div",{className:s,children:"Owner"}),(0,M.jsx)("div",{className:s,children:"Adminstrator"}),(0,M.jsx)("div",{className:s,children:"Developer"}),(0,M.jsxs)("div",{className:s,children:["Read-only\xa0",a]}),(0,M.jsxs)("div",{className:s,children:["Billing-only\xa0",a]})]}),(0,M.jsx)("div",{className:"max-h-[425px] overflow-y-auto",children:sM.map(function(e){return(0,M.jsxs)(p.Fragment,{children:[(0,M.jsx)("div",{className:"flex items-center border-b border-control py-2 px-4 last:border-none",children:(0,M.jsx)("div",{className:"w-[100%] text-sm",children:e.title})}),e.actions.map(function(n,r){return(0,M.jsxs)("div",{className:"flex items-center border-b border-control bg-overlay-hover last:border-none",children:[(0,M.jsx)("div",{className:t,children:n.description}),(0,M.jsx)("div",{className:s,children:n.permissions.owner&&(0,M.jsx)(nd.Z,{size:14,strokeWidth:2})}),(0,M.jsx)("div",{className:s,children:n.permissions.admin&&(0,M.jsx)(nd.Z,{size:14,strokeWidth:2})}),(0,M.jsx)("div",{className:s,children:n.permissions.developer&&(0,M.jsx)(nd.Z,{size:14,strokeWidth:2})}),(0,M.jsx)("div",{className:s,children:n.permissions.read_only&&(0,M.jsx)(nd.Z,{size:14,strokeWidth:2})}),(0,M.jsx)("div",{className:s,children:n.permissions.billing_only&&(0,M.jsx)(nd.Z,{size:14,strokeWidth:2})})]},"".concat(e.title,"-").concat(r))})]},e.title)})})]})})]})})]})};function sY(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function sB(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?sY(Object(r),!0).forEach(function(n){(0,v.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var sG=(0,rn.Pi)(function(e){var n,r,t=e.searchString,s=(0,z.oR)().ui,a=(0,m.UO)().slug,i=(0,z.lL)(),o=(0,sf.Un)().profile,l=(0,sx.js)().data,u=ty({slug:a}),x=u.data,f=u.error,v=u.isLoading,j=u.isError,b=u.isSuccess,y=tS({slug:a}),w=y.data,N=y.error,O=y.isLoading,S=y.isError,_=sZ({onSuccess:function(){B(!1),s.setNotification({category:"success",message:"Successfully updated role for ".concat(sA(R))})},onError:function(e){s.setNotification({category:"error",message:"Failed to update role for ".concat(sA(R),": ").concat(e.message)})}}),C=_.mutate,k=_.isLoading,P=null!=x?x:[],Z=null!==(r=null==w?void 0:w.roles)&&void 0!==r?r:[],E=sR(null==i?void 0:i.id,Z,null!=l?l:[]),A=E.rolesAddable,D=E.rolesRemovable,I=P.some(function(e){return void 0!==e.gotrue_id&&void 0!==e.mfa_enabled}),T=(0,p.useState)(),R=T[0],F=T[1],U=(0,p.useState)(!1),Y=U[0],B=U[1],G=(t?P.filter(function(e){return e.invited_at?e.primary_email.includes(t):e.id||e.gotrue_id?e.username.includes(t)||e.primary_email.includes(t):void 0}):P).slice().sort(function(e,n){return e.username.localeCompare(n.username)}),W=function(e){var n;return Z?null===(n=Z.find(function(n){return n.id===e}))||void 0===n?void 0:n.name:e},V=(n=(0,c.Z)(d().mark(function e(){var n,r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(R){e.next=2;break}return e.abrupt("return");case 2:if(n=R.gotrue_id,r=R.newRoleId,a){e.next=5;break}return e.abrupt("return",console.error("slug is required"));case 5:if(n){e.next=7;break}return e.abrupt("return",console.error("gotrue_id is required"));case 7:C({slug:a,gotrueId:n,roleId:r});case 8:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,M.jsxs)(M.Fragment,{children:[v&&(0,M.jsx)(g.A,{}),j&&(0,M.jsx)(h.Z,{error:f,subject:"Failed to retrieve organization members"}),S&&(0,M.jsx)(h.Z,{error:N,subject:"Failed to retrieve organization roles"}),b&&(0,M.jsx)("div",{className:"rounded w-full",children:(0,M.jsx)(s_.Z,{active:!G,children:(0,M.jsx)(ec.Z,{head:[(0,M.jsx)(ec.Z.th,{children:"User"},"header-user"),(0,M.jsx)(ec.Z.th,{},"header-status")].concat((0,nb.Z)(I?[(0,M.jsx)(ec.Z.th,{className:"text-center",children:"Enabled MFA"},"header-mfa")]:[]),[(0,M.jsxs)(ec.Z.th,{className:"flex items-center space-x-2",children:[(0,M.jsx)("span",{children:"Role"}),(0,M.jsx)(sU,{})]},"header-role"),(0,M.jsx)(ec.Z.th,{},"header-action")]),body:[].concat((0,nb.Z)(G.map(function(e,n){var r,t=null!==(r=e.role_ids)&&void 0!==r?r:[],a=(0,n2.Z)(t,1)[0],i=(Z||[]).find(function(e){return e.id===a}),c=e.primary_email==(null==o?void 0:o.primary_email),l=!!e.invited_id,d=D.includes(a),u=!d||c||l,m=e.username===e.primary_email;return(0,M.jsx)(p.Fragment,{children:(0,M.jsxs)(ec.Z.tr,{children:[(0,M.jsx)(ec.Z.td,{children:(0,M.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,M.jsx)("div",{children:e.invited_id?(0,M.jsx)("span",{className:"flex p-2 border-2 rounded-full border-strong",children:(0,M.jsx)(td.Z,{size:20,strokeWidth:2})}):m?(0,M.jsx)("div",{className:"w-[40px] h-[40px] bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center",children:(0,M.jsx)(td.Z,{strokeWidth:1.5})}):(0,M.jsx)(ti(),{alt:e.username,src:"https://github.com/".concat(e.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-foreground",children:sA(e)}),void 0===e.invited_id&&(0,M.jsx)("p",{className:"text-foreground-light",children:e.primary_email})]})]})}),(0,M.jsx)(ec.Z.td,{children:e.invited_id&&e.invited_at&&(0,M.jsx)(eI.Z,{color:sE(e.invited_at)?"red":"yellow",children:sE(e.invited_at)?"Expired":"Invited"})}),I&&(0,M.jsx)(ec.Z.td,{children:(0,M.jsx)("div",{className:"flex items-center justify-center",children:e.mfa_enabled?(0,M.jsx)(nd.Z,{className:"text-brand",strokeWidth:2}):(0,M.jsx)(nY.Z,{className:"text-foreground-light",strokeWidth:1.5})})}),(0,M.jsx)(ec.Z.td,{children:O?(0,M.jsx)("div",{className:"w-[140px]",children:(0,M.jsx)(nC.Z,{className:"animate-spin",size:16,strokeWidth:1.5})}):void 0!==i?(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{className:"w-[140px]",asChild:!0,children:(0,M.jsx)("div",{children:(0,M.jsx)(L.Z,{className:u?"pointer-events-none":"",disabled:u,value:i.id,onChange:function(n){if(i&&i.id!==n){var r,t=(Z||[]).find(function(e){return e.id===n});if(!A.includes(null!==(r=null==t?void 0:t.id)&&void 0!==r?r:-1))return s.setNotification({category:"error",duration:4e3,message:"You do not have permission to update this team member to ".concat(t.name)});B(!0),F(sB(sB({},e),{},{oldRoleId:i.id,newRoleId:n}))}},children:Z.map(function(e){return(0,M.jsx)(L.Z.Option,{value:e.id,label:e.name,disabled:u,className:"w-36",children:e.name},e.id)})})})}),l?(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"Role can only be changed after the user has accepted the invite"})})]})}):c||d?(0,M.jsx)(M.Fragment,{}):(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to manage this team member"})})]})})]}):(0,M.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,M.jsx)("p",{className:"text-sm text-foreground-light",children:"Invalid role"}),(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{children:(0,M.jsx)(nk.Z,{size:16,strokeWidth:1.5})}),(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"This user has an invalid role, please reach out to us via support"})})]})})]})]})}),(0,M.jsx)(ec.Z.td,{children:!c&&(0,M.jsx)(sF,{member:e,roles:Z})})]})},"member-row-".concat(n))})),(0,nb.Z)(t.length>0&&0===G.length?[(0,M.jsx)(ec.Z.tr,{className:"bg-panel-secondary-light",children:(0,M.jsx)(ec.Z.td,{colSpan:12,children:(0,M.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,M.jsx)(nk.Z,{size:16,strokeWidth:2}),(0,M.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',t,'"']})]})})},"no-results")]:[]),[(0,M.jsx)(ec.Z.tr,{className:"bg-panel-secondary-light",children:(0,M.jsx)(ec.Z.td,{colSpan:12,children:(0,M.jsxs)("p",{className:"text-foreground-light",children:[t?"".concat(G.length," of "):"",P.length||"0"," ",1==P.length?"user":"users"]})})},"footer")])})})}),(0,M.jsx)(e$.C,{hideFooter:!0,size:"medium",visible:Y,onCancel:function(){return B(!1)},header:"Change role of member",children:(0,M.jsxs)("div",{className:"flex flex-col gap-2 py-4",children:[(0,M.jsxs)(e$.C.Content,{children:[(0,M.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are changing the role of"," ",(0,M.jsx)("span",{className:"text-foreground",children:sA(R)})," from"," ",(0,M.jsx)("span",{className:"text-foreground",children:W(null==R?void 0:R.oldRoleId)})," ","to"," ",(0,M.jsx)("span",{className:"text-foreground",children:W(null==R?void 0:R.newRoleId)})]}),(0,M.jsx)("p",{className:"mt-3 text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]}),(0,M.jsx)(e$.C.Separator,{}),(0,M.jsx)(e$.C.Content,{children:(0,M.jsxs)("div",{className:"flex gap-3",children:[(0,M.jsx)(ea.z,{type:"default",block:!0,size:"medium",onClick:function(){return B(!1)},children:"Cancel"}),(0,M.jsx)(ea.z,{block:!0,type:"warning",size:"medium",disabled:k,loading:k,onClick:function(){return V()},children:"Confirm"})]})})]})})]})}),sW=function(){var e,n,r=(0,z.oR)().ui,t=(0,m.UO)().slug,s=(0,z.N3)(["organization_members:create","organization_members:delete"]),a=s.organizationMembersCreate,i=s.organizationMembersDelete,l=(0,sf.Un)().profile,u=(0,z.lL)(),h=null==u?void 0:u.is_owner,x=(0,sx.js)().data,f=tS({slug:t}).data,g=ty({slug:t}).data,v=null!==(n=null==f?void 0:f.roles)&&void 0!==n?n:[],j=sR(null==u?void 0:u.id,v,null!=x?x:[]).rolesAddable,b=(0,p.useState)(!1),y=b[0],w=b[1],N=(0,p.useState)(""),O=N[0],S=N[1],_=j.length>0,C=!h||h&&sL(g,v),k=sh().mutateAsync,P=(0,p.useState)(!1),Z=P[0],E=P[1],A=(e=(0,c.Z)(d().mark(function e(){var n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w(!0),e.prev=1,t){e.next=4;break}return e.abrupt("return",console.error("Org slug is required"));case 4:return e.next=6,k({slug:t,gotrueId:l.gotrue_id});case 6:E(!1),null===(n=window)||void 0===n||n.location.replace("/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),r.setNotification({category:"error",message:"Failed to leave organization: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message)});case 13:return e.prev=13,w(!1),e.finish(13);case 16:case"end":return e.stop()}},e,null,[[1,10,13,16]])})),function(){return e.apply(this,arguments)});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.gW,{children:(0,M.jsxs)(o.tM,{children:[(0,M.jsxs)(o.Wv,{className:"justify-between",children:[(0,M.jsx)(R.Z,{icon:(0,M.jsx)(sl.Z,{size:"tiny"}),size:"small",value:O,onChange:function(e){return S(e.target.value)},name:"email",id:"email",placeholder:"Filter members"}),(0,M.jsxs)(o.ur,{children:[a&&_&&void 0!==l&&void 0!==u&&(0,M.jsx)("div",{children:(0,M.jsx)(sS,{orgId:u.id,userId:l.id,members:null!=g?g:[],roles:v,rolesAddable:j})}),i&&(0,M.jsx)("div",{children:(0,M.jsxs)(e8.fC,{delayDuration:0,children:[(0,M.jsx)(e8.xz,{asChild:!0,children:(0,M.jsx)(ea.z,{type:"default",disabled:!C,onClick:function(){return E(!0)},loading:y,children:"Leave team"})}),!C&&(0,M.jsx)(e8.h_,{children:(0,M.jsxs)(e8.VY,{side:"bottom",children:[(0,M.jsx)(e8.Eh,{className:"radix-tooltip-arrow"}),(0,M.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,M.jsx)("span",{className:"text-xs text-foreground",children:"An organization requires at least 1 owner"})})]})})]})})]})]}),(0,M.jsx)(o.Lc,{className:"w-full",children:(0,M.jsx)(sG,{searchString:O})})]})}),(0,M.jsx)(sd.Z,{visible:Z,header:"Are you sure?",buttonLabel:"Leave",onSelectCancel:function(){return E(!1)},onSelectConfirm:function(){A()},children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("p",{className:"py-4 text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})})]})},sV=function(){return(0,M.jsxs)(o.jX,{children:[(0,M.jsxs)(o.g$,{className:"sticky space-y-6 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,M.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,M.jsxs)("p",{children:["All organizations can access and use our DPA as part of their GDPR compliance. Sign and return the signed DPA document to"," ",(0,M.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]}),(0,M.jsx)("p",{children:"This is only to access the document. Please ignore this if you have sent the signed document to us."})]})]}),(0,M.jsx)(o.Lc,{className:"flex items-center justify-center h-full",children:(0,M.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+DPA+230907.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,M.jsx)(ea.z,{type:"default",iconRight:(0,M.jsx)(en.Z,{}),children:"View DPA"})})})]})};function sq(e,n){return sK.apply(this,arguments)}function sK(){return(sK=(0,c.Z)(d().mark(function e(n,r){var t,s,a,i,o,c,l,u;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.orgSlug,s=n.docType,t){e.next=3;break}throw Error("orgSlug is required");case 3:if("standard-security-questionnaire"!==s){e.next=12;break}return e.next=6,(0,Y.U2)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:t}},signal:r});case 6:if(i=(a=e.sent).data,!(o=a.error)){e.next=11;break}throw o;case 11:return e.abrupt("return",i);case 12:if("soc2-type-2-report"!==s){e.next=21;break}return e.next=15,(0,Y.U2)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:t}},signal:r});case 15:if(l=(c=e.sent).data,!(u=c.error)){e.next=20;break}throw u;case 20:return e.abrupt("return",l);case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}var sX=function(){var e,n=(0,m.UO)().slug,r=(0,z.oR)().ui,t=(0,J.G)({orgSlug:n}),s=t.data,a=t.error,i=t.isLoading,l=t.isError,u=t.isSuccess,p=null==s?void 0:s.plan,x=(e=(0,c.Z)(d().mark(function e(n){var t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,sq({orgSlug:n,docType:"standard-security-questionnaire"});case 3:null!=(t=e.sent)&&t.fileUrl&&window.open(t.fileUrl,"_blank"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.setNotification({category:"error",message:"Failed to download Security Questionnaire: ".concat(e.t0.message)});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(n){return e.apply(this,arguments)});return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(o.jX,{children:[(0,M.jsxs)(o.g$,{className:"sticky space-y-6 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,M.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,M.jsx)("p",{children:"Organizations on Teams plan or above have access to our standard security questionnaire."})})]}),(0,M.jsxs)(o.Lc,{children:[i&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),l&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:a}),u&&(0,M.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==p?void 0:p.id)==="free"||(null==p?void 0:p.id)==="pro"?(0,M.jsx)($(),{href:"/org/".concat(n,"/billing?panel=subscriptionPlan"),children:(0,M.jsx)(ea.z,{type:"default",children:"Upgrade to Teams"})}):(0,M.jsx)(ea.z,{type:"default",iconRight:(0,M.jsx)(rI.Z,{}),onClick:function(){n&&x(n)},children:"Download Questionnaire"})})]})]})})},sH=function(){var e,n=(0,m.UO)().slug,r=(0,z.oR)().ui,t=(0,J.G)({orgSlug:n}),s=t.data,a=t.error,i=t.isLoading,l=t.isError,u=t.isSuccess,x=null==s?void 0:s.plan,f=(0,p.useState)(!1),v=f[0],j=f[1],b=(e=(0,c.Z)(d().mark(function e(n){var t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,sq({orgSlug:n,docType:"soc2-type-2-report"});case 3:null!=(t=e.sent)&&t.fileUrl&&window.open(t.fileUrl,"_blank"),j(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r.setNotification({category:"error",message:"Failed to download SOC2 report: ".concat(e.t0.message)});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(n){return e.apply(this,arguments)});return(0,M.jsxs)(o.jX,{children:[(0,M.jsxs)(o.g$,{className:"sticky space-y-6 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,M.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,M.jsx)("p",{children:"Organizations on Teams plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,M.jsxs)(o.Lc,{children:[i&&(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(g.Z,{}),(0,M.jsx)(g.Z,{className:"w-3/4"}),(0,M.jsx)(g.Z,{className:"w-1/2"})]}),l&&(0,M.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:a}),u&&(0,M.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==x?void 0:x.id)==="free"||(null==x?void 0:x.id)==="pro"?(0,M.jsx)($(),{href:"/org/".concat(n,"/billing?panel=subscriptionPlan"),children:(0,M.jsx)(ea.z,{type:"default",children:"Upgrade to Teams"})}):(0,M.jsx)(ea.z,{type:"default",iconRight:(0,M.jsx)(rI.Z,{}),onClick:function(){return j(!0)},children:"Download SOC2 Type 2 Report"})}),(0,M.jsx)(sd.Z,{visible:v,header:"Non-Disclosure Agreement to access Supabase's SOC2 Report",buttonLabel:"I agree",buttonLoadingLabel:"Downloading",onSelectCancel:function(){return j(!1)},size:"large",onSelectConfirm:function(){n&&b(n)},children:(0,M.jsx)(e$.C.Content,{children:(0,M.jsx)("div",{className:"py-4 text-sm text-foreground-light pl-30",children:(0,M.jsxs)("ol",{className:"list-decimal list-inside",children:[(0,M.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,M.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,M.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,M.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,M.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,M.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,M.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,M.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})})})]})]})},s$=function(){return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(o.jX,{children:[(0,M.jsxs)(o.g$,{className:"sticky space-y-6 top-12",children:[(0,M.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,M.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,M.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,M.jsx)("p",{children:"Organizations on the Teams plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,M.jsx)("p",{children:"Organizations on the Free or Pro plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Teams plan after your request is approved."})]})]}),(0,M.jsx)(o.Lc,{children:(0,M.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,M.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,M.jsx)(ea.z,{type:"default",iconRight:(0,M.jsx)(en.Z,{}),children:"Request HIPAA"})})})})]})})},sQ=function(){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o._S,{id:"dpa",children:(0,M.jsx)(sV,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"security-questionnaire",children:(0,M.jsx)(sX,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"soc2",children:(0,M.jsx)(sH,{})}),(0,M.jsx)(o.I7,{}),(0,M.jsx)(o._S,{id:"hipaa",children:(0,M.jsx)(s$,{})})]})}},78466:function(e,n,r){r.d(n,{S:function(){return f}});var t=r(95235),s=r(82269),a=r(20406),i=r(28526),o=r.n(i),c=r(62350),l=r(62202),d=r(37552),u=r(9747),p=["onError"];function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x(){return(x=(0,a.Z)(o().mark(function e(n){var r,t,s,a,i,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.projectRef,t=n.orgSlug,s=n.reasons,a=n.message,i=n.exitAction,e.next=3,(0,d.v_)("".concat(u.T5,"/feedback/downgrade"),h(h(h({},void 0!==r&&{projectRef:r}),void 0!==t&&{orgSlug:t}),{},{reasons:s,additionalFeedback:a,exitAction:i}));case 3:if(!(c=e.sent).error){e.next=6;break}throw c.error;case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onError,r=(0,s.Z)(e,p);return(0,c.D)(function(e){return function(e){return x.apply(this,arguments)}(e)},h({onError:function(e,r,t){return(0,a.Z)(o().mark(function s(){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===n?l.ZP.error("Failed to submit exit survey: ".concat(e.message)):n(e,r,t);case 1:case"end":return s.stop()}},s)}))()}},r))}},96132:function(e,n,r){r.d(n,{Y:function(){return t}});var t={overdueInvoices:function(){return["invoices","overdue"]},invoice:function(e){return["invoice",e]},list:function(e,n,r){return["invoices",e,n,r]},count:function(e,n){return["invoices",e,n,"count"]},projectInvoices:function(e,n){return["invoices",e,n]},projectInvoicesCount:function(e){return["invoices",e,"count"]},upcomingPreview:function(e){return["invoices",e,"upcoming-preview"]},orgUpcomingPreview:function(e){return["invoices",e,"upcoming-preview"]}}},10118:function(e,n,r){r.d(n,{T:function(){return g}});var t=r(95235),s=r(82269),a=r(20406),i=r(28526),o=r.n(i),c=r(55830),l=r(62350),d=r(62202),u=r(81229),p=r(98953),m=r(6815),h=["onSuccess","onError"];function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function f(){return(f=(0,a.Z)(o().mark(function e(n){var r,t,s,a,i,c,l,d;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,t=n.kind,s=n.size,a=n.tier,i=n.payment_method,e.next=3,(0,u.v_)("/platform/organizations",{body:{name:r,kind:t,size:s,tier:a,payment_method:i}});case 3:if(l=(c=e.sent).data,!(d=c.error)){e.next=8;break}throw d;case 8:return e.abrupt("return",l);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onSuccess,r=e.onError,i=(0,s.Z)(e,h),u=(0,c.NL)();return(0,l.D)(function(e){return function(e){return f.apply(this,arguments)}(e)},function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({onSuccess:function(e,r,t){return(0,a.Z)(o().mark(function s(){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all([u.invalidateQueries(m.O.list()),u.invalidateQueries(p.F.list())]);case 2:return s.next=4,null==n?void 0:n(e,r,t);case 4:case"end":return s.stop()}},s)}))()},onError:function(e,n,t){return(0,a.Z)(o().mark(function s(){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r?d.Am.error("Failed to create organization: ".concat(e.message)):r(e,n,t);case 1:case"end":return s.stop()}},s)}))()}},i))}},22790:function(e,n,r){r.d(n,{Wu:function(){return i}});var t=r(9162),s=r(4741),a=(0,t.sj)({panelKey:void 0,setPanelKey:function(e){a.panelKey=e}}),i=function(e){return(0,s.R)(a,e)}},71320:function(e,n,r){r.d(n,{Z:function(){return p}});var t=r(95235),s=r(2784),a=r(13980),i=r.n(a);function o(){return(o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var c=(0,s.forwardRef)(function(e,n){var r=e.color,t=e.size,a=void 0===t?24:t,i=function(e,n){if(null==e)return{};var r,t,s=function(e,n){if(null==e)return{};var r,t,s={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,["color","size"]);return s.createElement("svg",o({ref:n,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:void 0===r?"currentColor":r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),s.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.createElement("polyline",{points:"19 12 12 19 5 12"}))});c.propTypes={color:i().string,size:i().oneOfType([i().string,i().number])},c.displayName="ArrowDown";var l=r(12223),d=r(52322);function u(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}var p=function(e){return(0,d.jsx)(l.Z,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?u(Object(r),!0).forEach(function(n){(0,t.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}({icon:c},e))}}}]);